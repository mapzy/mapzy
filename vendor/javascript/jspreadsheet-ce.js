import*as _jsuites2 from"jsuites";var _jsuites="default"in _jsuites2?_jsuites2.default:_jsuites2;var _global="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var exports={};var formula=function(){var error=function(){var e={};e.nil=new Error("#NULL!");e.div0=new Error("#DIV/0!");e.value=new Error("#VALUE!");e.ref=new Error("#REF!");e.name=new Error("#NAME?");e.num=new Error("#NUM!");e.na=new Error("#N/A");e.error=new Error("#ERROR!");e.data=new Error("#GETTING_DATA");return e}();var utils=function(){var e={};e.flattenShallow=function(e){return e&&e.reduce?e.reduce((function(e,r){var t=Array.isArray(e);var o=Array.isArray(r);if(t&&o)return e.concat(r);if(t){e.push(r);return e}return o?[e].concat(r):[e,r]})):e};e.isFlat=function(e){if(!e)return false;for(var r=0;r<e.length;++r)if(Array.isArray(e[r]))return false;return true};e.flatten=function(){var r=e.argsToArray.apply(null,arguments);while(!e.isFlat(r))r=e.flattenShallow(r);return r};e.argsToArray=function(r){var t=[];e.arrayEach(r,(function(e){t.push(e)}));return t};e.numbers=function(){var e=(this||_global).flatten.apply(null,arguments);return e.filter((function(e){return"number"===typeof e}))};e.cleanFloat=function(e){var r=1e14;return Math.round(e*r)/r};e.parseBool=function(e){if("boolean"===typeof e)return e;if(e instanceof Error)return e;if("number"===typeof e)return 0!==e;if("string"===typeof e){var r=e.toUpperCase();if("TRUE"===r)return true;if("FALSE"===r)return false}return e instanceof Date&&!isNaN(e)||error.value};e.parseNumber=function(e){return void 0===e||""===e||isNaN(e)?error.value:parseFloat(e)};e.parseNumberArray=function(r){var t;if(!r||0===(t=r.length))return error.value;var o;while(t--){o=e.parseNumber(r[t]);if(o===error.value)return o;r[t]=o}return r};e.parseMatrix=function(r){if(!r||0===r.length)return error.value;var t;for(var o=0;o<r.length;o++){t=e.parseNumberArray(r[o]);r[o]=t;if(t instanceof Error)return t}return r};var r=new Date(Date.UTC(1900,0,1));e.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);var t=parseInt(e,10);return t<0?error.num:t<=60?new Date(r.getTime()+864e5*(t-1)):new Date(r.getTime()+864e5*(t-2))}if("string"===typeof e){e=new Date(e);if(!isNaN(e))return e}return error.value};e.parseDateArray=function(e){var r=e.length;var t;while(r--){t=this.parseDate(e[r]);if(t===error.value)return t;e[r]=t}return e};e.anyIsError=function(){var e=arguments.length;while(e--)if(arguments[e]instanceof Error)return true;return false};e.arrayValuesToNumbers=function(e){var r=e.length;var t;while(r--){t=e[r];if("number"!==typeof t)if(true!==t)if(false!==t){if("string"===typeof t){var o=this.parseNumber(t);o instanceof Error?e[r]=0:e[r]=o}}else e[r]=0;else e[r]=1}return e};e.rest=function(e,r){r=r||1;return e&&"function"===typeof e.slice?e.slice(r):e};e.initial=function(e,r){r=r||1;return e&&"function"===typeof e.slice?e.slice(0,e.length-r):e};e.arrayEach=function(e,r){var t=-1,o=e.length;while(++t<o)if(false===r(e[t],t,e))break;return e};e.transpose=function(e){return e?e[0].map((function(r,t){return e.map((function(e){return e[t]}))})):error.value};return e}();var met={};met.datetime=function(){var e={};var r=new Date(1900,0,1);var t=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];e.DATE=function(e,r,t){e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);if(utils.anyIsError(e,r,t))return error.value;if(e<0||r<0||t<0)return error.num;var o=new Date(e,r-1,t);return o};e.DATEVALUE=function(e){if("string"!==typeof e)return error.value;var t=Date.parse(e);return isNaN(t)?error.value:t<=-22038912e5?(t-r)/864e5+1:(t-r)/864e5+2};e.DAY=function(e){var r=utils.parseDate(e);return r instanceof Error?r:r.getDate()};e.DAYS=function(e,r){e=utils.parseDate(e);r=utils.parseDate(r);return e instanceof Error?e:r instanceof Error?r:serial(e)-serial(r)};e.DAYS360=function(e,r,t){};e.EDATE=function(e,r){e=utils.parseDate(e);if(e instanceof Error)return e;if(isNaN(r))return error.value;r=parseInt(r,10);e.setMonth(e.getMonth()+r);return serial(e)};e.EOMONTH=function(e,r){e=utils.parseDate(e);if(e instanceof Error)return e;if(isNaN(r))return error.value;r=parseInt(r,10);return serial(new Date(e.getFullYear(),e.getMonth()+r+1,0))};e.HOUR=function(e){e=utils.parseDate(e);return e instanceof Error?e:e.getHours()};e.INTERVAL=function(e){if("number"!==typeof e&&"string"!==typeof e)return error.value;e=parseInt(e,10);var r=Math.floor(e/94608e4);e%=94608e4;var t=Math.floor(e/2592e3);e%=2592e3;var o=Math.floor(e/86400);e%=86400;var s=Math.floor(e/3600);e%=3600;var a=Math.floor(e/60);e%=60;var u=e;r=r>0?r+"Y":"";t=t>0?t+"M":"";o=o>0?o+"D":"";s=s>0?s+"H":"";a=a>0?a+"M":"";u=u>0?u+"S":"";return"P"+r+t+o+"T"+s+a+u};e.ISOWEEKNUM=function(e){e=utils.parseDate(e);if(e instanceof Error)return e;e.setHours(0,0,0);e.setDate(e.getDate()+4-(e.getDay()||7));var r=new Date(e.getFullYear(),0,1);return Math.ceil(((e-r)/864e5+1)/7)};e.MINUTE=function(e){e=utils.parseDate(e);return e instanceof Error?e:e.getMinutes()};e.MONTH=function(e){e=utils.parseDate(e);return e instanceof Error?e:e.getMonth()+1};e.NETWORKDAYS=function(e,r,t){};e.NETWORKDAYS.INTL=function(e,r,t,o){};e.NOW=function(){return new Date};e.SECOND=function(e){e=utils.parseDate(e);return e instanceof Error?e:e.getSeconds()};e.TIME=function(e,r,t){e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);return utils.anyIsError(e,r,t)?error.value:e<0||r<0||t<0?error.num:(3600*e+60*r+t)/86400};e.TIMEVALUE=function(e){e=utils.parseDate(e);return e instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400};e.TODAY=function(){return new Date};e.WEEKDAY=function(e,r){e=utils.parseDate(e);if(e instanceof Error)return e;void 0===r&&(r=1);var o=e.getDay();return t[r][o]};e.WEEKNUM=function(e,r){};e.WORKDAY=function(e,r,t){};e.WORKDAY.INTL=function(e,r,t,o){};e.YEAR=function(e){e=utils.parseDate(e);return e instanceof Error?e:e.getFullYear()};e.YEARFRAC=function(e,r,t){};function serial(e){var t=e>-22038912e5?2:1;return(e-r)/864e5+t}return e}();met.database=function(){var exports={};function compact(e){if(!e)return e;var r=[];for(var t=0;t<e.length;++t)e[t]&&r.push(e[t]);return r}exports.FINDFIELD=function(e,r){var t=null;for(var o=0;o<e.length;o++)if(e[o][0]===r){t=o;break}return null==t?error.value:t};function findResultIndex(database,criterias){var matches={};for(var i=1;i<database[0].length;++i)matches[i]=true;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){var currentCriteriaResult=false;var hasMatchingCriteria=false;for(var j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=true;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}var result=[];for(var n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}exports.DAVERAGE=function(e,r,t){if(isNaN(r)&&"string"!==typeof r)return error.value;var o=findResultIndex(e,t);var s=[];if("string"===typeof r){var a=exports.FINDFIELD(e,r);s=utils.rest(e[a])}else s=utils.rest(e[r]);var u=0;for(var b=0;b<o.length;b++)u+=s[o[b]];return 0===o.length?error.div0:u/o.length};exports.DCOUNT=function(e,r,t){};exports.DCOUNTA=function(e,r,t){};exports.DGET=function(e,r,t){if(isNaN(r)&&"string"!==typeof r)return error.value;var o=findResultIndex(e,t);var s=[];if("string"===typeof r){var a=exports.FINDFIELD(e,r);s=utils.rest(e[a])}else s=utils.rest(e[r]);return 0===o.length?error.value:o.length>1?error.num:s[o[0]]};exports.DMAX=function(e,r,t){if(isNaN(r)&&"string"!==typeof r)return error.value;var o=findResultIndex(e,t);var s=[];if("string"===typeof r){var a=exports.FINDFIELD(e,r);s=utils.rest(e[a])}else s=utils.rest(e[r]);var u=s[o[0]];for(var b=1;b<o.length;b++)u<s[o[b]]&&(u=s[o[b]]);return u};exports.DMIN=function(e,r,t){if(isNaN(r)&&"string"!==typeof r)return error.value;var o=findResultIndex(e,t);var s=[];if("string"===typeof r){var a=exports.FINDFIELD(e,r);s=utils.rest(e[a])}else s=utils.rest(e[r]);var u=s[o[0]];for(var b=1;b<o.length;b++)u>s[o[b]]&&(u=s[o[b]]);return u};exports.DPRODUCT=function(e,r,t){if(isNaN(r)&&"string"!==typeof r)return error.value;var o=findResultIndex(e,t);var s=[];if("string"===typeof r){var a=exports.FINDFIELD(e,r);s=utils.rest(e[a])}else s=utils.rest(e[r]);var u=[];for(var b=0;b<o.length;b++)u[b]=s[o[b]];u=compact(u);var d=1;for(b=0;b<u.length;b++)d*=u[b];return d};exports.DSTDEV=function(e,r,t){};exports.DSTDEVP=function(e,r,t){};exports.DSUM=function(e,r,t){};exports.DVAR=function(e,r,t){};exports.DVARP=function(e,r,t){};exports.MATCH=function(e,r,t){if(!e&&!r)return error.na;2===arguments.length&&(t=1);if(!(r instanceof Array))return error.na;if(-1!==t&&0!==t&&1!==t)return error.na;var o;var s;for(var a=0;a<r.length;a++)if(1===t){if(r[a]===e)return a+1;if(r[a]<e)if(s){if(r[a]>s){o=a+1;s=r[a]}}else{o=a+1;s=r[a]}}else if(0===t){if("string"===typeof e){e=e.replace(/\?/g,".");if(r[a].toLowerCase().match(e.toLowerCase()))return a+1}else if(r[a]===e)return a+1}else if(-1===t){if(r[a]===e)return a+1;if(r[a]>e)if(s){if(r[a]<s){o=a+1;s=r[a]}}else{o=a+1;s=r[a]}}return o||error.na};return exports}();met.engineering=function(){var e={};function isValidBinaryNumber(e){return/^[01]{1,10}$/.test(e)}e.BESSELI=function(e,r){};e.BESSELJ=function(e,r){};e.BESSELK=function(e,r){};e.BESSELY=function(e,r){};e.BIN2DEC=function(e){if(!isValidBinaryNumber(e))return error.num;var r=parseInt(e,2);var t=e.toString();return 10===t.length&&"1"===t.substring(0,1)?parseInt(t.substring(1),2)-512:r};e.BIN2HEX=function(e,r){if(!isValidBinaryNumber(e))return error.num;var t=e.toString();if(10===t.length&&"1"===t.substring(0,1))return(0xfffffffe00+parseInt(t.substring(1),2)).toString(16);var o=parseInt(e,2).toString(16);if(void 0===r)return o;if(isNaN(r))return error.value;if(r<0)return error.num;r=Math.floor(r);return r>=o.length?REPT("0",r-o.length)+o:error.num};e.BIN2OCT=function(e,r){if(!isValidBinaryNumber(e))return error.num;var t=e.toString();if(10===t.length&&"1"===t.substring(0,1))return(1073741312+parseInt(t.substring(1),2)).toString(8);var o=parseInt(e,2).toString(8);if(void 0===r)return o;if(isNaN(r))return error.value;if(r<0)return error.num;r=Math.floor(r);return r>=o.length?REPT("0",r-o.length)+o:error.num};e.BITAND=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:e<0||r<0||Math.floor(e)!==e||Math.floor(r)!==r||e>0xffffffffffff||r>0xffffffffffff?error.num:e&r};e.BITLSHIFT=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(r)>53?error.num:r>=0?e<<r:e>>-r};e.BITOR=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:e<0||r<0||Math.floor(e)!==e||Math.floor(r)!==r||e>0xffffffffffff||r>0xffffffffffff?error.num:e|r};e.BITRSHIFT=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(r)>53?error.num:r>=0?e>>r:e<<-r};e.BITXOR=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:e<0||r<0||Math.floor(e)!==e||Math.floor(r)!==r||e>0xffffffffffff||r>0xffffffffffff?error.num:e^r};e.COMPLEX=function(e,r,t){e=utils.parseNumber(e);r=utils.parseNumber(r);if(utils.anyIsError(e,r))return e;t=void 0===t?"i":t;if("i"!==t&&"j"!==t)return error.value;if(0===e&&0===r)return 0;if(0===e)return 1===r?t:r.toString()+t;if(0===r)return e.toString();var o=r>0?"+":"";return e.toString()+o+(1===r?t:r.toString()+t)};e.CONVERT=function(e,r,t){e=utils.parseNumber(e);if(e instanceof Error)return e;var o=[["a.u. of action","?",null,"action",false,false,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",false,false,160217653141414e-33],["a.u. of energy","Eh",null,"energy",false,false,435974417757576e-32],["a.u. of length","a?",null,"length",false,false,529177210818182e-25],["a.u. of mass","m?",null,"mass",false,false,910938261616162e-45],["a.u. of time","?/Eh",null,"time",false,false,241888432650516e-31],["admiralty knot","admkn",null,"speed",false,true,.514773333],["ampere","A",null,"electric_current",true,false,1],["ampere per meter","A/m",null,"magnetic_field_intensity",true,false,1],["ångström","Å",["ang"],"length",false,true,1e-10],["are","ar",null,"area",false,true,100],["astronomical unit","ua",null,"length",false,false,149597870691667e-25],["bar","bar",null,"pressure",false,false,1e5],["barn","b",null,"area",false,false,1e-28],["becquerel","Bq",null,"radioactivity",true,false,1],["bit","bit",["b"],"information",false,true,1],["btu","BTU",["btu"],"energy",false,true,1055.05585262],["byte","byte",null,"information",false,true,8],["candela","cd",null,"luminous_intensity",true,false,1],["candela per square metre","cd/m?",null,"luminance",true,false,1],["coulomb","C",null,"electric_charge",true,false,1],["cubic ångström","ang3",["ang^3"],"volume",false,true,1e-30],["cubic foot","ft3",["ft^3"],"volume",false,true,.028316846592],["cubic inch","in3",["in^3"],"volume",false,true,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",false,true,846786664623715e-61],["cubic metre","m?",null,"volume",true,true,1],["cubic mile","mi3",["mi^3"],"volume",false,true,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",false,true,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",false,true,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",false,true,.764554857984],["cup","cup",null,"volume",false,true,.0002365882365],["dalton","Da",["u"],"mass",false,false,166053886282828e-41],["day","d",["day"],"time",false,true,86400],["degree","°",null,"angle",false,false,.0174532925199433],["degrees Rankine","Rank",null,"temperature",false,true,.555555555555556],["dyne","dyn",["dy"],"force",false,true,1e-5],["electronvolt","eV",["ev"],"energy",false,true,1.60217656514141],["ell","ell",null,"length",false,true,1.143],["erg","erg",["e"],"energy",false,true,1e-7],["farad","F",null,"electric_capacitance",true,false,1],["fluid ounce","oz",null,"volume",false,true,295735295625e-16],["foot","ft",null,"length",false,true,.3048],["foot-pound","flb",null,"energy",false,true,1.3558179483314],["gal","Gal",null,"acceleration",false,false,.01],["gallon","gal",null,"volume",false,true,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",false,true,1],["grain","grain",null,"mass",false,true,647989e-10],["gram","g",null,"mass",false,true,.001],["gray","Gy",null,"absorbed_dose",true,false,1],["gross registered ton","GRT",["regton"],"volume",false,true,2.8316846592],["hectare","ha",null,"area",false,true,1e4],["henry","H",null,"inductance",true,false,1],["hertz","Hz",null,"frequency",true,false,1],["horsepower","HP",["h"],"power",false,true,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",false,true,2684519.538],["hour","h",["hr"],"time",false,true,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",false,true,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",false,true,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",false,true,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",false,true,1016.046909],["inch","in",null,"length",false,true,.0254],["international acre","uk_acre",null,"area",false,true,4046.8564224],["IT calorie","cal",null,"energy",false,true,4.1868],["joule","J",null,"energy",true,true,1],["katal","kat",null,"catalytic_activity",true,false,1],["kelvin","K",["kel"],"temperature",true,true,1],["kilogram","kg",null,"mass",true,true,1],["knot","kn",null,"speed",false,true,.514444444444444],["light-year","ly",null,"length",false,true,9460730472580800],["litre","L",["l","lt"],"volume",false,true,.001],["lumen","lm",null,"luminous_flux",true,false,1],["lux","lx",null,"illuminance",true,false,1],["maxwell","Mx",null,"magnetic_flux",false,false,1e-18],["measurement ton","MTON",null,"volume",false,true,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",false,true,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",true,true,1],["meter per second squared","m?s??",null,"acceleration",true,false,1],["parsec","pc",["parsec"],"length",false,true,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",true,false,1],["metre","m",null,"length",true,true,1],["miles per hour","mph",null,"speed",false,true,.44704],["millimetre of mercury","mmHg",null,"pressure",false,false,133.322],["minute","?",null,"angle",false,false,.000290888208665722],["minute","min",["mn"],"time",false,true,60],["modern teaspoon","tspm",null,"volume",false,true,5e-6],["mole","mol",null,"amount_of_substance",true,false,1],["morgen","Morgen",null,"area",false,true,2500],["n.u. of action","?",null,"action",false,false,105457168181818e-48],["n.u. of mass","m?",null,"mass",false,false,910938261616162e-45],["n.u. of speed","c?",null,"speed",false,false,299792458],["n.u. of time","?/(me?c??)",null,"time",false,false,128808866778687e-35],["nautical mile","M",["Nmi"],"length",false,true,1852],["newton","N",null,"force",true,true,1],["œrsted","Oe ",null,"magnetic_field_intensity",false,false,79.5774715459477],["ohm","Ω",null,"electric_resistance",true,false,1],["ounce mass","ozm",null,"mass",false,true,.028349523125],["pascal","Pa",null,"pressure",true,false,1],["pascal second","Pa?s",null,"dynamic_viscosity",true,false,1],["pferdestärke","PS",null,"power",false,true,735.49875],["phot","ph",null,"illuminance",false,false,1e-4],["pica (1/6 inch)","pica",null,"length",false,true,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",false,true,.00423333333333333],["poise","P",null,"dynamic_viscosity",false,false,.1],["pond","pond",null,"force",false,true,.00980665],["pound force","lbf",null,"force",false,true,4.4482216152605],["pound mass","lbm",null,"mass",false,true,.45359237],["quart","qt",null,"volume",false,true,.000946352946],["radian","rad",null,"angle",true,false,1],["second","?",null,"angle",false,false,484813681109536e-20],["second","s",["sec"],"time",true,true,1],["short hundredweight","cwt",["shweight"],"mass",false,true,45.359237],["siemens","S",null,"electrical_conductance",true,false,1],["sievert","Sv",null,"equivalent_dose",true,false,1],["slug","sg",null,"mass",false,true,14.59390294],["square ångström","ang2",["ang^2"],"area",false,true,1e-20],["square foot","ft2",["ft^2"],"area",false,true,.09290304],["square inch","in2",["in^2"],"area",false,true,64516e-8],["square light-year","ly2",["ly^2"],"area",false,true,895054210748189e17],["square meter","m?",null,"area",true,true,1],["square mile","mi2",["mi^2"],"area",false,true,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",false,true,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",false,true,1792111111111e-17],["square yard","yd2",["yd^2"],"area",false,true,.83612736],["statute mile","mi",null,"length",false,true,1609.344],["steradian","sr",null,"solid_angle",true,false,1],["stilb","sb",null,"luminance",false,false,1e-4],["stokes","St",null,"kinematic_viscosity",false,false,1e-4],["stone","stone",null,"mass",false,true,6.35029318],["tablespoon","tbs",null,"volume",false,true,147868e-10],["teaspoon","tsp",null,"volume",false,true,492892e-11],["tesla","T",null,"magnetic_flux_density",true,true,1],["thermodynamic calorie","c",null,"energy",false,true,4.184],["ton","ton",null,"mass",false,true,907.18474],["tonne","t",null,"mass",false,false,1e3],["U.K. pint","uk_pt",null,"volume",false,true,.00056826125],["U.S. bushel","bushel",null,"volume",false,true,.03523907],["U.S. oil barrel","barrel",null,"volume",false,true,.158987295],["U.S. pint","pt",["us_pt"],"volume",false,true,.000473176473],["U.S. survey mile","survey_mi",null,"length",false,true,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",false,true,4046.87261],["volt","V",null,"voltage",true,false,1],["watt","W",null,"power",true,true,1],["watt-hour","Wh",["wh"],"energy",false,true,3600],["weber","Wb",null,"magnetic_flux",true,false,1],["yard","yd",null,"length",false,true,.9144],["year","yr",null,"time",false,true,31557600]];var s={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]};var a={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};var u=null;var b=null;var d=r;var f=t;var h=1;var g=1;var m;for(var v=0;v<o.length;v++){m=null===o[v][2]?[]:o[v][2];(o[v][1]===d||m.indexOf(d)>=0)&&(u=o[v]);(o[v][1]===f||m.indexOf(f)>=0)&&(b=o[v])}if(null===u){var C=s[r.substring(0,2)];var E=a[r.substring(0,1)];"da"===r.substring(0,2)&&(E=["dekao",10,"da"]);if(C){h=C[2];d=r.substring(2)}else if(E){h=E[1];d=r.substring(E[2].length)}for(var A=0;A<o.length;A++){m=null===o[A][2]?[]:o[A][2];(o[A][1]===d||m.indexOf(d)>=0)&&(u=o[A])}}if(null===b){var I=s[t.substring(0,2)];var M=a[t.substring(0,1)];"da"===t.substring(0,2)&&(M=["dekao",10,"da"]);if(I){g=I[2];f=t.substring(2)}else if(M){g=M[1];f=t.substring(M[2].length)}for(var R=0;R<o.length;R++){m=null===o[R][2]?[]:o[R][2];(o[R][1]===f||m.indexOf(f)>=0)&&(b=o[R])}}return null===u||null===b||u[3]!==b[3]?error.na:e*u[6]*h/(b[6]*g)};e.DEC2BIN=function(e,r){e=utils.parseNumber(e);if(e instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return error.num;if(e<0)return"1"+REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var t=parseInt(e,10).toString(2);if("undefined"===typeof r)return t;if(isNaN(r))return error.value;if(r<0)return error.num;r=Math.floor(r);return r>=t.length?REPT("0",r-t.length)+t:error.num};e.DEC2HEX=function(e,r){e=utils.parseNumber(e);if(e instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return error.num;if(e<0)return(1099511627776+e).toString(16);var t=parseInt(e,10).toString(16);if("undefined"===typeof r)return t;if(isNaN(r))return error.value;if(r<0)return error.num;r=Math.floor(r);return r>=t.length?REPT("0",r-t.length)+t:error.num};e.DEC2OCT=function(e,r){e=utils.parseNumber(e);if(e instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return error.num;if(e<0)return(1073741824+e).toString(8);var t=parseInt(e,10).toString(8);if("undefined"===typeof r)return t;if(isNaN(r))return error.value;if(r<0)return error.num;r=Math.floor(r);return r>=t.length?REPT("0",r-t.length)+t:error.num};e.DELTA=function(e,r){r=void 0===r?0:r;e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:e===r?1:0};e.ERF=function(e,r){};e.ERF.PRECISE=function(){};e.ERFC=function(e){};e.ERFC.PRECISE=function(){};e.GESTEP=function(e,r){r=r||0;e=utils.parseNumber(e);return utils.anyIsError(r,e)?e:e>=r?1:0};e.HEX2BIN=function(e,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var t=10===e.length&&"f"===e.substring(0,1).toLowerCase();var o=t?parseInt(e,16)-1099511627776:parseInt(e,16);if(o<-512||o>511)return error.num;if(t)return"1"+REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var s=o.toString(2);if(void 0===r)return s;if(isNaN(r))return error.value;if(r<0)return error.num;r=Math.floor(r);return r>=s.length?REPT("0",r-s.length)+s:error.num};e.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var r=parseInt(e,16);return r>=549755813888?r-1099511627776:r};e.HEX2OCT=function(e,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return error.num;var t=parseInt(e,16);if(t>536870911&&t<0xffe0000000)return error.num;if(t>=0xffe0000000)return(t-0xffc0000000).toString(8);var o=t.toString(8);if(void 0===r)return o;if(isNaN(r))return error.value;if(r<0)return error.num;r=Math.floor(r);return r>=o.length?REPT("0",r-o.length)+o:error.num};e.IMABS=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);return utils.anyIsError(t,o)?error.value:Math.sqrt(Math.pow(t,2)+Math.pow(o,2))};e.IMAGINARY=function(e){if(void 0===e||true===e||false===e)return error.value;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var r=e.indexOf("+");var t=e.indexOf("-");0===r&&(r=e.indexOf("+",1));0===t&&(t=e.indexOf("-",1));var o=e.substring(e.length-1,e.length);var s="i"===o||"j"===o;return r>=0||t>=0?s?r>=0?isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?error.num:Number(e.substring(r+1,e.length-1)):isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?error.num:-Number(e.substring(t+1,e.length-1)):error.num:s?isNaN(e.substring(0,e.length-1))?error.num:e.substring(0,e.length-1):isNaN(e)?error.num:0};e.IMARGUMENT=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);return utils.anyIsError(t,o)?error.value:0===t&&0===o?error.div0:0===t&&o>0?Math.PI/2:0===t&&o<0?-Math.PI/2:0===o&&t>0?0:0===o&&t<0?-Math.PI:t>0?Math.atan(o/t):t<0&&o>=0?Math.atan(o/t)+Math.PI:Math.atan(o/t)-Math.PI};e.IMCONJUGATE=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);if(utils.anyIsError(t,o))return error.value;var s=r.substring(r.length-1);s="i"===s||"j"===s?s:"i";return 0!==o?e.COMPLEX(t,-o,s):r};e.IMCOS=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);if(utils.anyIsError(t,o))return error.value;var s=r.substring(r.length-1);s="i"===s||"j"===s?s:"i";return e.COMPLEX(Math.cos(t)*(Math.exp(o)+Math.exp(-o))/2,-Math.sin(t)*(Math.exp(o)-Math.exp(-o))/2,s)};e.IMCOSH=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);if(utils.anyIsError(t,o))return error.value;var s=r.substring(r.length-1);s="i"===s||"j"===s?s:"i";return e.COMPLEX(Math.cos(o)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(o)*(Math.exp(t)-Math.exp(-t))/2,s)};e.IMCOT=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);return utils.anyIsError(t,o)?error.value:e.IMDIV(e.IMCOS(r),e.IMSIN(r))};e.IMDIV=function(r,t){var o=e.IMREAL(r);var s=e.IMAGINARY(r);var a=e.IMREAL(t);var u=e.IMAGINARY(t);if(utils.anyIsError(o,s,a,u))return error.value;var b=r.substring(r.length-1);var d=t.substring(t.length-1);var f="i";("j"===b||"j"===d)&&(f="j");if(0===a&&0===u)return error.num;var h=a*a+u*u;return e.COMPLEX((o*a+s*u)/h,(s*a-o*u)/h,f)};e.IMEXP=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);if(utils.anyIsError(t,o))return error.value;var s=r.substring(r.length-1);s="i"===s||"j"===s?s:"i";var a=Math.exp(t);return e.COMPLEX(a*Math.cos(o),a*Math.sin(o),s)};e.IMLN=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);if(utils.anyIsError(t,o))return error.value;var s=r.substring(r.length-1);s="i"===s||"j"===s?s:"i";return e.COMPLEX(Math.log(Math.sqrt(t*t+o*o)),Math.atan(o/t),s)};e.IMLOG10=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);if(utils.anyIsError(t,o))return error.value;var s=r.substring(r.length-1);s="i"===s||"j"===s?s:"i";return e.COMPLEX(Math.log(Math.sqrt(t*t+o*o))/Math.log(10),Math.atan(o/t)/Math.log(10),s)};e.IMLOG2=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);if(utils.anyIsError(t,o))return error.value;var s=r.substring(r.length-1);s="i"===s||"j"===s?s:"i";return e.COMPLEX(Math.log(Math.sqrt(t*t+o*o))/Math.log(2),Math.atan(o/t)/Math.log(2),s)};e.IMPOWER=function(r,t){t=utils.parseNumber(t);var o=e.IMREAL(r);var s=e.IMAGINARY(r);if(utils.anyIsError(t,o,s))return error.value;var a=r.substring(r.length-1);a="i"===a||"j"===a?a:"i";var u=Math.pow(e.IMABS(r),t);var b=e.IMARGUMENT(r);return e.COMPLEX(u*Math.cos(t*b),u*Math.sin(t*b),a)};e.IMPRODUCT=function(){var r=arguments[0];for(var t=1;t<arguments.length;t++){var o=e.IMREAL(r);var s=e.IMAGINARY(r);var a=e.IMREAL(arguments[t]);var u=e.IMAGINARY(arguments[t]);if(utils.anyIsError(o,s,a,u))return error.value;r=e.COMPLEX(o*a-s*u,o*u+s*a)}return r};e.IMREAL=function(e){if(void 0===e||true===e||false===e)return error.value;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var r=e.indexOf("+");var t=e.indexOf("-");0===r&&(r=e.indexOf("+",1));0===t&&(t=e.indexOf("-",1));var o=e.substring(e.length-1,e.length);var s="i"===o||"j"===o;return r>=0||t>=0?s?r>=0?isNaN(e.substring(0,r))||isNaN(e.substring(r+1,e.length-1))?error.num:Number(e.substring(0,r)):isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?error.num:Number(e.substring(0,t)):error.num:s?isNaN(e.substring(0,e.length-1))?error.num:0:isNaN(e)?error.num:e};e.IMSEC=function(r){if(true===r||false===r)return error.value;var t=e.IMREAL(r);var o=e.IMAGINARY(r);return utils.anyIsError(t,o)?error.value:e.IMDIV("1",e.IMCOS(r))};e.IMSECH=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);return utils.anyIsError(t,o)?error.value:e.IMDIV("1",e.IMCOSH(r))};e.IMSIN=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);if(utils.anyIsError(t,o))return error.value;var s=r.substring(r.length-1);s="i"===s||"j"===s?s:"i";return e.COMPLEX(Math.sin(t)*(Math.exp(o)+Math.exp(-o))/2,Math.cos(t)*(Math.exp(o)-Math.exp(-o))/2,s)};e.IMSINH=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);if(utils.anyIsError(t,o))return error.value;var s=r.substring(r.length-1);s="i"===s||"j"===s?s:"i";return e.COMPLEX(Math.cos(o)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(o)*(Math.exp(t)+Math.exp(-t))/2,s)};e.IMSQRT=function(r){var t=e.IMREAL(r);var o=e.IMAGINARY(r);if(utils.anyIsError(t,o))return error.value;var s=r.substring(r.length-1);s="i"===s||"j"===s?s:"i";var a=Math.sqrt(e.IMABS(r));var u=e.IMARGUMENT(r);return e.COMPLEX(a*Math.cos(u/2),a*Math.sin(u/2),s)};e.IMCSC=function(r){if(true===r||false===r)return error.value;var t=e.IMREAL(r);var o=e.IMAGINARY(r);return utils.anyIsError(t,o)?error.num:e.IMDIV("1",e.IMSIN(r))};e.IMCSCH=function(r){if(true===r||false===r)return error.value;var t=e.IMREAL(r);var o=e.IMAGINARY(r);return utils.anyIsError(t,o)?error.num:e.IMDIV("1",e.IMSINH(r))};e.IMSUB=function(e,r){var t=this.IMREAL(e);var o=this.IMAGINARY(e);var s=this.IMREAL(r);var a=this.IMAGINARY(r);if(utils.anyIsError(t,o,s,a))return error.value;var u=e.substring(e.length-1);var b=r.substring(r.length-1);var d="i";("j"===u||"j"===b)&&(d="j");return this.COMPLEX(t-s,o-a,d)};e.IMSUM=function(){var e=utils.flatten(arguments);var r=e[0];for(var t=1;t<e.length;t++){var o=this.IMREAL(r);var s=this.IMAGINARY(r);var a=this.IMREAL(e[t]);var u=this.IMAGINARY(e[t]);if(utils.anyIsError(o,s,a,u))return error.value;r=this.COMPLEX(o+a,s+u)}return r};e.IMTAN=function(r){if(true===r||false===r)return error.value;var t=e.IMREAL(r);var o=e.IMAGINARY(r);return utils.anyIsError(t,o)?error.value:this.IMDIV(this.IMSIN(r),this.IMCOS(r))};e.OCT2BIN=function(e,r){if(!/^[0-7]{1,10}$/.test(e))return error.num;var t=10===e.length&&"7"===e.substring(0,1);var o=t?parseInt(e,8)-1073741824:parseInt(e,8);if(o<-512||o>511)return error.num;if(t)return"1"+REPT("0",9-(512+o).toString(2).length)+(512+o).toString(2);var s=o.toString(2);if("undefined"===typeof r)return s;if(isNaN(r))return error.value;if(r<0)return error.num;r=Math.floor(r);return r>=s.length?REPT("0",r-s.length)+s:error.num};e.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return error.num;var r=parseInt(e,8);return r>=536870912?r-1073741824:r};e.OCT2HEX=function(e,r){if(!/^[0-7]{1,10}$/.test(e))return error.num;var t=parseInt(e,8);if(t>=536870912)return"ff"+(t+3221225472).toString(16);var o=t.toString(16);if(void 0===r)return o;if(isNaN(r))return error.value;if(r<0)return error.num;r=Math.floor(r);return r>=o.length?REPT("0",r-o.length)+o:error.num};return e}();met.financial=function(){var e={};function validDate(e){return e&&e.getTime&&!isNaN(e.getTime())}function ensureDate(e){return e instanceof Date?e:new Date(e)}e.ACCRINT=function(e,r,t,o,s,a,u){e=ensureDate(e);r=ensureDate(r);t=ensureDate(t);if(!validDate(e)||!validDate(r)||!validDate(t))return"#VALUE!";if(o<=0||s<=0)return"#NUM!";if(-1===[1,2,4].indexOf(a))return"#NUM!";if(-1===[0,1,2,3,4].indexOf(u))return"#NUM!";if(t<=e)return"#NUM!";s=s||0;u=u||0;return s*o*YEARFRAC(e,t,u)};e.ACCRINTM=null;e.AMORDEGRC=null;e.AMORLINC=null;e.COUPDAYBS=null;e.COUPDAYS=null;e.COUPDAYSNC=null;e.COUPNCD=null;e.COUPNUM=null;e.COUPPCD=null;e.CUMIPMT=function(r,t,o,s,a,u){r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);if(utils.anyIsError(r,t,o))return error.value;if(r<=0||t<=0||o<=0)return error.num;if(s<1||a<1||s>a)return error.num;if(0!==u&&1!==u)return error.num;var b=e.PMT(r,t,o,0,u);var d=0;if(1===s&&0===u){d=-o;s++}for(var f=s;f<=a;f++)d+=1===u?e.FV(r,f-2,b,o,1)-b:e.FV(r,f-1,b,o,0);d*=r;return d};e.CUMPRINC=function(r,t,o,s,a,u){r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);if(utils.anyIsError(r,t,o))return error.value;if(r<=0||t<=0||o<=0)return error.num;if(s<1||a<1||s>a)return error.num;if(0!==u&&1!==u)return error.num;var b=e.PMT(r,t,o,0,u);var d=0;if(1===s){d=0===u?b+o*r:b;s++}for(var f=s;f<=a;f++)d+=u>0?b-(e.FV(r,f-2,b,o,1)-b)*r:b-e.FV(r,f-1,b,o,0)*r;return d};e.DB=function(e,r,t,o,s){s=void 0===s?12:s;e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);s=utils.parseNumber(s);if(utils.anyIsError(e,r,t,o,s))return error.value;if(e<0||r<0||t<0||o<0)return error.num;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(s))return error.num;if(o>t)return error.num;if(r>=e)return 0;var a=(1-Math.pow(r/e,1/t)).toFixed(3);var u=e*a*s/12;var b=u;var d=0;var f=o===t?t-1:o;for(var h=2;h<=f;h++){d=(e-b)*a;b+=d}return 1===o?u:o===t?(e-b)*a:d};e.DDB=function(e,r,t,o,s){s=void 0===s?2:s;e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);s=utils.parseNumber(s);if(utils.anyIsError(e,r,t,o,s))return error.value;if(e<0||r<0||t<0||o<0||s<=0)return error.num;if(o>t)return error.num;if(r>=e)return 0;var a=0;var u=0;for(var b=1;b<=o;b++){u=Math.min(s/t*(e-a),e-r-a);a+=u}return u};e.DISC=null;e.DOLLARDE=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;if(r<0)return error.num;if(r>=0&&r<1)return error.div0;r=parseInt(r,10);var t=parseInt(e,10);t+=e%1*Math.pow(10,Math.ceil(Math.log(r)/Math.LN10))/r;var o=Math.pow(10,Math.ceil(Math.log(r)/Math.LN2)+1);t=Math.round(t*o)/o;return t};e.DOLLARFR=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;if(r<0)return error.num;if(r>=0&&r<1)return error.div0;r=parseInt(r,10);var t=parseInt(e,10);t+=e%1*Math.pow(10,-Math.ceil(Math.log(r)/Math.LN10))*r;return t};e.DURATION=null;e.EFFECT=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;if(e<=0||r<1)return error.num;r=parseInt(r,10);return Math.pow(1+e/r,r)-1};e.FV=function(e,r,t,o,s){o=o||0;s=s||0;e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);s=utils.parseNumber(s);if(utils.anyIsError(e,r,t,o,s))return error.value;var a;if(0===e)a=o+t*r;else{var u=Math.pow(1+e,r);a=1===s?o*u+t*(1+e)*(u-1)/e:o*u+t*(u-1)/e}return-a};e.FVSCHEDULE=function(e,r){e=utils.parseNumber(e);r=utils.parseNumberArray(utils.flatten(r));if(utils.anyIsError(e,r))return error.value;var t=r.length;var o=e;for(var s=0;s<t;s++)o*=1+r[s];return o};e.INTRATE=null;e.IPMT=function(r,t,o,s,a,u){a=a||0;u=u||0;r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);s=utils.parseNumber(s);a=utils.parseNumber(a);u=utils.parseNumber(u);if(utils.anyIsError(r,t,o,s,a,u))return error.value;var b=e.PMT(r,o,s,a,u);var d;d=1===t?1===u?0:-s:1===u?e.FV(r,t-2,b,s,1)-b:e.FV(r,t-1,b,s,0);return d*r};e.IRR=function(e,r){r=r||0;e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;var irrResult=function(e,r,t){var o=t+1;var s=e[0];for(var a=1;a<e.length;a++)s+=e[a]/Math.pow(o,(r[a]-r[0])/365);return s};var irrResultDeriv=function(e,r,t){var o=t+1;var s=0;for(var a=1;a<e.length;a++){var u=(r[a]-r[0])/365;s-=u*e[a]/Math.pow(o,u+1)}return s};var t=[];var o=false;var s=false;for(var a=0;a<e.length;a++){t[a]=0===a?0:t[a-1]+365;e[a]>0&&(o=true);e[a]<0&&(s=true)}if(!o||!s)return error.num;r=void 0===r?.1:r;var u=r;var b=1e-10;var d,f,h;var g=true;do{h=irrResult(e,t,u);d=u-h/irrResultDeriv(e,t,u);f=Math.abs(d-u);u=d;g=f>b&&Math.abs(h)>b}while(g);return u};e.ISPMT=function(e,r,t,o){e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);return utils.anyIsError(e,r,t,o)?error.value:o*e*(r/t-1)};e.MDURATION=null;e.MIRR=function(r,t,o){r=utils.parseNumberArray(utils.flatten(r));t=utils.parseNumber(t);o=utils.parseNumber(o);if(utils.anyIsError(r,t,o))return error.value;var s=r.length;var a=[];var u=[];for(var b=0;b<s;b++)r[b]<0?a.push(r[b]):u.push(r[b]);var d=-e.NPV(o,u)*Math.pow(1+o,s-1);var f=e.NPV(t,a)*(1+t);return Math.pow(d/f,1/(s-1))-1};e.NOMINAL=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;if(e<=0||r<1)return error.num;r=parseInt(r,10);return(Math.pow(e+1,1/r)-1)*r};e.NPER=function(e,r,t,o,s){s=void 0===s?0:s;o=void 0===o?0:o;e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);s=utils.parseNumber(s);if(utils.anyIsError(e,r,t,o,s))return error.value;var a=r*(1+e*s)-o*e;var u=t*e+r*(1+e*s);return Math.log(a/u)/Math.log(1+e)};e.NPV=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;var r=e[0];var t=0;for(var o=1;o<e.length;o++)t+=e[o]/Math.pow(1+r,o);return t};e.ODDFPRICE=null;e.ODDFYIELD=null;e.ODDLPRICE=null;e.ODDLYIELD=null;e.PDURATION=function(e,r,t){e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);return utils.anyIsError(e,r,t)?error.value:e<=0?error.num:(Math.log(t)-Math.log(r))/Math.log(1+e)};e.PMT=function(e,r,t,o,s){o=o||0;s=s||0;e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);s=utils.parseNumber(s);if(utils.anyIsError(e,r,t,o,s))return error.value;var a;if(0===e)a=(t+o)/r;else{var u=Math.pow(1+e,r);a=1===s?(o*e/(u-1)+t*e/(1-1/u))/(1+e):o*e/(u-1)+t*e/(1-1/u)}return-a};e.PPMT=function(r,t,o,s,a,u){a=a||0;u=u||0;r=utils.parseNumber(r);o=utils.parseNumber(o);s=utils.parseNumber(s);a=utils.parseNumber(a);u=utils.parseNumber(u);return utils.anyIsError(r,o,s,a,u)?error.value:e.PMT(r,o,s,a,u)-e.IPMT(r,t,o,s,a,u)};e.PRICE=null;e.PRICEDISC=null;e.PRICEMAT=null;e.PV=function(e,r,t,o,s){o=o||0;s=s||0;e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);s=utils.parseNumber(s);return utils.anyIsError(e,r,t,o,s)?error.value:0===e?-t*r-o:((1-Math.pow(1+e,r))/e*t*(1+e*s)-o)/Math.pow(1+e,r)};e.RATE=function(e,r,t,o,s,a){a=void 0===a?.01:a;o=void 0===o?0:o;s=void 0===s?0:s;e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);s=utils.parseNumber(s);a=utils.parseNumber(a);if(utils.anyIsError(e,r,t,o,s,a))return error.value;var u=1e-6;var b=100;var d=0;var f=false;var h=a;while(d<b&&!f){var g=Math.pow(h+1,e);var m=Math.pow(h+1,e-1);var v=o+g*t+r*(g-1)*(h*s+1)/h;var C=e*m*t-r*(g-1)*(h*s+1)/Math.pow(h,2);var E=e*r*m*(h*s+1)/h+r*(g-1)*s/h;var A=h-v/(C+E);Math.abs(A-h)<u&&(f=true);d++;h=A}return f?h:Number.NaN+h};e.RECEIVED=null;e.RRI=function(e,r,t){e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);return utils.anyIsError(e,r,t)?error.value:0===e||0===r?error.num:Math.pow(t/r,1/e)-1};e.SLN=function(e,r,t){e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);return utils.anyIsError(e,r,t)?error.value:0===t?error.num:(e-r)/t};e.SYD=function(e,r,t,o){e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumber(o);if(utils.anyIsError(e,r,t,o))return error.value;if(0===t)return error.num;if(o<1||o>t)return error.num;o=parseInt(o,10);return(e-r)*(t-o+1)*2/(t*(t+1))};e.TBILLEQ=function(e,r,t){e=utils.parseDate(e);r=utils.parseDate(r);t=utils.parseNumber(t);return utils.anyIsError(e,r,t)?error.value:t<=0||e>r||r-e>31536e6?error.num:365*t/(360-t*DAYS360(e,r,false))};e.TBILLPRICE=function(e,r,t){e=utils.parseDate(e);r=utils.parseDate(r);t=utils.parseNumber(t);return utils.anyIsError(e,r,t)?error.value:t<=0||e>r||r-e>31536e6?error.num:100*(1-t*DAYS360(e,r,false)/360)};e.TBILLYIELD=function(e,r,t){e=utils.parseDate(e);r=utils.parseDate(r);t=utils.parseNumber(t);return utils.anyIsError(e,r,t)?error.value:t<=0||e>r||r-e>31536e6?error.num:360*(100-t)/(t*DAYS360(e,r,false))};e.VDB=null;e.XIRR=function(e,r,t){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseDateArray(utils.flatten(r));t=utils.parseNumber(t);if(utils.anyIsError(e,r,t))return error.value;var irrResult=function(e,r,t){var o=t+1;var s=e[0];for(var a=1;a<e.length;a++)s+=e[a]/Math.pow(o,DAYS(r[a],r[0])/365);return s};var irrResultDeriv=function(e,r,t){var o=t+1;var s=0;for(var a=1;a<e.length;a++){var u=DAYS(r[a],r[0])/365;s-=u*e[a]/Math.pow(o,u+1)}return s};var o=false;var s=false;for(var a=0;a<e.length;a++){e[a]>0&&(o=true);e[a]<0&&(s=true)}if(!o||!s)return error.num;t=t||.1;var u=t;var b=1e-10;var d,f,h;var g=true;do{h=irrResult(e,r,u);d=u-h/irrResultDeriv(e,r,u);f=Math.abs(d-u);u=d;g=f>b&&Math.abs(h)>b}while(g);return u};e.XNPV=function(e,r,t){e=utils.parseNumber(e);r=utils.parseNumberArray(utils.flatten(r));t=utils.parseDateArray(utils.flatten(t));if(utils.anyIsError(e,r,t))return error.value;var o=0;for(var s=0;s<r.length;s++)o+=r[s]/Math.pow(1+e,DAYS(t[s],t[0])/365);return o};e.YIELD=null;e.YIELDDISC=null;e.YIELDMAT=null;return e}();met.information=function(){var e={};e.CELL=null;e.ERROR={};e.ERROR.TYPE=function(e){switch(e){case error.nil:return 1;case error.div0:return 2;case error.value:return 3;case error.ref:return 4;case error.name:return 5;case error.num:return 6;case error.na:return 7;case error.data:return 8}return error.na};e.INFO=null;e.ISBLANK=function(e){return null===e};e.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)};e.ISERR=function(e){return[error.value,error.ref,error.div0,error.num,error.name,error.nil].indexOf(e)>=0||"number"===typeof e&&(isNaN(e)||!isFinite(e))};e.ISERROR=function(r){return e.ISERR(r)||r===error.na};e.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))};e.ISFORMULA=null;e.ISLOGICAL=function(e){return true===e||false===e};e.ISNA=function(e){return e===error.na};e.ISNONTEXT=function(e){return"string"!==typeof e};e.ISNUMBER=function(e){return"number"===typeof e&&!isNaN(e)&&isFinite(e)};e.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))};e.ISREF=null;e.ISTEXT=function(e){return"string"===typeof e};e.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():true===e?1:false===e?0:this.ISERROR(e)?e:0};e.NA=function(){return error.na};e.SHEET=null;e.SHEETS=null;e.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0};return e}();met.logical=function(){var e={};e.AND=function(){var e=utils.flatten(arguments);var r=true;for(var t=0;t<e.length;t++)e[t]||(r=false);return r};e.CHOOSE=function(){if(arguments.length<2)return error.na;var e=arguments[0];return e<1||e>254||arguments.length<e+1?error.value:arguments[e]};e.FALSE=function(){return false};e.IF=function(e,r,t){return e?r:t};e.IFERROR=function(e,r){return ISERROR(e)?r:e};e.IFNA=function(e,r){return e===error.na?r:e};e.NOT=function(e){return!e};e.OR=function(){var e=utils.flatten(arguments);var r=false;for(var t=0;t<e.length;t++)e[t]&&(r=true);return r};e.TRUE=function(){return true};e.XOR=function(){var e=utils.flatten(arguments);var r=0;for(var t=0;t<e.length;t++)e[t]&&r++;return!!(1&Math.floor(Math.abs(r)))};e.SWITCH=function(){var e;if(arguments.length>0){var r=arguments[0];var t=arguments.length-1;var o=Math.floor(t/2);var s=false;var a=t%2===0?null:arguments[arguments.length-1];if(o)for(var u=0;u<o;u++)if(r===arguments[2*u+1]){e=arguments[2*u+2];s=true;break}!s&&a&&(e=a)}return e};return e}();met.math=function(){var exports={};exports.ABS=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.abs(utils.parseNumber(e))};exports.ACOS=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.acos(e)};exports.ACOSH=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.log(e+Math.sqrt(e*e-1))};exports.ACOT=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.atan(1/e)};exports.ACOTH=function(e){e=utils.parseNumber(e);return e instanceof Error?e:.5*Math.log((e+1)/(e-1))};exports.AGGREGATE=null;exports.ARABIC=function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return error.value;var r=0;e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(e){r+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}));return r};exports.ASIN=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.asin(e)};exports.ASINH=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))};exports.ATAN=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.atan(e)};exports.ATAN2=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:Math.atan2(e,r)};exports.ATANH=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.log((1+e)/(1-e))/2};exports.BASE=function(e,r,t){t=t||0;e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);if(utils.anyIsError(e,r,t))return error.value;t=void 0===t?0:t;var o=e.toString(r);return new Array(Math.max(t+1-o.length,0)).join("0")+o};exports.CEILING=function(e,r,t){r=void 0===r?1:r;t=void 0===t?0:t;e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);if(utils.anyIsError(e,r,t))return error.value;if(0===r)return 0;r=Math.abs(r);return e>=0?Math.ceil(e/r)*r:0===t?-1*Math.floor(Math.abs(e)/r)*r:-1*Math.ceil(Math.abs(e)/r)*r};exports.CEILING.MATH=exports.CEILING;exports.CEILING.PRECISE=exports.CEILING;exports.COMBIN=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:exports.FACT(e)/(exports.FACT(r)*exports.FACT(e-r))};exports.COMBINA=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:0===e&&0===r?1:exports.COMBIN(e+r-1,e-1)};exports.COS=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.cos(e)};exports.COSH=function(e){e=utils.parseNumber(e);return e instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2};exports.COT=function(e){e=utils.parseNumber(e);return e instanceof Error?e:1/Math.tan(e)};exports.COTH=function(e){e=utils.parseNumber(e);if(e instanceof Error)return e;var r=Math.exp(2*e);return(r+1)/(r-1)};exports.CSC=function(e){e=utils.parseNumber(e);return e instanceof Error?e:1/Math.sin(e)};exports.CSCH=function(e){e=utils.parseNumber(e);return e instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))};exports.DECIMAL=function(e,r){return arguments.length<1?error.value:parseInt(e,r)};exports.DEGREES=function(e){e=utils.parseNumber(e);return e instanceof Error?e:180*e/Math.PI};exports.EVEN=function(e){e=utils.parseNumber(e);return e instanceof Error?e:exports.CEILING(e,-2,-1)};exports.EXP=Math.exp;var MEMOIZED_FACT=[];exports.FACT=function(e){e=utils.parseNumber(e);if(e instanceof Error)return e;var r=Math.floor(e);if(0===r||1===r)return 1;if(MEMOIZED_FACT[r]>0)return MEMOIZED_FACT[r];MEMOIZED_FACT[r]=exports.FACT(r-1)*r;return MEMOIZED_FACT[r]};exports.FACTDOUBLE=function(e){e=utils.parseNumber(e);if(e instanceof Error)return e;var r=Math.floor(e);return r<=0?1:r*exports.FACTDOUBLE(r-2)};exports.FLOOR=function(e,r,t){r=void 0===r?1:r;t=void 0===t?0:t;e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);if(utils.anyIsError(e,r,t))return error.value;if(0===r)return 0;r=Math.abs(r);return e>=0?Math.floor(e/r)*r:0===t?-1*Math.ceil(Math.abs(e)/r)*r:-1*Math.floor(Math.abs(e)/r)*r};exports.FLOOR.MATH=exports.FLOOR;exports.GCD=null;exports.INT=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.floor(e)};exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var r,t,o,s,a=1;void 0!==(o=e.pop());)while(o>1){if(o%2){for(r=3,t=Math.floor(Math.sqrt(o));r<=t&&o%r;r+=2);s=r<=t?r:o}else s=2;for(o/=s,a*=s,r=e.length;r;e[--r]%s===0&&1===(e[r]/=s)&&e.splice(r,1));}return a};exports.LN=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.log(e)};exports.LOG=function(e,r){e=utils.parseNumber(e);r=void 0===r?10:utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:Math.log(e)/Math.log(r)};exports.LOG10=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.log(e)/Math.log(10)};exports.MDETERM=null;exports.MINVERSE=null;exports.MMULT=null;exports.MOD=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;if(0===r)return error.div0;var t=Math.abs(e%r);return r>0?t:-t};exports.MROUND=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:e*r<0?error.num:Math.round(e/r)*r};exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;var r=0;var t=1;for(var o=0;o<e.length;o++){r+=e[o];t*=exports.FACT(e[o])}return exports.FACT(r)/t};exports.MUNIT=null;exports.ODD=function(e){e=utils.parseNumber(e);if(e instanceof Error)return e;var r=Math.ceil(Math.abs(e));r=1&r?r:r+1;return e>0?r:-r};exports.PI=function(){return Math.PI};exports.POWER=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;var t=Math.pow(e,r);return isNaN(t)?error.num:t};exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;var r=1;for(var t=0;t<e.length;t++)r*=e[t];return r};exports.QUOTIENT=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:parseInt(e/r,10)};exports.RADIANS=function(e){e=utils.parseNumber(e);return e instanceof Error?e:e*Math.PI/180};exports.RAND=function(){return Math.random()};exports.RANDBETWEEN=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:e+Math.ceil((r-e+1)*Math.random())-1};exports.ROMAN=null;exports.ROUND=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:Math.round(e*Math.pow(10,r))/Math.pow(10,r)};exports.ROUNDDOWN=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;var t=e>0?1:-1;return t*Math.floor(Math.abs(e)*Math.pow(10,r))/Math.pow(10,r)};exports.ROUNDUP=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;var t=e>0?1:-1;return t*Math.ceil(Math.abs(e)*Math.pow(10,r))/Math.pow(10,r)};exports.SEC=function(e){e=utils.parseNumber(e);return e instanceof Error?e:1/Math.cos(e)};exports.SECH=function(e){e=utils.parseNumber(e);return e instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))};exports.SERIESSUM=function(e,r,t,o){e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);o=utils.parseNumberArray(o);if(utils.anyIsError(e,r,t,o))return error.value;var s=o[0]*Math.pow(e,r);for(var a=1;a<o.length;a++)s+=o[a]*Math.pow(e,r+a*t);return s};exports.SIGN=function(e){e=utils.parseNumber(e);return e instanceof Error?e:e<0?-1:0===e?0:1};exports.SIN=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.sin(e)};exports.SINH=function(e){e=utils.parseNumber(e);return e instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2};exports.SQRT=function(e){e=utils.parseNumber(e);return e instanceof Error?e:e<0?error.num:Math.sqrt(e)};exports.SQRTPI=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.sqrt(e*Math.PI)};exports.SUBTOTAL=null;exports.ADD=function(e,r){if(2!==arguments.length)return error.na;e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:e+r};exports.MINUS=function(e,r){if(2!==arguments.length)return error.na;e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:e-r};exports.DIVIDE=function(e,r){if(2!==arguments.length)return error.na;e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:0===r?error.div0:e/r};exports.MULTIPLY=function(e,r){if(2!==arguments.length)return error.na;e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:e*r};exports.GTE=function(e,r){if(2!==arguments.length)return error.na;e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.error:e>=r};exports.LT=function(e,r){if(2!==arguments.length)return error.na;e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.error:e<r};exports.LTE=function(e,r){if(2!==arguments.length)return error.na;e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.error:e<=r};exports.EQ=function(e,r){return 2!==arguments.length?error.na:e===r};exports.NE=function(e,r){return 2!==arguments.length?error.na:e!==r};exports.POW=function(e,r){if(2!==arguments.length)return error.na;e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.error:exports.POWER(e,r)};exports.SUM=function(){var e=0;var r=Object.keys(arguments);for(var t=0;t<r.length;++t){var o=arguments[r[t]];if("number"===typeof o)e+=o;else if("string"===typeof o){var s=parseFloat(o);!isNaN(s)&&(e+=s)}else Array.isArray(o)&&(e+=exports.SUM.apply(null,o))}return e};exports.SUMIF=function(){var args=utils.argsToArray(arguments);var criteria=args.pop();var range=utils.parseNumberArray(utils.flatten(args));if(range instanceof Error)return range;var result=0;for(var i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result};exports.SUMIFS=function(){var args=utils.argsToArray(arguments);var range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;var criteria=args;var n_range_elements=range.length;var n_criterias=criteria.length;var result=0;for(var i=0;i<n_range_elements;i++){var el=range[i];var condition="";for(var c=0;c<n_criterias;c+=2){isNaN(criteria[c][i])?condition+='"'+criteria[c][i]+'"'+criteria[c+1]:condition+=criteria[c][i]+criteria[c+1];c!==n_criterias-1&&(condition+=" && ")}condition=condition.slice(0,-4);eval(condition)&&(result+=el)}return result};exports.SUMPRODUCT=null;exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;var r=0;var t=e.length;for(var o=0;o<t;o++)r+=ISNUMBER(e[o])?e[o]*e[o]:0;return r};exports.SUMX2MY2=function(e,r){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumberArray(utils.flatten(r));if(utils.anyIsError(e,r))return error.value;var t=0;for(var o=0;o<e.length;o++)t+=e[o]*e[o]-r[o]*r[o];return t};exports.SUMX2PY2=function(e,r){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumberArray(utils.flatten(r));if(utils.anyIsError(e,r))return error.value;var t=0;e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumberArray(utils.flatten(r));for(var o=0;o<e.length;o++)t+=e[o]*e[o]+r[o]*r[o];return t};exports.SUMXMY2=function(e,r){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumberArray(utils.flatten(r));if(utils.anyIsError(e,r))return error.value;var t=0;e=utils.flatten(e);r=utils.flatten(r);for(var o=0;o<e.length;o++)t+=Math.pow(e[o]-r[o],2);return t};exports.TAN=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.tan(e)};exports.TANH=function(e){e=utils.parseNumber(e);if(e instanceof Error)return e;var r=Math.exp(2*e);return(r-1)/(r+1)};exports.TRUNC=function(e,r){r=void 0===r?0:r;e=utils.parseNumber(e);r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;var t=e>0?1:-1;return t*Math.floor(Math.abs(e)*Math.pow(10,r))/Math.pow(10,r)};return exports}();met.misc=function(){var e={};e.UNIQUE=function(){var e=[];for(var r=0;r<arguments.length;++r){var t=false;var o=arguments[r];for(var s=0;s<e.length;++s){t=e[s]===o;if(t)break}t||e.push(o)}return e};e.FLATTEN=utils.flatten;e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)};e.REFERENCE=function(e,r){try{var t=r.split(".");var o=e;for(var s=0;s<t.length;++s){var a=t[s];if("]"===a[a.length-1]){var u=a.indexOf("[");var b=a.substring(u+1,a.length-1);o=o[a.substring(0,u)][b]}else o=o[a]}return o}catch(e){}};e.JOIN=function(e,r){return e.join(r)};e.NUMBERS=function(){var e=utils.flatten(arguments);return e.filter((function(e){return"number"===typeof e}))};e.NUMERAL=null;return e}();met.text=function(){var e={};e.ASC=null;e.BAHTTEXT=null;e.CHAR=function(e){e=utils.parseNumber(e);return e instanceof Error?e:String.fromCharCode(e)};e.CLEAN=function(e){e=e||"";var r=/[\0-\x1F]/g;return e.replace(r,"")};e.CODE=function(e){e=e||"";return e.charCodeAt(0)};e.CONCATENATE=function(){var e=utils.flatten(arguments);var r=0;while((r=e.indexOf(true))>-1)e[r]="TRUE";var t=0;while((t=e.indexOf(false))>-1)e[t]="FALSE";return e.join("")};e.DBCS=null;e.DOLLAR=null;e.EXACT=function(e,r){return e===r};e.FIND=function(e,r,t){t=void 0===t?0:t;return r?r.indexOf(e,t-1)+1:null};e.FIXED=null;e.HTML2TEXT=function(e){var r="";e&&(e instanceof Array?e.forEach((function(e){""!==r&&(r+="\n");r+=e.replace(/<(?:.|\n)*?>/gm,"")})):r=e.replace(/<(?:.|\n)*?>/gm,""));return r};e.LEFT=function(e,r){r=void 0===r?1:r;r=utils.parseNumber(r);return r instanceof Error||"string"!==typeof e?error.value:e?e.substring(0,r):null};e.LEN=function(e){return 0===arguments.length?error.error:"string"===typeof e?e?e.length:0:e.length?e.length:error.value};e.LOWER=function(e){return"string"!==typeof e?error.value:e?e.toLowerCase():e};e.MID=function(e,r,t){r=utils.parseNumber(r);t=utils.parseNumber(t);if(utils.anyIsError(r,t)||"string"!==typeof e)return t;var o=r-1;var s=o+t;return e.substring(o,s)};e.NUMBERVALUE=null;e.PRONETIC=null;e.PROPER=function(e){if(void 0===e||0===e.length)return error.value;true===e&&(e="TRUE");false===e&&(e="FALSE");if(isNaN(e)&&"number"===typeof e)return error.value;"number"===typeof e&&(e=""+e);return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))};e.REGEXEXTRACT=function(e,r){var t=e.match(new RegExp(r));return t?t[t.length>1?t.length-1:0]:null};e.REGEXMATCH=function(e,r,t){var o=e.match(new RegExp(r));return t?o:!!o};e.REGEXREPLACE=function(e,r,t){return e.replace(new RegExp(r),t)};e.REPLACE=function(e,r,t,o){r=utils.parseNumber(r);t=utils.parseNumber(t);return utils.anyIsError(r,t)||"string"!==typeof e||"string"!==typeof o?error.value:e.substr(0,r-1)+o+e.substr(r-1+t)};e.REPT=function(e,r){r=utils.parseNumber(r);return r instanceof Error?r:new Array(r+1).join(e)};e.RIGHT=function(e,r){r=void 0===r?1:r;r=utils.parseNumber(r);return r instanceof Error?r:e?e.substring(e.length-r):null};e.SEARCH=function(e,r,t){var o;if("string"!==typeof e||"string"!==typeof r)return error.value;t=void 0===t?0:t;o=r.toLowerCase().indexOf(e.toLowerCase(),t-1)+1;return 0===o?error.value:o};e.SPLIT=function(e,r){return e.split(r)};e.SUBSTITUTE=function(e,r,t,o){if(!(e&&r&&t))return e;if(void 0===o)return e.replace(new RegExp(r,"g"),t);var s=0;var a=0;while(e.indexOf(r,s)>0){s=e.indexOf(r,s+1);a++;if(a===o)return e.substring(0,s)+t+e.substring(s+r.length)}};e.T=function(e){return"string"===typeof e?e:""};e.TEXT=null;e.TRIM=function(e){return"string"!==typeof e?error.value:e.replace(/ +/g," ").trim()};e.UNICHAR=e.CHAR;e.UNICODE=e.CODE;e.UPPER=function(e){return"string"!==typeof e?error.value:e.toUpperCase()};e.VALUE=null;return e}();met.stats=function(){var exports={};var SQRT2PI=2.5066282746310002;exports.AVEDEV=null;exports.AVERAGE=function(){var e=utils.numbers(utils.flatten(arguments));var r=e.length;var t=0;var o=0;for(var s=0;s<r;s++){t+=e[s];o+=1}return t/o};exports.AVERAGEA=function(){var e=utils.flatten(arguments);var r=e.length;var t=0;var o=0;for(var s=0;s<r;s++){var a=e[s];"number"===typeof a&&(t+=a);true===a&&t++;null!==a&&o++}return t/o};exports.AVERAGEIF=function(range,criteria,average_range){average_range=average_range||range;range=utils.flatten(range);average_range=utils.parseNumberArray(utils.flatten(average_range));if(average_range instanceof Error)return average_range;var average_count=0;var result=0;for(var i=0;i<range.length;i++)if(eval(range[i]+criteria)){result+=average_range[i];average_count++}return result/average_count};exports.AVERAGEIFS=null;exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length};exports.COUNTA=function(){var e=utils.flatten(arguments);return e.length-exports.COUNTBLANK(e)};exports.COUNTIN=function(e,r){var t=0;for(var o=0;o<e.length;o++)e[o]===r&&t++;return t};exports.COUNTBLANK=function(){var e=utils.flatten(arguments);var r=0;var t;for(var o=0;o<e.length;o++){t=e[o];null!==t&&""!==t||r++}return r};exports.COUNTIF=function(){var args=utils.argsToArray(arguments);var criteria=args.pop();var range=utils.flatten(args);/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');var matches=0;for(var i=0;i<range.length;i++)"string"!==typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches};exports.COUNTIFS=function(){var args=utils.argsToArray(arguments);var results=new Array(utils.flatten(args[0]).length);for(var i=0;i<results.length;i++)results[i]=true;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]);var criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)"string"!==typeof range[j]?results[j]=results[j]&&eval(range[j]+criteria):results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result};exports.COUNTUNIQUE=function(){return UNIQUE.apply(null,utils.flatten(arguments)).length};exports.FISHER=function(e){e=utils.parseNumber(e);return e instanceof Error?e:Math.log((1+e)/(1-e))/2};exports.FISHERINV=function(e){e=utils.parseNumber(e);if(e instanceof Error)return e;var r=Math.exp(2*e);return(r-1)/(r+1)};exports.FREQUENCY=function(e,r){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumberArray(utils.flatten(r));if(utils.anyIsError(e,r))return error.value;var t=e.length;var o=r.length;var s=[];for(var a=0;a<=o;a++){s[a]=0;for(var u=0;u<t;u++)0===a?e[u]<=r[0]&&(s[0]+=1):a<o?e[u]>r[a-1]&&e[u]<=r[a]&&(s[a]+=1):a===o&&e[u]>r[o-1]&&(s[o]+=1)}return s};exports.LARGE=function(e,r){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumber(r);return utils.anyIsError(e,r)?e:e.sort((function(e,r){return r-e}))[r-1]};exports.MAX=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)};exports.MAXA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)};exports.MIN=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)};exports.MINA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)};exports.MODE={};exports.MODE.MULT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;var r=e.length;var t={};var o=[];var s=0;var a;for(var u=0;u<r;u++){a=e[u];t[a]=t[a]?t[a]+1:1;if(t[a]>s){s=t[a];o=[]}t[a]===s&&(o[o.length]=a)}return o};exports.MODE.SNGL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:exports.MODE.MULT(e).sort((function(e,r){return e-r}))[0]};exports.PERCENTILE={};exports.PERCENTILE.EXC=function(e,r){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;e=e.sort((function(e,r){return e-r}));var t=e.length;if(r<1/(t+1)||r>1-1/(t+1))return error.num;var o=r*(t+1)-1;var s=Math.floor(o);return utils.cleanFloat(o===s?e[o]:e[s]+(o-s)*(e[s+1]-e[s]))};exports.PERCENTILE.INC=function(e,r){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;e=e.sort((function(e,r){return e-r}));var t=e.length;var o=r*(t-1);var s=Math.floor(o);return utils.cleanFloat(o===s?e[o]:e[s]+(o-s)*(e[s+1]-e[s]))};exports.PERCENTRANK={};exports.PERCENTRANK.EXC=function(e,r,t){t=void 0===t?3:t;e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumber(r);t=utils.parseNumber(t);if(utils.anyIsError(e,r,t))return error.value;e=e.sort((function(e,r){return e-r}));var o=UNIQUE.apply(null,e);var s=e.length;var a=o.length;var u=Math.pow(10,t);var b=0;var d=false;var f=0;while(!d&&f<a){if(r===o[f]){b=(e.indexOf(o[f])+1)/(s+1);d=true}else if(r>=o[f]&&(r<o[f+1]||f===a-1)){b=(e.indexOf(o[f])+1+(r-o[f])/(o[f+1]-o[f]))/(s+1);d=true}f++}return Math.floor(b*u)/u};exports.PERCENTRANK.INC=function(e,r,t){t=void 0===t?3:t;e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumber(r);t=utils.parseNumber(t);if(utils.anyIsError(e,r,t))return error.value;e=e.sort((function(e,r){return e-r}));var o=UNIQUE.apply(null,e);var s=e.length;var a=o.length;var u=Math.pow(10,t);var b=0;var d=false;var f=0;while(!d&&f<a){if(r===o[f]){b=e.indexOf(o[f])/(s-1);d=true}else if(r>=o[f]&&(r<o[f+1]||f===a-1)){b=(e.indexOf(o[f])+(r-o[f])/(o[f+1]-o[f]))/(s-1);d=true}f++}return Math.floor(b*u)/u};exports.PERMUT=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:FACT(e)/FACT(e-r)};exports.PERMUTATIONA=function(e,r){e=utils.parseNumber(e);r=utils.parseNumber(r);return utils.anyIsError(e,r)?error.value:Math.pow(e,r)};exports.PHI=function(e){e=utils.parseNumber(e);return e instanceof Error?error.value:Math.exp(-.5*e*e)/SQRT2PI};exports.PROB=function(e,r,t,o){if(void 0===t)return 0;o=void 0===o?t:o;e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumberArray(utils.flatten(r));t=utils.parseNumber(t);o=utils.parseNumber(o);if(utils.anyIsError(e,r,t,o))return error.value;if(t===o)return e.indexOf(t)>=0?r[e.indexOf(t)]:0;var s=e.sort((function(e,r){return e-r}));var a=s.length;var u=0;for(var b=0;b<a;b++)s[b]>=t&&s[b]<=o&&(u+=r[e.indexOf(s[b])]);return u};exports.QUARTILE={};exports.QUARTILE.EXC=function(e,r){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;switch(r){case 1:return exports.PERCENTILE.EXC(e,.25);case 2:return exports.PERCENTILE.EXC(e,.5);case 3:return exports.PERCENTILE.EXC(e,.75);default:return error.num}};exports.QUARTILE.INC=function(e,r){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;switch(r){case 1:return exports.PERCENTILE.INC(e,.25);case 2:return exports.PERCENTILE.INC(e,.5);case 3:return exports.PERCENTILE.INC(e,.75);default:return error.num}};exports.RANK={};exports.RANK.AVG=function(e,r,t){e=utils.parseNumber(e);r=utils.parseNumberArray(utils.flatten(r));if(utils.anyIsError(e,r))return error.value;r=utils.flatten(r);t=t||false;var o=t?function(e,r){return e-r}:function(e,r){return r-e};r=r.sort(o);var s=r.length;var a=0;for(var u=0;u<s;u++)r[u]===e&&a++;return a>1?(2*r.indexOf(e)+a+1)/2:r.indexOf(e)+1};exports.RANK.EQ=function(e,r,t){e=utils.parseNumber(e);r=utils.parseNumberArray(utils.flatten(r));if(utils.anyIsError(e,r))return error.value;t=t||false;var o=t?function(e,r){return e-r}:function(e,r){return r-e};r=r.sort(o);return r.indexOf(e)+1};exports.RSQ=function(e,r){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumberArray(utils.flatten(r));return utils.anyIsError(e,r)?error.value:Math.pow(exports.PEARSON(e,r),2)};exports.SMALL=function(e,r){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumber(r);return utils.anyIsError(e,r)?e:e.sort((function(e,r){return e-r}))[r-1]};exports.STANDARDIZE=function(e,r,t){e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);return utils.anyIsError(e,r,t)?error.value:(e-r)/t};exports.STDEV={};exports.STDEV.P=function(){var e=exports.VAR.P.apply(this||_global,arguments);return Math.sqrt(e)};exports.STDEV.S=function(){var e=exports.VAR.S.apply(this||_global,arguments);return Math.sqrt(e)};exports.STDEVA=function(){var e=exports.VARA.apply(this||_global,arguments);return Math.sqrt(e)};exports.STDEVPA=function(){var e=exports.VARPA.apply(this||_global,arguments);return Math.sqrt(e)};exports.VAR={};exports.VAR.P=function(){var e=utils.numbers(utils.flatten(arguments));var r=e.length;var t=0;var o=exports.AVERAGE(e);for(var s=0;s<r;s++)t+=Math.pow(e[s]-o,2);return t/r};exports.VAR.S=function(){var e=utils.numbers(utils.flatten(arguments));var r=e.length;var t=0;var o=exports.AVERAGE(e);for(var s=0;s<r;s++)t+=Math.pow(e[s]-o,2);return t/(r-1)};exports.VARA=function(){var e=utils.flatten(arguments);var r=e.length;var t=0;var o=0;var s=exports.AVERAGEA(e);for(var a=0;a<r;a++){var u=e[a];t+="number"===typeof u?Math.pow(u-s,2):true===u?Math.pow(1-s,2):Math.pow(0-s,2);null!==u&&o++}return t/(o-1)};exports.VARPA=function(){var e=utils.flatten(arguments);var r=e.length;var t=0;var o=0;var s=exports.AVERAGEA(e);for(var a=0;a<r;a++){var u=e[a];t+="number"===typeof u?Math.pow(u-s,2):true===u?Math.pow(1-s,2):Math.pow(0-s,2);null!==u&&o++}return t/o};exports.WEIBULL={};exports.WEIBULL.DIST=function(e,r,t,o){e=utils.parseNumber(e);r=utils.parseNumber(r);t=utils.parseNumber(t);return utils.anyIsError(e,r,t)?error.value:o?1-Math.exp(-Math.pow(e/t,r)):Math.pow(e,r-1)*Math.exp(-Math.pow(e/t,r))*r/Math.pow(t,r)};exports.Z={};exports.Z.TEST=function(e,r,t){e=utils.parseNumberArray(utils.flatten(e));r=utils.parseNumber(r);if(utils.anyIsError(e,r))return error.value;t=t||exports.STDEV.S(e);var o=e.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(e)-r)/(t/Math.sqrt(o)),true)};return exports}();met.utils=function(){var e={};e.PROGRESS=function(e,r){var t=r||"red";var o=e||"0";return'<div style="width:'+o+"%;height:4px;background-color:"+t+';margin-top:1px;"></div>'};e.RATING=function(e){var r='<div class="jrating">';for(var t=0;t<5;t++)r+=t<e?'<div class="jrating-selected"></div>':"<div></div>";r+="</div>";return r};return e}();for(var i=0;i<Object.keys(met).length;i++){var methods=met[Object.keys(met)[i]];var keys=Object.keys(methods);for(var j=0;j<keys.length;j++)if(methods[keys[j]])if("function"==typeof methods[keys[j]]||"object"==typeof methods[keys[j]]){window[keys[j]]=methods[keys[j]];window[keys[j]].toString=function(){return"#ERROR"};if("object"==typeof methods[keys[j]]){var tmp=Object.keys(methods[keys[j]]);for(var z=0;z<tmp.length;z++)window[keys[j]][tmp[z]].toString=function(){return"#ERROR"}}}else window[keys[j]]=function(){return keys[j]+"Not implemented"};else window[keys[j]]=function(){return keys[j]+"Not implemented"}}var x=null;var y=null;var instance=null;window.TABLE=function(){return instance};window.COLUMN=window.COL=function(){return parseInt(x)+1};window.ROW=function(){return parseInt(y)+1};window.CELL=function(){return F.getColumnNameFromCoords(x,y)};window.VALUE=function(e,r,t){return instance.getValueFromCoords(parseInt(e)-1,parseInt(r)-1,t)};window.THISROWCELL=function(e){return instance.getValueFromCoords(parseInt(e)-1,parseInt(y))};var secureFormula=function(e,r){var t="";var o=0;var s=["=","!",">","<"];for(var a=0;a<e.length;a++){'"'==e[a]&&(o=0==o?1:0);if(1==o)t+=e[a];else{t+=e[a].toUpperCase();true==r&&a>0&&"="==e[a]&&-1==s.indexOf(e[a-1])&&-1==s.indexOf(e[a+1])&&(t+="=")}}t=t.replace(/\^/g,"**");t=t.replace(/\<\>/g,"!=");t=t.replace(/\&/g,"+");t=t.replace(/\$/g,"");return t};var tokensUpdate=function(e,r){for(var t=0;t<e.length;t++){var o=F.getTokensFromRange(e[t]);r=r.replace(e[t],"["+o.join(",")+"]")}return r};var F=function(e,r,t,o,s){instance=s;x=t;y=o;var a="";var u=Object.keys(r);if(u.length)for(t=0;t<u.length;t++)-1==u[t].indexOf(".")&&-1==u[t].indexOf("!")?a+="var "+u[t]+" = "+r[u[t]]+";\n":a+=u[t]+" = "+r[u[t]]+";\n";e=e.replace(/\$/g,"");e=e.replace(/\!/g,".");e=secureFormula(e,true);var b=e.match(/([A-Z]+[0-9]*\.)?(\$?[A-Z]+\$?[0-9]+):(\$?[A-Z]+\$?[0-9]+)?/g);b&&b.length&&(e=tokensUpdate(b,e));return new Function(a+"; return "+e)()};
/**
   * Get letter based on a number
   * @param {number} i
   * @return {string}
   */var getColumnName=function(e){var r="";if(e>701){r+=String.fromCharCode(64+parseInt(e/676));r+=String.fromCharCode(64+parseInt(e%676/26))}else e>25&&(r+=String.fromCharCode(64+parseInt(e/26)));r+=String.fromCharCode(65+e%26);return r};F.getColumnNameFromCoords=function(e,r){return getColumnName(parseInt(e))+(parseInt(r)+1)};F.getCoordsFromColumnName=function(e){var r=/^[a-zA-Z]+/.exec(e);if(r){var t=0;for(var o=0;o<r[0].length;o++)t+=parseInt(r[0].charCodeAt(o)-64)*Math.pow(26,r[0].length-1-o);t--;t<0&&(t=0);var s=parseInt(/[0-9]+$/.exec(e))||null;s>0&&s--;return[t,s]}};F.getRangeFromTokens=function(e){e=e.filter((function(e){return"#REF!"!=e}));var r="";var t="";for(var o=0;o<e.length;o++){e[o].indexOf(".")>=0?r=".":e[o].indexOf("!")>=0&&(r="!");if(r){t=e[o].split(r);e[o]=t[1];t=t[0]+r}}e.sort((function(e,r){var t=Helpers.getCoordsFromColumnName(e);var o=Helpers.getCoordsFromColumnName(r);return t[1]>o[1]?1:t[1]<o[1]?-1:t[0]>o[0]?1:t[0]<o[0]?-1:0}));return e.length?t+(e[0]+":")+e[e.length-1]:"#REF!"};F.getTokensFromRange=function(e){if(e.indexOf(".")>0){var r=e.split(".");e=r[1];r=r[0]+"."}else if(e.indexOf("!")>0){r=e.split("!");e=r[1];r=r[0]+"!"}else r="";e=e.split(":");var t=F.getCoordsFromColumnName(e[0]);var o=F.getCoordsFromColumnName(e[1]);if(t[0]<=o[0]){var s=t[0];var a=o[0]}else{s=o[0];a=t[0]}if(null===t[1]&&null==o[1]){var u=null;var b=null;var d=Object.keys(vars);for(var f=0;f<d.length;f++){var h=F.getCoordsFromColumnName(d[f]);h[0]===t[0]&&(null===u||h[1]<u)&&(u=h[1]);h[0]===o[0]&&(null===b||h[1]>b)&&(b=h[1])}}else if(t[1]<=o[1]){u=t[1];b=o[1]}else{u=o[1];b=t[1]}var g=[];for(var m=u;m<=b;m++){var v=[];for(f=s;f<=a;f++)v.push(r+F.getColumnNameFromCoords(f,m));g.push(v)}return g};F.setFormula=function(e){var r=Object.keys(e);for(var t=0;t<r.length;t++)"function"==typeof e[r[t]]&&(window[r[t]]=e[r[t]])};return F}();if(!jSuites&&true)var jSuites=_jsuites;(function(e,r){exports=r()})(0,(function(){var Version=function(){var e={title:"Jspreadsheet",version:"4.10.1",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[(this||_global).title+" "+(this||_global).type+" "+(this||_global).version,(this||_global).host,(this||_global).license].join("\r\n")}};return function(){return e}}();var isFormula=function(e){var r=(""+e)[0];return"="==r||"#"==r};var getMask=function(e){if(e.format||e.mask||e.locale){var r={};if(e.mask)r.mask=e.mask;else if(e.format)r.mask=e.format;else{r.locale=e.locale;r.options=e.options}if(e.decimal){r.options||(r.options={});r.options={decimal:e.decimal}}return r}return null};var jexcel=function(el,options){var obj={};obj.options={};if(!(el instanceof Element||el instanceof HTMLDocument)){console.error("Jspreadsheet: el is not a valid DOM element");return false}if("TABLE"==el.tagName){if(!(options=jexcel.createFromTable(el,options))){console.error("Jspreadsheet: el is not a valid DOM element");return false}var div=document.createElement("div");el.parentNode.insertBefore(div,el);el.remove();el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:false,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:true,includeHeadersOnDownload:false,includeHeadersOnCopy:false,columnSorting:true,columnDrag:false,columnResize:true,rowResize:false,rowDrag:true,editable:true,allowInsertRow:true,allowManualInsertRow:true,allowInsertColumn:true,allowManualInsertColumn:true,allowDeleteRow:true,allowDeletingAllRows:false,allowDeleteColumn:true,allowRenameColumn:true,allowComments:false,wordWrap:false,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:true,csvDelimiter:",",parseTableFirstRowAsHeader:false,parseTableAutoCellType:false,selectionCopy:true,mergeCells:{},toolbar:null,search:false,pagination:false,paginationOptions:null,fullscreen:false,lazyLoading:false,loadingSpin:false,tableOverflow:false,tableHeight:"300px",tableWidth:null,textOverflow:false,meta:null,style:null,classes:null,parseFormulas:true,autoIncrement:true,autoCasting:true,secureFormulas:true,stripHTML:true,stripHTMLOnCopy:false,filters:false,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:false,updateTable:null,detachForUpdates:false,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:true};for(var property in defaults)if(options&&options.hasOwnProperty(property))if("text"===property){obj.options[property]=defaults[property];for(var textKey in options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey])}else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el;obj.corner=null;obj.contextMenu=null;obj.textarea=null;obj.ads=null;obj.content=null;obj.table=null;obj.thead=null;obj.tbody=null;obj.rows=[];obj.results=null;obj.searchInput=null;obj.toolbar=null;obj.pagination=null;obj.pageNumber=null;obj.headerContainer=null;obj.colgroupContainer=null;obj.headers=[];obj.records=[];obj.history=[];obj.formula=[];obj.colgroup=[];obj.selection=[];obj.highlighted=[];obj.selectedCell=null;obj.selectedContainer=null;obj.style=[];obj.data=null;obj.filter=null;obj.filters=[];obj.cursor=null;obj.historyIndex=-1;obj.ignoreEvents=false;obj.ignoreHistory=false;obj.edition=null;obj.hashString=null;obj.resizing=null;obj.dragging=null;if(true==obj.options.lazyLoading&&false==obj.options.tableOverflow&&false==obj.options.fullscreen){console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes");obj.options.lazyLoading=false}
/**
     * Activate/Disable fullscreen
     * use programmatically : table.fullscreen(); or table.fullscreen(true); or table.fullscreen(false);
     * @Param {boolean} activate
     */obj.fullscreen=function(e){null==e&&(e=!obj.options.fullscreen);if(obj.options.fullscreen!=e){obj.options.fullscreen=e;true==e?el.classList.add("fullscreen"):el.classList.remove("fullscreen")}};obj.dispatch=function(e){if(!obj.ignoreEvents){if("function"==typeof obj.options.onevent)var r=obj.options.onevent.apply(this||_global,arguments);if("function"==typeof obj.options[e])r=obj.options[e].apply(this||_global,Array.prototype.slice.call(arguments,1))}if("onafterchanges"==e&&obj.options.persistance){var t=true==obj.options.persistance?obj.options.url:obj.options.persistance;var o=obj.prepareJson(arguments[2]);obj.save(t,o)}return r};
/**
     * Prepare the jspreadsheet table
     *
     * @Param config
     */obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&"undefined"!==typeof obj.options.data[0]){var r=Object.keys(obj.options.data[0]);r.length>e&&(e=r.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);var t=[];for(var o=0;o<e;o++){obj.options.colHeaders[o]||(obj.options.colHeaders[o]="");obj.options.colWidths[o]||(obj.options.colWidths[o]=obj.options.defaultColWidth);obj.options.colAlignments[o]||(obj.options.colAlignments[o]=obj.options.defaultColAlign);obj.options.columns[o]?obj.options.columns[o].type||(obj.options.columns[o].type="text"):obj.options.columns[o]={type:"text"};obj.options.columns[o].name||(obj.options.columns[o].name=r&&r[o]?r[o]:o);obj.options.columns[o].source||(obj.options.columns[o].source=[]);obj.options.columns[o].options||(obj.options.columns[o].options=[]);obj.options.columns[o].editor||(obj.options.columns[o].editor=null);obj.options.columns[o].allowEmpty||(obj.options.columns[o].allowEmpty=false);obj.options.columns[o].title||(obj.options.columns[o].title=obj.options.colHeaders[o]?obj.options.colHeaders[o]:"");obj.options.columns[o].width||(obj.options.columns[o].width=obj.options.colWidths[o]?obj.options.colWidths[o]:obj.options.defaultColWidth);obj.options.columns[o].align||(obj.options.columns[o].align=obj.options.colAlignments[o]?obj.options.colAlignments[o]:"center");"autocomplete"==obj.options.columns[o].type||"dropdown"==obj.options.columns[o].type?obj.options.columns[o].url&&t.push({url:obj.options.columns[o].url,index:o,method:"GET",dataType:"json",success:function(e){for(var r=0;r<e.length;r++)obj.options.columns[(this||_global).index].source.push(e[r])}}):"calendar"==obj.options.columns[o].type&&(obj.options.columns[o].options.format||(obj.options.columns[o].options.format="DD/MM/YYYY"))}t.length?jSuites.ajax(t,(function(){obj.createTable()})):obj.createTable()};obj.createTable=function(){obj.table=document.createElement("table");obj.thead=document.createElement("thead");obj.tbody=document.createElement("tbody");obj.headers=[];obj.colgroup=[];obj.content=document.createElement("div");obj.content.classList.add("jexcel_content");obj.content.onscroll=function(e){obj.scrollControls(e)};obj.content.onwheel=function(e){obj.wheelControls(e)};obj.toolbar=document.createElement("div");obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div");var r=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input");obj.searchInput.classList.add("jexcel_search");e.appendChild(r);e.appendChild(obj.searchInput);obj.searchInput.onfocus=function(){obj.resetSelection()};var t=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select");obj.paginationDropdown.classList.add("jexcel_pagination_dropdown");obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt((this||_global).value);obj.page(0)};for(var o=0;o<obj.options.paginationOptions.length;o++){var s=document.createElement("option");s.value=obj.options.paginationOptions[o];s.innerHTML=obj.options.paginationOptions[o];obj.paginationDropdown.appendChild(s)}obj.paginationDropdown.value=obj.options.pagination;t.appendChild(document.createTextNode(obj.options.text.show));t.appendChild(obj.paginationDropdown);t.appendChild(document.createTextNode(obj.options.text.entries))}var a=document.createElement("div");a.classList.add("jexcel_filter");a.appendChild(t);a.appendChild(e);obj.colgroupContainer=document.createElement("colgroup");var u=document.createElement("col");u.setAttribute("width","50");obj.colgroupContainer.appendChild(u);if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var b=0;b<obj.options.nestedHeaders.length;b++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[b]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));obj.headerContainer=document.createElement("tr");u=document.createElement("td");u.classList.add("jexcel_selectall");obj.headerContainer.appendChild(u);for(o=0;o<obj.options.columns.length;o++){obj.createCellHeader(o);obj.headerContainer.appendChild(obj.headers[o]);obj.colgroupContainer.appendChild(obj.colgroup[o])}obj.thead.appendChild(obj.headerContainer);if(true==obj.options.filters){obj.filter=document.createElement("tr");var d=document.createElement("td");obj.filter.appendChild(d);for(o=0;o<obj.options.columns.length;o++){d=document.createElement("td");d.innerHTML="&nbsp;";d.setAttribute("data-x",o);d.className="jexcel_column_filter";"hidden"==obj.options.columns[o].type&&(d.style.display="none");obj.filter.appendChild(d)}obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table");obj.table.classList.add("jexcel");obj.table.setAttribute("cellpadding","0");obj.table.setAttribute("cellspacing","0");obj.table.setAttribute("unselectable","yes");obj.table.appendChild(obj.colgroupContainer);obj.table.appendChild(obj.thead);obj.table.appendChild(obj.tbody);obj.options.textOverflow||obj.table.classList.add("jexcel_overflow");obj.corner=document.createElement("div");obj.corner.className="jexcel_corner";obj.corner.setAttribute("unselectable","on");obj.corner.setAttribute("onselectstart","return false");false==obj.options.selectionCopy&&(obj.corner.style.display="none");obj.textarea=document.createElement("textarea");obj.textarea.className="jexcel_textarea";obj.textarea.id="jexcel_textarea";obj.textarea.tabIndex="-1";obj.contextMenu=document.createElement("div");obj.contextMenu.className="jexcel_contextmenu";jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(false)}});var f=document.createElement("a");f.setAttribute("href","https://bossanova.uk/jspreadsheet/");obj.ads=document.createElement("div");obj.ads.className="jexcel_about";try{if("undefined"!==typeof sessionStorage&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",true);var h=document.createElement("img");h.src="//bossanova.uk/jspreadsheet/logo.png";f.appendChild(h)}}catch(e){}var g=document.createElement("span");g.innerHTML="Jspreadsheet CE";f.appendChild(g);obj.ads.appendChild(f);var m=document.createElement("div");m.classList.add("jexcel_table");obj.pagination=document.createElement("div");obj.pagination.classList.add("jexcel_pagination");var v=document.createElement("div");var C=document.createElement("div");obj.pagination.appendChild(v);obj.pagination.appendChild(C);obj.options.pagination||(obj.pagination.style.display="none");true==obj.options.search&&el.appendChild(a);obj.content.appendChild(obj.table);obj.content.appendChild(obj.corner);obj.content.appendChild(obj.textarea);el.appendChild(obj.toolbar);el.appendChild(obj.content);el.appendChild(obj.pagination);el.appendChild(obj.contextMenu);el.appendChild(obj.ads);el.classList.add("jexcel_container");obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar();if(true==obj.options.fullscreen)el.classList.add("fullscreen");else if(true==obj.options.tableOverflow){if(obj.options.tableHeight){obj.content.style["overflow-y"]="auto";obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px";obj.content.style.maxHeight=obj.options.tableHeight}if(obj.options.tableWidth){obj.content.style["overflow-x"]="auto";obj.content.style.width=obj.options.tableWidth}}true!=obj.options.tableOverflow&&obj.options.toolbar&&el.classList.add("with-toolbar");true==obj.options.columnDrag&&obj.thead.classList.add("draggable");true==obj.options.columnResize&&obj.thead.classList.add("resizable");true==obj.options.rowDrag&&obj.tbody.classList.add("draggable");true==obj.options.rowResize&&obj.tbody.classList.add("resizable");obj.setData();obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1);if(obj.options.classes){var E=Object.keys(obj.options.classes);for(o=0;o<E.length;o++){var A=jexcel.getIdFromColumnName(E[o],true);obj.records[A[1]][A[0]].classList.add(obj.options.classes[E[o]])}}};obj.refresh=function(){if(obj.options.url){true==obj.options.loadingSpin&&jSuites.loading.show();jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e;obj.setData();true==obj.options.loadingSpin&&jSuites.loading.hide()}})}else obj.setData()};
/**
     * Set data
     *
     * @param array data In case no data is sent, default is reloaded
     * @return void
     */obj.setData=function(e){if(e){"string"==typeof e&&(e=JSON.parse(e));obj.options.data=e}obj.options.data||(obj.options.data=[]);if(obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){e=[];for(var r=0;r<obj.options.data.length;r++){var t=[];for(var o=0;o<obj.options.columns.length;o++)t[o]=obj.options.data[r][obj.options.columns[o].name];e.push(t)}obj.options.data=e}r=0;o=0;var s=obj.options.columns.length;var a=obj.options.data.length;var u=obj.options.minDimensions[0];var b=obj.options.minDimensions[1];var d=u>s?u:s;var f=b>a?b:a;for(r=0;r<f;r++)for(o=0;o<d;o++){void 0==obj.options.data[r]&&(obj.options.data[r]=[]);void 0==obj.options.data[r][o]&&(obj.options.data[r][o]="")}obj.rows=[];obj.results=null;obj.records=[];obj.history=[];obj.historyIndex=-1;obj.tbody.innerHTML="";if(true==obj.options.lazyLoading){var h=0;var g=obj.options.data.length<100?obj.options.data.length:100;if(obj.options.pagination){obj.options.pagination=false;console.error("Jspreadsheet: Pagination will be disable due the lazyLoading")}}else if(obj.options.pagination){obj.pageNumber||(obj.pageNumber=0);obj.options.pagination;h=obj.options.pagination*obj.pageNumber;g=obj.options.pagination*obj.pageNumber+obj.options.pagination;obj.options.data.length<g&&(g=obj.options.data.length)}else{h=0;g=obj.options.data.length}for(r=0;r<obj.options.data.length;r++){var m=obj.createRow(r,obj.options.data[r]);r>=h&&r<g&&obj.tbody.appendChild(m)}true==obj.options.lazyLoading||obj.options.pagination&&obj.updatePagination();if(obj.options.mergeCells){var v=Object.keys(obj.options.mergeCells);for(o=0;o<v.length;o++){var C=obj.options.mergeCells[v[o]];obj.setMerge(v[o],C[0],C[1],1)}}obj.updateTable();obj.dispatch("onload",el,obj)};
/**
     * Get the whole table data
     *
     * @param bool get highlighted cells only
     * @return array data
     */obj.getData=function(e,r){var t=[];var o=0;var s=0;var a=true==r||false==obj.options.copyCompatibility;var u=obj.options.columns.length;var b=obj.options.data.length;for(var d=0;d<b;d++){o=0;for(var f=0;f<u;f++)if(!e||obj.records[d][f].classList.contains("highlight")){t[s]||(t[s]=[]);t[s][o]=a?obj.options.data[d][f]:obj.records[d][f].innerHTML;o++}o>0&&s++}return t};
/**
    * Get json data by row number
    *
    * @param integer row number
    * @return object
    */obj.getJsonRow=function(e){var r=obj.options.data[e];var t=obj.options.columns.length;var o={};for(var s=0;s<t;s++){obj.options.columns[s].name||(obj.options.columns[s].name=s);o[obj.options.columns[s].name]=r[s]}return o};
/**
     * Get the whole table data
     *
     * @param bool highlighted cells only
     * @return string value
     */obj.getJson=function(e){var r=[];var t=obj.options.columns.length;var o=obj.options.data.length;for(var s=0;s<o;s++){var a=null;for(var u=0;u<t;u++)if(!e||obj.records[s][u].classList.contains("highlight")){null==a&&(a={});obj.options.columns[u].name||(obj.options.columns[u].name=u);a[obj.options.columns[u].name]=obj.options.data[s][u]}null!=a&&r.push(a)}return r};obj.prepareJson=function(e){var r=[];for(var t=0;t<e.length;t++){var o=e[t].x;var s=e[t].y;var a=obj.options.columns[o].name?obj.options.columns[o].name:o;r[s]||(r[s]={row:s,data:{}});r[s].data[a]=e[t].newValue}return r.filter((function(e){return null!=e}))};obj.save=function(e,r){var t=obj.dispatch("onbeforesave",el,obj,r);if(t)r=t;else if(false===t)return false;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(r)},success:function(e){obj.dispatch("onsave",el,obj,r)}})};obj.getRowData=function(e){return obj.options.data[e]};obj.setRowData=function(e,r){for(var t=0;t<obj.headers.length;t++){var o=jexcel.getColumnNameFromId([t,e]);null!=r[t]&&obj.setValue(o,r[t])}};obj.getColumnData=function(e){var r=[];for(var t=0;t<obj.options.data.length;t++)r.push(obj.options.data[t][e]);return r};obj.setColumnData=function(e,r){for(var t=0;t<obj.rows.length;t++){var o=jexcel.getColumnNameFromId([e,t]);null!=r[t]&&obj.setValue(o,r[t])}};obj.createRow=function(e,r){obj.records[e]||(obj.records[e]=[]);if(!r)r=obj.options.data[e];obj.rows[e]=document.createElement("tr");obj.rows[e].setAttribute("data-y",e);var t=null;obj.options.defaultRowHeight&&(obj.rows[e].style.height=obj.options.defaultRowHeight+"px");if(obj.options.rows[e]){obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height);obj.options.rows[e].title&&(t=obj.options.rows[e].title)}t||(t=parseInt(e+1));var o=document.createElement("td");o.innerHTML=t;o.setAttribute("data-y",e);o.className="jexcel_row";obj.rows[e].appendChild(o);for(var s=0;s<obj.options.columns.length;s++){obj.records[e][s]=obj.createCell(s,e,r[s]);obj.rows[e].appendChild(obj.records[e][s])}return obj.rows[e]};obj.parseValue=function(e,r,t,o){"="==(""+t).substr(0,1)&&true==obj.options.parseFormulas&&(t=obj.executeFormula(t,e,r));var s=obj.options.columns[e];if(s&&!isFormula(t)){var a=null;if(a=getMask(s)){t&&t==Number(t)&&(t=Number(t));var u=jSuites.mask.render(t,a,true);if(o&&a.mask){var b=a.mask.split(";");if(b[1]){var d=b[1].match(new RegExp("\\[Red\\]","gi"));d&&(t<0?o.classList.add("red"):o.classList.remove("red"));var f=b[1].match(new RegExp("\\(","gi"));f&&t<0&&(u="("+u+")")}}u&&(t=u)}}return t};var validDate=function(e){e=""+e;if("-"==e.substr(4,1)&&"-"==e.substr(7,1))return true;e=e.split("-");return 4==e[0].length&&e[0]==Number(e[0])&&2==e[1].length&&e[1]==Number(e[1])};obj.createCell=function(e,r,t){var o=document.createElement("td");o.setAttribute("data-x",e);o.setAttribute("data-y",r);if("="==(""+t).substr(0,1)&&true==obj.options.secureFormulas){var s=secureFormula(t);s!=t&&(t=s)}if(obj.options.columns[e].editor){false===obj.options.stripHTML||false===obj.options.columns[e].stripHTML?o.innerHTML=t:o.innerText=t;"function"==typeof obj.options.columns[e].editor.createCell&&(o=obj.options.columns[e].editor.createCell(o))}else if("hidden"==obj.options.columns[e].type){o.style.display="none";o.innerText=t}else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){var a=document.createElement("input");a.type=obj.options.columns[e].type;a.name="c"+e;a.checked=1==t||true==t||"true"==t;a.onclick=function(){obj.setValue(o,(this||_global).checked)};true!=obj.options.columns[e].readOnly&&false!=obj.options.editable||a.setAttribute("disabled","disabled");o.appendChild(a);obj.options.data[r][e]=a.checked}else if("calendar"==obj.options.columns[e].type){var u=null;if(!validDate(t)){var b=jSuites.calendar.extractDateFromString(t,obj.options.columns[e].options.format);b&&(u=b)}o.innerText=jSuites.calendar.getDateString(u||t,obj.options.columns[e].options.format)}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type){o.classList.add("jexcel_dropdown");o.innerText=obj.getDropDownValue(e,t)}else if("color"==obj.options.columns[e].type)if("square"==obj.options.columns[e].render){var d=document.createElement("div");d.className="color";d.style.backgroundColor=t;o.appendChild(d)}else{o.style.color=t;o.innerText=t}else if("image"==obj.options.columns[e].type){if(t&&"data:image"==t.substr(0,10)){var f=document.createElement("img");f.src=t;o.appendChild(f)}}else"html"==obj.options.columns[e].type||false===obj.options.stripHTML||false===obj.options.columns[e].stripHTML?o.innerHTML=stripScript(obj.parseValue(e,r,t,o)):o.innerText=obj.parseValue(e,r,t,o);true==obj.options.columns[e].readOnly&&(o.className="readonly");var h=obj.options.columns[e].align?obj.options.columns[e].align:"center";o.style.textAlign=h;false!=obj.options.columns[e].wordWrap&&(true==obj.options.wordWrap||true==obj.options.columns[e].wordWrap||o.innerHTML.length>200)&&(o.style.whiteSpace="pre-wrap");e>0&&true==(this||_global).options.textOverflow&&(t||o.innerHTML?obj.records[r][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(o.style.overflow="hidden"));return o};obj.createCellHeader=function(e){var r=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth;var t=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td");obj.options.stripHTML?obj.headers[e].innerText=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e);obj.headers[e].setAttribute("data-x",e);obj.headers[e].style.textAlign=t;obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.options.columns[e].title);obj.options.columns[e].id&&obj.headers[e].setAttribute("id",obj.options.columns[e].id);obj.colgroup[e]=document.createElement("col");obj.colgroup[e].setAttribute("width",r);if("hidden"==obj.options.columns[e].type){obj.headers[e].style.display="none";obj.colgroup[e].style.display="none"}};obj.updateNestedHeader=function(e,r,t){if(obj.options.nestedHeaders[r][e].title){obj.options.nestedHeaders[r][e].title=t;obj.options.nestedHeaders[r].element.children[e+1].innerText=t}};obj.createNestedHeader=function(e){var r=document.createElement("tr");r.classList.add("jexcel_nested");var t=document.createElement("td");r.appendChild(t);e.element=r;var o=0;for(var s=0;s<e.length;s++){e[s].colspan||(e[s].colspan=1);e[s].align||(e[s].align="center");e[s].title||(e[s].title="");var a=e[s].colspan;var u=[];for(var b=0;b<a;b++){obj.options.columns[o]&&"hidden"==obj.options.columns[o].type&&a++;u.push(o);o++}t=document.createElement("td");t.setAttribute("data-column",u.join(","));t.setAttribute("colspan",e[s].colspan);t.setAttribute("align",e[s].align);t.innerText=e[s].title;r.appendChild(t)}return r};obj.createToolbar=function(e){if(e)obj.options.toolbar=e;else e=obj.options.toolbar;for(var r=0;r<e.length;r++)if("i"==e[r].type){var t=document.createElement("i");t.classList.add("jexcel_toolbar_item");t.classList.add("material-icons");t.setAttribute("data-k",e[r].k);t.setAttribute("data-v",e[r].v);t.setAttribute("id",e[r].id);e[r].tooltip&&t.setAttribute("title",e[r].tooltip);e[r].onclick&&typeof e[r].onclick?t.onclick=function(r){var t=r;return function(){e[t].onclick(el,obj,this||_global)}}(r):t.onclick=function(){var e=this.getAttribute("data-k");var r=this.getAttribute("data-v");obj.setStyle(obj.highlighted,e,r)};t.innerText=e[r].content;obj.toolbar.appendChild(t)}else if("select"==e[r].type){t=document.createElement("select");t.classList.add("jexcel_toolbar_item");t.setAttribute("data-k",e[r].k);e[r].tooltip&&t.setAttribute("title",e[r].tooltip);e[r].onchange&&typeof e[r].onchange?t.onchange=e[r].onchange:t.onchange=function(){var e=this.getAttribute("data-k");obj.setStyle(obj.highlighted,e,(this||_global).value)};for(var o=0;o<e[r].v.length;o++){var s=document.createElement("option");s.value=e[r].v[o];s.innerText=e[r].v[o];t.appendChild(s)}obj.toolbar.appendChild(t)}else if("color"==e[r].type){t=document.createElement("i");t.classList.add("jexcel_toolbar_item");t.classList.add("material-icons");t.setAttribute("data-k",e[r].k);t.setAttribute("data-v","");e[r].tooltip&&t.setAttribute("title",e[r].tooltip);obj.toolbar.appendChild(t);t.innerText=e[r].content;jSuites.color(t,{onchange:function(e,r){var t=e.getAttribute("data-k");obj.setStyle(obj.highlighted,t,r)}})}};
/**
     * Merge cells
     * @param cellName
     * @param colspan
     * @param rowspan
     * @param ignoreHistoryAndEvents
     */obj.setMerge=function(e,r,t,o){var s=false;if(!e){if(!obj.highlighted.length){alert(obj.options.text.noCellsSelected);return null}var a=parseInt(obj.highlighted[0].getAttribute("data-x"));var u=parseInt(obj.highlighted[0].getAttribute("data-y"));var b=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x"));var d=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([a,u]);r=b-a+1;t=d-u+1}var f=jexcel.getIdFromColumnName(e,true);if(obj.options.mergeCells[e])obj.records[f[1]][f[0]].getAttribute("data-merged")&&(s=obj.options.text.cellAlreadyMerged);else if((!r||r<2)&&(!t||t<2))s=obj.options.text.invalidMergeProperties;else{for(var h=f[1];h<f[1]+t;h++)for(var g=f[0];g<f[0]+r;g++){jexcel.getColumnNameFromId([g,h]);obj.records[h][g].getAttribute("data-merged")&&(s=obj.options.text.thereIsAConflictWithAnotherMergedCell)}}if(s)alert(s);else{r>1?obj.records[f[1]][f[0]].setAttribute("colspan",r):r=1;t>1?obj.records[f[1]][f[0]].setAttribute("rowspan",t):t=1;obj.options.mergeCells[e]=[r,t,[]];obj.records[f[1]][f[0]].setAttribute("data-merged","true");obj.records[f[1]][f[0]].style.overflow="hidden";var m=[];for(var v=f[1];v<f[1]+t;v++)for(var C=f[0];C<f[0]+r;C++)if(!(f[0]==C&&f[1]==v)){m.push(obj.options.data[v][C]);obj.updateCell(C,v,"",true);obj.options.mergeCells[e][2].push(obj.records[v][C]);obj.records[v][C].style.display="none";obj.records[v][C]=obj.records[f[1]][f[0]]}obj.updateSelection(obj.records[f[1]][f[0]]);if(!o){obj.setHistory({action:"setMerge",column:e,colspan:r,rowspan:t,data:m});obj.dispatch("onmerge",el,e,r,t)}}};
/**
     * Merge cells
     * @param cellName
     * @param colspan
     * @param rowspan
     * @param ignoreHistoryAndEvents
     */obj.getMerge=function(e){var r={};if(e)r=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;var t=Object.keys(obj.options.mergeCells);for(var o=0;o<t.length;o++)r[t[o]]=[obj.options.mergeCells[t[o]][0],obj.options.mergeCells[t[o]][1]]}return r};
/**
     * Remove merge by cellname
     * @param cellName
     */obj.removeMerge=function(e,r,t){if(obj.options.mergeCells[e]){var o=jexcel.getIdFromColumnName(e,true);obj.records[o[1]][o[0]].removeAttribute("colspan");obj.records[o[1]][o[0]].removeAttribute("rowspan");obj.records[o[1]][o[0]].removeAttribute("data-merged");var s=obj.options.mergeCells[e];var a=0;for(var u=0;u<s[1];u++)for(var b=0;b<s[0];b++)if(u>0||b>0){obj.records[o[1]+u][o[0]+b]=s[2][a];obj.records[o[1]+u][o[0]+b].style.display="";r&&r[a]&&obj.updateCell(o[0]+b,o[1]+u,r[a]);a++}obj.updateSelection(obj.records[o[1]][o[0]],obj.records[o[1]+u-1][o[0]+b-1]);t||delete obj.options.mergeCells[e]}};obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;var r=Object.keys(obj.options.mergeCells);for(var t=0;t<r.length;t++)obj.removeMerge(r[t],null,e)}};obj.isColMerged=function(e,r){var t=[];if(obj.options.mergeCells){var o=Object.keys(obj.options.mergeCells);for(var s=0;s<o.length;s++){var a=jexcel.getIdFromColumnName(o[s],true);var u=obj.options.mergeCells[o[s]][0];var b=a[0];var d=a[0]+(u>1?u-1:0);null==r?b<=e&&d>=e&&t.push(o[s]):r?b<e&&d>=e&&t.push(o[s]):b<=e&&d>e&&t.push(o[s])}}return t};obj.isRowMerged=function(e,r){var t=[];if(obj.options.mergeCells){var o=Object.keys(obj.options.mergeCells);for(var s=0;s<o.length;s++){var a=jexcel.getIdFromColumnName(o[s],true);var u=obj.options.mergeCells[o[s]][1];var b=a[1];var d=a[1]+(u>1?u-1:0);null==r?b<=e&&d>=e&&t.push(o[s]):r?b<e&&d>=e&&t.push(o[s]):b<=e&&d>e&&t.push(o[s])}}return t};obj.openFilter=function(e){if(obj.options.filters){e=parseInt(e);obj.resetSelection();var r=[];if("checkbox"==obj.options.columns[e].type){r.push({id:"true",name:"True"});r.push({id:"false",name:"False"})}else{var t=[];var o=false;for(var s=0;s<obj.options.data.length;s++){var a=obj.options.data[s][e];var u=obj.records[s][e].innerHTML;if(a&&u)t[a]=u;else o=true}var b=Object.keys(t);r=[];for(s=0;s<b.length;s++)r.push({id:b[s],name:t[b[s]]});o&&r.push({value:"",id:"",name:"(Blanks)"})}var d=document.createElement("div");obj.filter.children[e+1].innerHTML="";obj.filter.children[e+1].appendChild(d);obj.filter.children[e+1].style.paddingLeft="0px";obj.filter.children[e+1].style.paddingRight="0px";obj.filter.children[e+1].style.overflow="initial";var f={data:r,multiple:true,autocomplete:true,opened:true,value:void 0!==obj.filters[e]?obj.filters[e]:null,width:"100%",position:true==obj.options.tableOverflow||true==obj.options.fullscreen,onclose:function(r){obj.resetFilters();obj.filters[e]=r.dropdown.getValue(true);obj.filter.children[e+1].innerHTML=r.dropdown.getText();obj.filter.children[e+1].style.paddingLeft="";obj.filter.children[e+1].style.paddingRight="";obj.filter.children[e+1].style.overflow="";obj.closeFilter(e);obj.refreshSelection()}};jSuites.dropdown(d,f)}else console.log("Jspreadsheet: filters not enabled.")};obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++){obj.filter.children[e].innerHTML="&nbsp;";obj.filters[e]=null}obj.results=null;obj.updateResult()};obj.closeFilter=function(e){if(!e)for(var r=0;r<obj.filter.children.length;r++)obj.filters[r]&&(e=r);var search=function(e,r,t){for(var o=0;o<e.length;o++){var s=""+obj.options.data[t][r];var a=""+obj.records[t][r].innerHTML;if(e[o]==s||e[o]==a)return true}return false};var t=obj.filters[e];obj.results=[];for(var o=0;o<obj.options.data.length;o++)search(t,e,o)&&obj.results.push(o);obj.results.length||(obj.results=null);obj.updateResult()};
/**
     * Open the editor
     *
     * @param object cell
     * @return void
     */obj.openEditor=function(e,r,t){var o=e.getAttribute("data-y");var s=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,s,o);s>0&&(obj.records[o][s-1].style.overflow="hidden");var createEditor=function(r){var t=e.getBoundingClientRect();var a=document.createElement(r);a.style.width=t.width+"px";a.style.height=t.height-2+"px";a.style.minHeight=t.height-2+"px";e.classList.add("editor");e.innerHTML="";e.appendChild(a);obj.dispatch("oncreateeditor",el,e,s,o,a);return a};if(true==e.classList.contains("readonly"));else{obj.edition=[obj.records[o][s],obj.records[o][s].innerHTML,s,o];if(obj.options.columns[s].editor)obj.options.columns[s].editor.openEditor(e,el,r,t);else if("hidden"==obj.options.columns[s].type);else if("checkbox"==obj.options.columns[s].type||"radio"==obj.options.columns[s].type){var a=!e.children[0].checked;obj.setValue(e,a);obj.edition=null}else if("dropdown"==obj.options.columns[s].type||"autocomplete"==obj.options.columns[s].type){a=obj.options.data[o][s];obj.options.columns[s].multiple&&!Array.isArray(a)&&(a=a.split(";"));if("function"==typeof obj.options.columns[s].filter)var u=obj.options.columns[s].filter(el,e,s,o,obj.options.columns[s].source);else u=obj.options.columns[s].source;var b=[];for(var d=0;d<u.length;d++)b.push(u[d]);var f=createEditor("div");var h={data:b,multiple:!!obj.options.columns[s].multiple,autocomplete:!(!obj.options.columns[s].autocomplete&&"autocomplete"!=obj.options.columns[s].type),opened:true,value:a,width:"100%",height:f.style.minHeight,position:true==obj.options.tableOverflow||true==obj.options.fullscreen,onclose:function(){obj.closeEditor(e,true)}};obj.options.columns[s].options&&obj.options.columns[s].options.type&&(h.type=obj.options.columns[s].options.type);jSuites.dropdown(f,h)}else if("calendar"==obj.options.columns[s].type||"color"==obj.options.columns[s].type){a=obj.options.data[o][s];f=createEditor("input");f.value=a;true!=obj.options.tableOverflow&&true!=obj.options.fullscreen||(obj.options.columns[s].options.position=true);obj.options.columns[s].options.value=obj.options.data[o][s];obj.options.columns[s].options.opened=true;obj.options.columns[s].options.onclose=function(r,t){obj.closeEditor(e,true)};"color"==obj.options.columns[s].type?jSuites.color(f,obj.options.columns[s].options):jSuites.calendar(f,obj.options.columns[s].options);f.focus()}else if("html"==obj.options.columns[s].type){a=obj.options.data[o][s];f=createEditor("div");f.style.position="relative";var g=document.createElement("div");g.classList.add("jexcel_richtext");f.appendChild(g);jSuites.editor(g,{focus:true,value:a});var m=e.getBoundingClientRect();var v=g.getBoundingClientRect();window.innerHeight<m.bottom+v.height?g.style.top=m.top-(v.height+2)+"px":g.style.top=m.top+"px"}else if("image"==obj.options.columns[s].type){var C=e.children[0];f=createEditor("div");f.style.position="relative";g=document.createElement("div");g.classList.add("jclose");C&&C.src&&g.appendChild(C);f.appendChild(g);jSuites.image(g,obj.options.imageOptions);m=e.getBoundingClientRect();v=g.getBoundingClientRect();window.innerHeight<m.bottom+v.height?g.style.top=m.top-(v.height+2)+"px":g.style.top=m.top+"px"}else{a=true==r?"":obj.options.data[o][s];if(false==obj.options.columns[s].wordWrap||true!=obj.options.wordWrap&&true!=obj.options.columns[s].wordWrap)f=createEditor("input");else var f=createEditor("textarea");f.focus();f.value=a;h=obj.options.columns[s];var E=null;if(!isFormula(a)&&(E=getMask(h))){if(!h.disabledMaskOnEdition)if(h.mask){var A=h.mask.split(";");f.setAttribute("data-mask",A[0])}else h.locale&&f.setAttribute("data-locale",h.locale);E.input=f;f.mask=E;jSuites.mask.render(a,E,false)}f.onblur=function(){obj.closeEditor(e,true)};f.scrollLeft=f.scrollWidth}}};
/**
     * Close the editor and save the information
     *
     * @param object cell
     * @param boolean save
     * @return void
     */obj.closeEditor=function(e,r){var t=parseInt(e.getAttribute("data-x"));var o=parseInt(e.getAttribute("data-y"));if(true==r){if(obj.options.columns[t].editor)var s=obj.options.columns[t].editor.closeEditor(e,r);else if("checkbox"==obj.options.columns[t].type||"radio"==obj.options.columns[t].type||"hidden"==obj.options.columns[t].type);else if("dropdown"==obj.options.columns[t].type||"autocomplete"==obj.options.columns[t].type)s=e.children[0].dropdown.close(true);else if("calendar"==obj.options.columns[t].type)s=e.children[0].calendar.close(true);else if("color"==obj.options.columns[t].type)s=e.children[0].color.close(true);else if("html"==obj.options.columns[t].type)s=e.children[0].children[0].editor.getData();else if("image"==obj.options.columns[t].type){var a=e.children[0].children[0].children[0];s=a&&"IMG"==a.tagName?a.src:""}else if("numeric"==obj.options.columns[t].type){s=e.children[0].value;"="!=(""+s).substr(0,1)&&""==s&&(s=obj.options.columns[t].allowEmpty?"":0);e.children[0].onblur=null}else{s=e.children[0].value;e.children[0].onblur=null;var u=obj.options.columns[t];var b=null;if((b=getMask(u))&&""!==s&&!isFormula(s)&&"number"!==typeof s){var d=jSuites.mask.extract(s,b,true);d&&""!==d.value&&(s=d.value)}}obj.options.data[o][t]==s?e.innerHTML=obj.edition[1]:obj.setValue(e,s)}else{obj.options.columns[t].editor?obj.options.columns[t].editor.closeEditor(e,r):"dropdown"==obj.options.columns[t].type||"autocomplete"==obj.options.columns[t].type?e.children[0].dropdown.close(true):"calendar"==obj.options.columns[t].type?e.children[0].calendar.close(true):"color"==obj.options.columns[t].type?e.children[0].color.close(true):e.children[0].onblur=null;e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:""}obj.dispatch("oneditionend",el,e,t,o,s,r);e.classList.remove("editor");obj.edition=null};
/**
     * Get the cell object
     *
     * @param object cell
     * @return string value
     */obj.getCell=function(e){e=jexcel.getIdFromColumnName(e,true);var r=e[0];var t=e[1];return obj.records[t][r]};
/**
     * Get the column options
     * @param x
     * @param y
     * @returns {{type: string}}
     */obj.getColumnOptions=function(e,r){var t=obj.options.columns[e];t||(t={type:"text"});return t};
/**
     * Get the cell object from coords
     *
     * @param object cell
     * @return string value
     */obj.getCellFromCoords=function(e,r){return obj.records[r][e]};
/**
     * Get label
     *
     * @param object cell
     * @return string value
     */obj.getLabel=function(e){e=jexcel.getIdFromColumnName(e,true);var r=e[0];var t=e[1];return obj.records[t][r].innerHTML};
/**
     * Get labelfrom coords
     *
     * @param object cell
     * @return string value
     */obj.getLabelFromCoords=function(e,r){return obj.records[r][e].innerHTML};
/**
     * Get the value from a cell
     *
     * @param object cell
     * @return string value
     */obj.getValue=function(e,r){if("object"==typeof e){var t=e.getAttribute("data-x");var o=e.getAttribute("data-y")}else{e=jexcel.getIdFromColumnName(e,true);t=e[0];o=e[1]}var s=null;null!=t&&null!=o&&(obj.records[o]&&obj.records[o][t]&&(r||true==obj.options.copyCompatibility)?s=obj.records[o][t].innerHTML:obj.options.data[o]&&"undefined"!=obj.options.data[o][t]&&(s=obj.options.data[o][t]));return s};
/**
     * Get the value from a coords
     *
     * @param int x
     * @param int y
     * @return string value
     */obj.getValueFromCoords=function(e,r,t){var o=null;null!=e&&null!=r&&(obj.records[r]&&obj.records[r][e]&&t||true==obj.options.copyCompatibility?o=obj.records[r][e].innerHTML:obj.options.data[r]&&"undefined"!=obj.options.data[r][e]&&(o=obj.options.data[r][e]));return o};
/**
     * Set a cell value
     *
     * @param mixed cell destination cell
     * @param string value value
     * @return void
     */obj.setValue=function(e,r,t){var o=[];if("string"==typeof e){var s=jexcel.getIdFromColumnName(e,true);var a=s[0];var u=s[1];o.push(obj.updateCell(a,u,r,t));obj.updateFormulaChain(a,u,o)}else{a=null;u=null;if(e&&e.getAttribute){a=e.getAttribute("data-x");u=e.getAttribute("data-y")}if(null!=a&&null!=u){o.push(obj.updateCell(a,u,r,t));obj.updateFormulaChain(a,u,o)}else{var b=Object.keys(e);if(b.length>0)for(var d=0;d<b.length;d++){if("string"==typeof e[d]){s=jexcel.getIdFromColumnName(e[d],true);a=s[0];u=s[1]}else if(null!=e[d].x&&null!=e[d].y){a=e[d].x;u=e[d].y;null!=e[d].newValue?r=e[d].newValue:null!=e[d].value&&(r=e[d].value)}else{a=e[d].getAttribute("data-x");u=e[d].getAttribute("data-y")}if(null!=a&&null!=u){o.push(obj.updateCell(a,u,r,t));obj.updateFormulaChain(a,u,o)}}}}obj.setHistory({action:"setValue",records:o,selection:obj.selectedCell});obj.updateTable();obj.onafterchanges(el,o)};
/**
     * Set a cell value based on coordinates
     *
     * @param int x destination cell
     * @param int y destination cell
     * @param string value
     * @return void
     */obj.setValueFromCoords=function(e,r,t,o){var s=[];s.push(obj.updateCell(e,r,t,o));obj.updateFormulaChain(e,r,s);obj.setHistory({action:"setValue",records:s,selection:obj.selectedCell});obj.updateTable();obj.onafterchanges(el,s)};obj.setCheckRadioValue=function(){var e=[];var r=Object.keys(obj.highlighted);for(var t=0;t<r.length;t++){var o=obj.highlighted[t].getAttribute("data-x");var s=obj.highlighted[t].getAttribute("data-y");"checkbox"!=obj.options.columns[o].type&&"radio"!=obj.options.columns[o].type||e.push(obj.updateCell(o,s,!obj.options.data[s][o]))}if(e.length){obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell});obj.onafterchanges(el,e)}};var stripScript=function(e){var r=new Option;r.innerHTML=e;var t=null;for(e=r.getElementsByTagName("script");t=e[0];)t.parentNode.removeChild(t);return r.innerHTML};
/**
     * Update cell content
     *
     * @param object cell
     * @return void
     */obj.updateCell=function(e,r,t,o){if(true!=obj.records[r][e].classList.contains("readonly")||o){if("="==(""+t).substr(0,1)&&true==obj.options.secureFormulas){var s=secureFormula(t);s!=t&&(t=s)}s=obj.dispatch("onbeforechange",el,obj.records[r][e],e,r,t);void 0!=s&&(t=s);obj.options.columns[e].editor&&"function"==typeof obj.options.columns[e].editor.updateCell&&(t=obj.options.columns[e].editor.updateCell(obj.records[r][e],t,o));h={x:e,y:r,col:e,row:r,newValue:t,oldValue:obj.options.data[r][e]};if(obj.options.columns[e].editor)obj.options.data[r][e]=t;else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){if("radio"==obj.options.columns[e].type)for(var a=0;a<obj.options.data.length;a++)obj.options.data[a][e]=false;obj.records[r][e].children[0].checked=1==t||true==t||"true"==t||"TRUE"==t;obj.options.data[r][e]=obj.records[r][e].children[0].checked}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type){obj.options.data[r][e]=t;obj.records[r][e].innerText=obj.getDropDownValue(e,t)}else if("calendar"==obj.options.columns[e].type){var u=null;if(!validDate(t)){var b=jSuites.calendar.extractDateFromString(t,obj.options.columns[e].options.format);b&&(u=b)}obj.options.data[r][e]=t;obj.records[r][e].innerText=jSuites.calendar.getDateString(u||t,obj.options.columns[e].options.format)}else if("color"==obj.options.columns[e].type){obj.options.data[r][e]=t;if("square"==obj.options.columns[e].render){var d=document.createElement("div");d.className="color";d.style.backgroundColor=t;obj.records[r][e].innerText="";obj.records[r][e].appendChild(d)}else{obj.records[r][e].style.color=t;obj.records[r][e].innerText=t}}else if("image"==obj.options.columns[e].type){t=""+t;obj.options.data[r][e]=t;obj.records[r][e].innerHTML="";if(t&&"data:image"==t.substr(0,10)){var f=document.createElement("img");f.src=t;obj.records[r][e].appendChild(f)}}else{obj.options.data[r][e]=t;"html"==obj.options.columns[e].type?obj.records[r][e].innerHTML=stripScript(obj.parseValue(e,r,t)):false===obj.options.stripHTML||false===obj.options.columns[e].stripHTML?obj.records[r][e].innerHTML=stripScript(obj.parseValue(e,r,t,obj.records[r][e])):obj.records[r][e].innerText=obj.parseValue(e,r,t,obj.records[r][e]);false!=obj.options.columns[e].wordWrap&&(true==obj.options.wordWrap||true==obj.options.columns[e].wordWrap||obj.records[r][e].innerHTML.length>200)?obj.records[r][e].style.whiteSpace="pre-wrap":obj.records[r][e].style.whiteSpace=""}e>0&&(obj.records[r][e-1].style.overflow=t?"hidden":"");obj.dispatch("onchange",el,obj.records[r]&&obj.records[r][e]?obj.records[r][e]:null,e,r,t,h.oldValue)}else var h={x:e,y:r,col:e,row:r};return h};obj.copyData=function(e,r){var t=obj.getData(true,true);var o=obj.selectedContainer;var s=parseInt(e.getAttribute("data-x"));var a=parseInt(e.getAttribute("data-y"));var u=parseInt(r.getAttribute("data-x"));var b=parseInt(r.getAttribute("data-y"));var d=[];var f=false;if(o[0]==s){if(a<o[1])var h=a-o[1];else h=1;var g=0}else{if(s<o[0])g=s-o[0];else g=1;h=0}var m=0;var v=0;for(var C=a;C<=b;C++)if(!obj.rows[C]||"none"!=obj.rows[C].style.display){void 0==t[v]&&(v=0);m=0;if(o[0]!=s)if(s<o[0])g=s-o[0];else g=1;for(var E=s;E<=u;E++){if(obj.records[C][E]&&!obj.records[C][E].classList.contains("readonly")&&"none"!=obj.records[C][E].style.display&&false==f){if(!obj.selection.length&&""!=obj.options.data[C][E]){f=true;continue}(void 0==t[v]||void 0==t[v][m])&&(m=0);var A=t[v][m];if(A&&!t[1]&&true==obj.options.autoIncrement)if("text"==obj.options.columns[E].type||"number"==obj.options.columns[E].type)if("="==(""+A).substr(0,1)){var I=A.match(/([A-Z]+[0-9]+)/g);if(I){var M=[];for(var R=0;R<I.length;R++){var D=jexcel.getIdFromColumnName(I[R],1);D[0]+=g;D[1]+=h;D[1]<0&&(D[1]=0);var S=jexcel.getColumnNameFromId([D[0],D[1]]);S!=I[R]&&(M[I[R]]=S)}M&&(A=obj.updateFormula(A,M))}}else A==Number(A)&&(A=Number(A)+h);else if("calendar"==obj.options.columns[E].type){var w=new Date(A);w.setDate(w.getDate()+h);A=w.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(w.getMonth()+1))+"-"+jexcel.doubleDigitFormat(w.getDate())+" 00:00:00"}d.push(obj.updateCell(E,C,A));obj.updateFormulaChain(E,C,d)}m++;o[0]!=s&&g++}v++;h++}obj.setHistory({action:"setValue",records:d,selection:obj.selectedCell});obj.updateTable();obj.onafterchanges(el,d)};obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])};obj.conditionalSelectionUpdate=function(e,r,t){if(1==e){if(obj.selectedCell&&(r>=obj.selectedCell[1]&&r<=obj.selectedCell[3]||t>=obj.selectedCell[1]&&t<=obj.selectedCell[3])){obj.resetSelection();return}}else if(obj.selectedCell&&(r>=obj.selectedCell[0]&&r<=obj.selectedCell[2]||t>=obj.selectedCell[0]&&t<=obj.selectedCell[2])){obj.resetSelection();return}};obj.resetSelection=function(e){if(obj.highlighted.length){f=1;for(var r=0;r<obj.highlighted.length;r++){obj.highlighted[r].classList.remove("highlight");obj.highlighted[r].classList.remove("highlight-left");obj.highlighted[r].classList.remove("highlight-right");obj.highlighted[r].classList.remove("highlight-top");obj.highlighted[r].classList.remove("highlight-bottom");obj.highlighted[r].classList.remove("highlight-selected");var t=parseInt(obj.highlighted[r].getAttribute("data-x"));var o=parseInt(obj.highlighted[r].getAttribute("data-y"));if(obj.highlighted[r].getAttribute("data-merged")){var s=parseInt(obj.highlighted[r].getAttribute("colspan"));var a=parseInt(obj.highlighted[r].getAttribute("rowspan"));var u=s>0?t+(s-1):t;var b=a>0?o+(a-1):o}else{u=t;b=o}for(var d=t;d<=u;d++)obj.headers[d]&&obj.headers[d].classList.remove("selected");for(d=o;d<=b;d++)obj.rows[d]&&obj.rows[d].classList.remove("selected")}}else var f=0;obj.highlighted=[];obj.selectedCell=null;obj.corner.style.top="-2000px";obj.corner.style.left="-2000px";true==e&&1==f&&obj.dispatch("onblur",el);return f};obj.updateSelection=function(e,r,t){var o=e.getAttribute("data-x");var s=e.getAttribute("data-y");if(r){var a=r.getAttribute("data-x");var u=r.getAttribute("data-y")}else{a=o;u=s}obj.updateSelectionFromCoords(o,s,a,u,t)};obj.updateSelectionFromCoords=function(e,r,t,o,s){var a=obj.resetSelection();if(null==r){r=0;o=obj.rows.length-1}null==t&&(t=e);null==o&&(o=r);e>=obj.headers.length&&(e=obj.headers.length-1);r>=obj.rows.length&&(r=obj.rows.length-1);t>=obj.headers.length&&(t=obj.headers.length-1);o>=obj.rows.length&&(o=obj.rows.length-1);obj.selectedCell=[e,r,t,o];if(null!=e){obj.records[r][e]&&obj.records[r][e].classList.add("highlight-selected");if(parseInt(e)<parseInt(t)){var u=parseInt(e);var b=parseInt(t)}else{u=parseInt(t);b=parseInt(e)}if(parseInt(r)<parseInt(o)){var d=parseInt(r);var f=parseInt(o)}else{d=parseInt(o);f=parseInt(r)}for(var h=u;h<=b;h++)for(var g=d;g<=f;g++)if(obj.records[g][h]&&obj.records[g][h].getAttribute("data-merged")){var m=parseInt(obj.records[g][h].getAttribute("data-x"));var v=parseInt(obj.records[g][h].getAttribute("data-y"));var C=parseInt(obj.records[g][h].getAttribute("colspan"));var E=parseInt(obj.records[g][h].getAttribute("rowspan"));if(C>1){m<u&&(u=m);m+C>b&&(b=m+C-1)}if(E){v<d&&(d=v);v+E>f&&(f=v+E-1)}}var A=null;var I=null;var M=null;var R=null;for(g=d;g<=f;g++)if("none"!=obj.rows[g].style.display){null==M&&(M=g);R=g}for(h=u;h<=b;h++){for(g=d;g<=f;g++)if("none"!=obj.rows[g].style.display&&"none"!=obj.records[g][h].style.display){obj.records[g][h].classList.add("highlight");obj.highlighted.push(obj.records[g][h])}if("hidden"!=obj.options.columns[h].type){null==A&&(A=h);I=h}}A||(A=0);I||(I=0);for(h=A;h<=I;h++)if("hidden"!=obj.options.columns[h].type){obj.records[M]&&obj.records[M][h]&&obj.records[M][h].classList.add("highlight-top");obj.records[R]&&obj.records[R][h]&&obj.records[R][h].classList.add("highlight-bottom");obj.headers[h].classList.add("selected")}for(g=M;g<=R;g++)if(obj.rows[g]&&"none"!=obj.rows[g].style.display){obj.records[g][A].classList.add("highlight-left");obj.records[g][I].classList.add("highlight-right");obj.rows[g].classList.add("selected")}obj.selectedContainer=[A,M,I,R]}if(0==a){obj.dispatch("onfocus",el);obj.removeCopyingSelection()}obj.dispatch("onselection",el,A,M,I,R,s);obj.updateCornerPosition()};obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++){obj.selection[e].classList.remove("selection");obj.selection[e].classList.remove("selection-left");obj.selection[e].classList.remove("selection-right");obj.selection[e].classList.remove("selection-top");obj.selection[e].classList.remove("selection-bottom")}obj.selection=[]};
/**
     * Update copy selection
     *
     * @param int x, y
     * @return void
     */obj.updateCopySelection=function(e,r){obj.removeCopySelection();var t=obj.selectedContainer[0];var o=obj.selectedContainer[1];var s=obj.selectedContainer[2];var a=obj.selectedContainer[3];if(null!=e&&null!=r){if(e-s>0){var u=parseInt(s)+1;var b=parseInt(e)}else{u=parseInt(e);b=parseInt(t)-1}if(r-a>0){var d=parseInt(a)+1;var f=parseInt(r)}else{d=parseInt(r);f=parseInt(o)-1}if(b-u<=f-d){u=parseInt(t);b=parseInt(s)}else{d=parseInt(o);f=parseInt(a)}for(var h=d;h<=f;h++)for(var g=u;g<=b;g++)if(obj.records[h][g]&&"none"!=obj.rows[h].style.display&&"none"!=obj.records[h][g].style.display){obj.records[h][g].classList.add("selection");obj.records[d][g].classList.add("selection-top");obj.records[f][g].classList.add("selection-bottom");obj.records[h][u].classList.add("selection-left");obj.records[h][b].classList.add("selection-right");obj.selection.push(obj.records[h][g])}}};obj.updateCornerPosition=function(){if(obj.highlighted.length){var e=obj.highlighted[obj.highlighted.length-1];var r=e.getAttribute("data-x");var t=obj.content.getBoundingClientRect();var o=t.left;var s=t.top;var a=e.getBoundingClientRect();var u=a.left;var b=a.top;var d=a.width;var f=a.height;var h=u-o+obj.content.scrollLeft+d-4;var g=b-s+obj.content.scrollTop+f-4;obj.corner.style.top=g+"px";obj.corner.style.left=h+"px";if(obj.options.freezeColumns){var m=obj.getFreezeWidth();r>obj.options.freezeColumns-1&&u-o+d<m?obj.corner.style.display="none":true==obj.options.selectionCopy&&(obj.corner.style.display="")}else true==obj.options.selectionCopy&&(obj.corner.style.display="")}else{obj.corner.style.top="-2000px";obj.corner.style.left="-2000px"}};obj.updateScroll=function(e){var r=obj.content.getBoundingClientRect();var t=r.left;var o=r.top;var s=r.width;var a=r.height;var u=obj.records[obj.selectedCell[3]][obj.selectedCell[2]];var b=u.getBoundingClientRect();var d=b.left;var f=b.top;var h=b.width;var g=b.height;if(0==e||1==e){var m=d-t+obj.content.scrollLeft;var v=f-o+obj.content.scrollTop-2}else{m=d-t+obj.content.scrollLeft+h;v=f-o+obj.content.scrollTop+g}v>obj.content.scrollTop+30&&v<obj.content.scrollTop+a||(v<obj.content.scrollTop+30?obj.content.scrollTop=v-g:obj.content.scrollTop=v-(a-2));var C=obj.getFreezeWidth();if(m>obj.content.scrollLeft+C&&m<obj.content.scrollLeft+s);else if(m<obj.content.scrollLeft+30){obj.content.scrollLeft=m;obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)}else m<obj.content.scrollLeft+C?obj.content.scrollLeft=m-C-1:obj.content.scrollLeft=m-(s-20)};
/**
     * Get the column width
     *
     * @param int column column number (first column is: 0)
     * @return int current width
     */obj.getWidth=function(e){if(e){"object"==typeof e&&(e=$(e).getAttribute("data-x"));r=obj.colgroup[e].getAttribute("width")}else{var r=[];for(var t=0;t<obj.headers.length;t++)r.push(obj.options.columns[t].width)}return r};
/**
     * Set the column width
     *
     * @param int column number (first column is: 0)
     * @param int new column width
     * @param int old column width
     */obj.setWidth=function(e,r,t){if(r){if(Array.isArray(e)){if(!t)t=[];for(var o=0;o<e.length;o++){t[o]||(t[o]=obj.colgroup[e[o]].getAttribute("width"));var s=Array.isArray(r)&&r[o]?r[o]:r;obj.colgroup[e[o]].setAttribute("width",s);obj.options.columns[e[o]].width=s}}else{t||(t=obj.colgroup[e].getAttribute("width"));obj.colgroup[e].setAttribute("width",r);obj.options.columns[e].width=r}obj.setHistory({action:"setWidth",column:e,oldValue:t,newValue:r});obj.dispatch("onresizecolumn",el,e,r,t);obj.updateCornerPosition()}};
/**
     * Set the row height
     *
     * @param row - row number (first row is: 0)
     * @param height - new row height
     * @param oldHeight - old row height
     */obj.setHeight=function(e,r,t){if(r>0){"object"==typeof e&&(e=e.getAttribute("data-y"));if(!t){t=obj.rows[e].getAttribute("height");if(!t){var o=obj.rows[e].getBoundingClientRect();t=o.height}}r=parseInt(r);obj.rows[e].style.height=r+"px";obj.options.rows[e]||(obj.options.rows[e]={});obj.options.rows[e].height=r;obj.setHistory({action:"setHeight",row:e,oldValue:t,newValue:r});obj.dispatch("onresizerow",el,e,r,t);obj.updateCornerPosition()}};
/**
     * Get the row height
     *
     * @param row - row number (first row is: 0)
     * @return height - current row height
     */obj.getHeight=function(e){if(e){"object"==typeof e&&(e=$(e).getAttribute("data-y"));r=obj.rows[e].style.height}else{var r=[];for(var t=0;t<obj.rows.length;t++){var o=obj.rows[t].style.height;o&&(r[t]=o)}}return r};obj.setFooter=function(e){e&&(obj.options.footers=e);if(obj.options.footers){if(!obj.tfoot){obj.tfoot=document.createElement("tfoot");obj.table.appendChild(obj.tfoot)}for(var r=0;r<obj.options.footers.length;r++){if(obj.tfoot.children[r])var t=obj.tfoot.children[r];else{t=document.createElement("tr");var o=document.createElement("td");t.appendChild(o);obj.tfoot.appendChild(t)}for(var s=0;s<obj.headers.length;s++){obj.options.footers[r][s]||(obj.options.footers[r][s]="");if(obj.tfoot.children[r].children[s+1])o=obj.tfoot.children[r].children[s+1];else{o=document.createElement("td");t.appendChild(o);var a=obj.options.columns[s].align?obj.options.columns[s].align:"center";o.style.textAlign=a}o.innerText=obj.parseValue(+obj.records.length+s,r,obj.options.footers[r][s])}}}};
/**
     * Get the column title
     *
     * @param column - column number (first column is: 0)
     * @param title - new column title
     */obj.getHeader=function(e){return obj.headers[e].innerText};
/**
     * Set the column title
     *
     * @param column - column number (first column is: 0)
     * @param title - new column title
     */obj.setHeader=function(e,r){if(obj.headers[e]){var t=obj.headers[e].innerText;r||(r=prompt(obj.options.text.columnName,t));if(r){obj.headers[e].innerText=r;obj.headers[e].setAttribute("title",r);obj.options.columns[e].title=r}obj.setHistory({action:"setHeader",column:e,oldValue:t,newValue:r});obj.dispatch("onchangeheader",el,e,t,r)}};
/**
     * Get the headers
     *
     * @param asArray
     * @return mixed
     */obj.getHeaders=function(e){var r=[];for(var t=0;t<obj.headers.length;t++)r.push(obj.getHeader(t));return e?r:r.join(obj.options.csvDelimiter)};obj.getMeta=function(e,r){return e?r?obj.options.meta[e]&&obj.options.meta[e][r]?obj.options.meta[e][r]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta};obj.setMeta=function(e,r,t){obj.options.meta||(obj.options.meta={});if(r&&t){obj.options.meta[e]||(obj.options.meta[e]={});obj.options.meta[e][r]=t}else{var o=Object.keys(e);for(var s=0;s<o.length;s++){obj.options.meta[o[s]]||(obj.options.meta[o[s]]={});var a=Object.keys(e[o[s]]);for(var u=0;u<a.length;u++)obj.options.meta[o[s]][a[u]]=e[o[s]][a[u]]}}obj.dispatch("onchangemeta",el,e,r,t)};obj.updateMeta=function(e){if(obj.options.meta){var r={};var t=Object.keys(obj.options.meta);for(var o=0;o<t.length;o++)e[t[o]]?r[e[t[o]]]=obj.options.meta[t[o]]:r[t[o]]=obj.options.meta[t[o]];obj.options.meta=r}};obj.getStyle=function(e,r){if(e){e=jexcel.getIdFromColumnName(e,true);return r?obj.records[e[1]][e[0]].style[r]:obj.records[e[1]][e[0]].getAttribute("style")}var t={};var o=obj.options.data[0].length;var s=obj.options.data.length;for(var a=0;a<s;a++)for(var u=0;u<o;u++){var b=r?obj.records[a][u].style[r]:obj.records[a][u].getAttribute("style");if(b){var d=jexcel.getColumnNameFromId([u,a]);t[d]=b}}return t},obj.resetStyle=function(e,r){var t=Object.keys(e);for(var o=0;o<t.length;o++){var s=jexcel.getIdFromColumnName(t[o],true);obj.records[s[1]]&&obj.records[s[1]][s[0]]&&obj.records[s[1]][s[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,r)};obj.setStyle=function(e,r,t,o,s){var a={};var u={};var applyStyle=function(e,r,t){var s=jexcel.getIdFromColumnName(e,true);if(obj.records[s[1]]&&obj.records[s[1]][s[0]]&&(false==obj.records[s[1]][s[0]].classList.contains("readonly")||o)){var b=obj.records[s[1]][s[0]].style[r];if(b!=t||o)obj.records[s[1]][s[0]].style[r]=t;else{t="";obj.records[s[1]][s[0]].style[r]=""}u[e]||(u[e]=[]);a[e]||(a[e]=[]);u[e].push([r+":"+b]);a[e].push([r+":"+t])}};if(r&&t)if("string"==typeof e)applyStyle(e,r,t);else{var b=[];for(var d=0;d<e.length;d++){var f=e[d].getAttribute("data-x");var h=e[d].getAttribute("data-y");var g=jexcel.getColumnNameFromId([f,h]);if(!b[g]){applyStyle(g,r,t);b[g]=true}}}else{var m=Object.keys(e);for(d=0;d<m.length;d++){var v=e[m[d]];"string"==typeof v&&(v=v.split(";"));for(var C=0;C<v.length;C++){"string"==typeof v[C]&&(v[C]=v[C].split(":"));v[C][0].trim()&&applyStyle(m[d],v[C][0].trim(),v[C][1])}}}m=Object.keys(u);for(d=0;d<m.length;d++)u[m[d]]=u[m[d]].join(";");m=Object.keys(a);for(d=0;d<m.length;d++)a[m[d]]=a[m[d]].join(";");s||obj.setHistory({action:"setStyle",oldValue:u,newValue:a});obj.dispatch("onchangestyle",el,e,r,t)};obj.getComments=function(e,r){if(e){if("string"==typeof e)e=jexcel.getIdFromColumnName(e,true);return r?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||""}var t={};for(var o=0;o<obj.options.data.length;o++)for(var s=0;s<obj.options.columns.length;s++){var a=obj.records[o][s].getAttribute("title");if(a){e=jexcel.getColumnNameFromId([s,o]);t[e]=a}}return t};obj.setComments=function(e,r,t){if("string"==typeof e)var o=jexcel.getIdFromColumnName(e,true);else o=e;var s=obj.records[o[1]][o[0]].getAttribute("title");t=obj.records[o[1]][o[0]].getAttribute("data-author");var a=[s,t];obj.records[o[1]][o[0]].setAttribute("title",r||"");obj.records[o[1]][o[0]].setAttribute("data-author",t||"");r?obj.records[o[1]][o[0]].classList.add("jexcel_comments"):obj.records[o[1]][o[0]].classList.remove("jexcel_comments");obj.setHistory({action:"setComments",column:e,newValue:[r,t],oldValue:a});obj.dispatch("oncomments",el,r,s,o,o[0],o[1])};obj.getConfig=function(){var e=obj.options;e.style=obj.getStyle();e.mergeCells=obj.getMerge();e.comments=obj.getComments();return e};obj.orderBy=function(e,r){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return false;obj.destroyMerged()}r=null==r?obj.headers[e].classList.contains("arrow-down")?1:0:r?1:0;var t=[];if("number"==obj.options.columns[e].type||"percentage"==obj.options.columns[e].type||"autonumber"==obj.options.columns[e].type||"color"==obj.options.columns[e].type)for(var o=0;o<obj.options.data.length;o++)t[o]=[o,Number(obj.options.data[o][e])];else if("calendar"==obj.options.columns[e].type||"checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type)for(o=0;o<obj.options.data.length;o++)t[o]=[o,obj.options.data[o][e]];else for(o=0;o<obj.options.data.length;o++)t[o]=[o,obj.records[o][e].innerText.toLowerCase()];"function"!==typeof obj.options.sorting&&(obj.options.sorting=function(e){return function(r,t){var o=r[1];var s=t[1];return e?""===o&&""!==s?1:""!==o&&""===s||o>s?-1:o<s?1:0:""===o&&""!==s?1:""!==o&&""===s?-1:o>s?1:o<s?-1:0}});t=t.sort(obj.options.sorting(r));var s=[];for(o=0;o<t.length;o++)s[o]=t[o][0];obj.setHistory({action:"orderBy",rows:s,column:e,order:r});obj.updateOrderArrow(e,r);obj.updateOrder(s);obj.dispatch("onsort",el,e,r);return true}};obj.updateOrderArrow=function(e,r){for(var t=0;t<obj.headers.length;t++){obj.headers[t].classList.remove("arrow-up");obj.headers[t].classList.remove("arrow-down")}r?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")};obj.updateOrder=function(e){var r=[];for(var t=0;t<e.length;t++)r[t]=obj.options.data[e[t]];obj.options.data=r;r=[];for(t=0;t<e.length;t++)r[t]=obj.records[e[t]];obj.records=r;r=[];for(t=0;t<e.length;t++)r[t]=obj.rows[e[t]];obj.rows=r;obj.updateTableReferences();if(obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else{obj.results=null;obj.pageNumber=0;if(obj.options.pagination>0)obj.page(0);else if(true==obj.options.lazyLoading)obj.loadPage(0);else for(t=0;t<obj.rows.length;t++)obj.tbody.appendChild(obj.rows[t])}};obj.moveRow=function(e,r,t){if(Object.keys(obj.options.mergeCells).length>0){if(e>r)var o=1;else o=0;if(obj.isRowMerged(e).length||obj.isRowMerged(r,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return false;obj.destroyMerged()}}if(true==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return false;obj.resetSearch()}obj.results=null}t||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[r])>=0?e>r?obj.tbody.insertBefore(obj.rows[e],obj.rows[r]):obj.tbody.insertBefore(obj.rows[e],obj.rows[r].nextSibling):obj.tbody.removeChild(obj.rows[e]));obj.rows.splice(r,0,obj.rows.splice(e,1)[0]);obj.records.splice(r,0,obj.records.splice(e,1)[0]);obj.options.data.splice(r,0,obj.options.data.splice(e,1)[0]);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber);obj.setHistory({action:"moveRow",oldValue:e,newValue:r});obj.updateTableReferences();obj.dispatch("onmoverow",el,e,r)};
/**
     * Insert a new row
     *
     * @param mixed - number of blank lines to be insert or a single array with the data of the new row
     * @param rowNumber
     * @param insertBefore
     * @return void
     */obj.insertRow=function(e,r,t){if(true==obj.options.allowInsertRow){var o=[];if(e>0)var s=e;else{s=1;e&&(o=e)}t=!!t;var a=obj.options.data.length-1;(void 0==r||r>=parseInt(a)||r<0)&&(r=a);if(false===obj.dispatch("onbeforeinsertrow",el,r,s,t))return false;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(r,t).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return false;obj.destroyMerged()}if(true==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return false;obj.resetSearch()}obj.results=null}var u=t?r:r+1;var b=obj.records.splice(u);var d=obj.options.data.splice(u);var f=obj.rows.splice(u);var h=[];var g=[];var m=[];for(var v=u;v<s+u;v++){obj.options.data[v]=[];for(var C=0;C<obj.options.columns.length;C++)obj.options.data[v][C]=o[C]?o[C]:"";var E=obj.createRow(v,obj.options.data[v]);f[0]?Array.prototype.indexOf.call(obj.tbody.children,f[0])>=0&&obj.tbody.insertBefore(E,f[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[r])>=0&&obj.tbody.appendChild(E);h.push(obj.records[v]);g.push(obj.options.data[v]);m.push(E)}Array.prototype.push.apply(obj.records,b);Array.prototype.push.apply(obj.options.data,d);Array.prototype.push.apply(obj.rows,f);obj.options.pagination>0&&obj.page(obj.pageNumber);obj.setHistory({action:"insertRow",rowNumber:r,numOfRows:s,insertBefore:t,rowRecords:h,rowData:g,rowNode:m});obj.updateTableReferences();obj.dispatch("oninsertrow",el,r,s,h,t)}};
/**
     * Delete a row by number
     *
     * @param integer rowNumber - row number to be excluded
     * @param integer numOfRows - number of lines
     * @return void
     */obj.deleteRow=function(e,r){if(true==obj.options.allowDeleteRow)if(true==obj.options.allowDeletingAllRows||obj.options.data.length>1){if(void 0==e){var t=obj.getSelectedRows();if(t[0]){e=parseInt(t[0].getAttribute("data-y"));r=t.length}else{e=obj.options.data.length-1;r=1}}var o=obj.options.data.length-1;(void 0==e||e>o||e<0)&&(e=o);r||(r=1);e+r>=obj.options.data.length&&(r=obj.options.data.length-e);if(false===obj.dispatch("onbeforedeleterow",el,e,r))return false;if(parseInt(e)>-1){var s=false;if(Object.keys(obj.options.mergeCells).length>0)for(var a=e;a<e+r;a++)obj.isRowMerged(a,false).length&&(s=true);if(s){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return false;obj.destroyMerged()}if(true==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return false;obj.resetSearch()}obj.results=null}if(false==obj.options.allowDeletingAllRows&&o+1===r){r--;console.error("Jspreadsheet: It is not possible to delete the last row")}for(a=e;a<e+r;a++)if(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[a])>=0){obj.rows[a].className="";obj.rows[a].parentNode.removeChild(obj.rows[a])}var u=obj.records.splice(e,r);var b=obj.options.data.splice(e,r);var d=obj.rows.splice(e,r);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber);obj.conditionalSelectionUpdate(1,e,e+r-1);obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:r,insertBefore:1,rowRecords:u,rowData:b,rowNode:d});obj.updateTableReferences();obj.dispatch("ondeleterow",el,e,r,u)}}else console.error("Jspreadsheet: It is not possible to delete the last row")};obj.moveColumn=function(e,r){if(Object.keys(obj.options.mergeCells).length>0){if(e>r)var t=1;else t=0;if(obj.isColMerged(e).length||obj.isColMerged(r,t).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return false;obj.destroyMerged()}}e=parseInt(e);r=parseInt(r);if(e>r){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[r]);obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[r]);for(var o=0;o<obj.rows.length;o++)obj.rows[o].insertBefore(obj.records[o][e],obj.records[o][r])}else{obj.headerContainer.insertBefore(obj.headers[e],obj.headers[r].nextSibling);obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[r].nextSibling);for(o=0;o<obj.rows.length;o++)obj.rows[o].insertBefore(obj.records[o][e],obj.records[o][r].nextSibling)}obj.options.columns.splice(r,0,obj.options.columns.splice(e,1)[0]);obj.headers.splice(r,0,obj.headers.splice(e,1)[0]);obj.colgroup.splice(r,0,obj.colgroup.splice(e,1)[0]);for(o=0;o<obj.rows.length;o++){obj.options.data[o].splice(r,0,obj.options.data[o].splice(e,1)[0]);obj.records[o].splice(r,0,obj.records[o].splice(e,1)[0])}if(obj.options.footers)for(o=0;o<obj.options.footers.length;o++)obj.options.footers[o].splice(r,0,obj.options.footers[o].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:r});obj.updateTableReferences();obj.dispatch("onmovecolumn",el,e,r)};
/**
     * Insert a new column
     *
     * @param mixed - num of columns to be added or data to be added in one single column
     * @param int columnNumber - number of columns to be created
     * @param bool insertBefore
     * @param object properties - column properties
     * @return void
     */obj.insertColumn=function(e,r,t,o){if(true==obj.options.allowInsertColumn){var s=[];if(e>0)var a=e;else{a=1;e&&(s=e)}t=!!t;var u=obj.options.columns.length-1;(void 0==r||r>=parseInt(u)||r<0)&&(r=u);if(false===obj.dispatch("onbeforeinsertcolumn",el,r,a,t))return false;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(r,t).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return false;obj.destroyMerged()}o||(o=[]);for(var b=0;b<a;b++)o[b]||(o[b]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var d=t?r:r+1;obj.options.columns=jexcel.injectArray(obj.options.columns,d,o);var f=obj.headers.splice(d);var h=obj.colgroup.splice(d);var g=[];var m=[];var v=[];var C=[];var E=[];for(var A=d;A<a+d;A++){obj.createCellHeader(A);obj.headerContainer.insertBefore(obj.headers[A],obj.headerContainer.children[A+1]);obj.colgroupContainer.insertBefore(obj.colgroup[A],obj.colgroupContainer.children[A+1]);g.push(obj.headers[A]);m.push(obj.colgroup[A])}if(obj.options.footers)for(var I=0;I<obj.options.footers.length;I++){E[I]=[];for(b=0;b<a;b++)E[I].push("");obj.options.footers[I].splice(d,0,E[I])}for(var M=0;M<obj.options.data.length;M++){var R=obj.options.data[M].splice(d);var D=obj.records[M].splice(d);C[M]=[];v[M]=[];for(A=d;A<a+d;A++){var S=s[M]?s[M]:"";obj.options.data[M][A]=S;var w=obj.createCell(A,M,obj.options.data[M][A]);obj.records[M][A]=w;obj.rows[M]&&obj.rows[M].insertBefore(w,obj.rows[M].children[A+1]);C[M].push(S);v[M].push(w)}Array.prototype.push.apply(obj.options.data[M],R);Array.prototype.push.apply(obj.records[M],D)}Array.prototype.push.apply(obj.headers,f);Array.prototype.push.apply(obj.colgroup,h);if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(I=0;I<obj.options.nestedHeaders.length;I++){var L=parseInt(obj.options.nestedHeaders[I][obj.options.nestedHeaders[I].length-1].colspan)+a;obj.options.nestedHeaders[I][obj.options.nestedHeaders[I].length-1].colspan=L;obj.thead.children[I].children[obj.thead.children[I].children.length-1].setAttribute("colspan",L);var O=obj.thead.children[I].children[obj.thead.children[I].children.length-1].getAttribute("data-column");O=O.split(",");for(A=d;A<a+d;A++)O.push(A);obj.thead.children[I].children[obj.thead.children[I].children.length-1].setAttribute("data-column",O)}else{L=parseInt(obj.options.nestedHeaders[0].colspan)+a;obj.options.nestedHeaders[0].colspan=L;obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",L)}obj.setHistory({action:"insertColumn",columnNumber:r,numOfColumns:a,insertBefore:t,columns:o,headers:g,colgroup:m,records:v,footers:E,data:C});obj.updateTableReferences();obj.dispatch("oninsertcolumn",el,r,a,v,t)}};
/**
     * Delete a column by number
     *
     * @param integer columnNumber - reference column to be excluded
     * @param integer numOfColumns - number of columns to be excluded from the reference column
     * @return void
     */obj.deleteColumn=function(e,r){if(true==obj.options.allowDeleteColumn)if(obj.headers.length>1){if(void 0==e){var t=obj.getSelectedColumns(true);if(t.length){e=parseInt(t[0]);r=parseInt(t.length)}else{e=obj.headers.length-1;r=1}}var o=obj.options.data[0].length-1;(void 0==e||e>o||e<0)&&(e=o);r||(r=1);r>obj.options.data[0].length-e&&(r=obj.options.data[0].length-e);if(false===obj.dispatch("onbeforedeletecolumn",el,e,r))return false;if(parseInt(e)>-1){var s=false;if(Object.keys(obj.options.mergeCells).length>0)for(var a=e;a<e+r;a++)obj.isColMerged(a,false).length&&(s=true);if(s){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return false;obj.destroyMerged()}var u=obj.options.columns.splice(e,r);for(a=e;a<e+r;a++){obj.colgroup[a].className="";obj.headers[a].className="";obj.colgroup[a].parentNode.removeChild(obj.colgroup[a]);obj.headers[a].parentNode.removeChild(obj.headers[a])}var b=obj.headers.splice(e,r);var d=obj.colgroup.splice(e,r);var f=[];var h=[];var g=[];for(var m=0;m<obj.options.data.length;m++)for(a=e;a<e+r;a++){obj.records[m][a].className="";obj.records[m][a].parentNode.removeChild(obj.records[m][a])}for(m=0;m<obj.options.data.length;m++){h[m]=obj.options.data[m].splice(e,r);f[m]=obj.records[m].splice(e,r)}if(obj.options.footers)for(m=0;m<obj.options.footers.length;m++)g[m]=obj.options.footers[m].splice(e,r);obj.conditionalSelectionUpdate(0,e,e+r-1);if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var v=0;v<obj.options.nestedHeaders.length;v++){var C=parseInt(obj.options.nestedHeaders[v][obj.options.nestedHeaders[v].length-1].colspan)-r;obj.options.nestedHeaders[v][obj.options.nestedHeaders[v].length-1].colspan=C;obj.thead.children[v].children[obj.thead.children[v].children.length-1].setAttribute("colspan",C)}else{C=parseInt(obj.options.nestedHeaders[0].colspan)-r;obj.options.nestedHeaders[0].colspan=C;obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",C)}obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:r,insertBefore:1,columns:u,headers:b,colgroup:d,records:f,footers:g,data:h});obj.updateTableReferences();obj.dispatch("ondeletecolumn",el,e,r,f)}}else console.error("Jspreadsheet: It is not possible to delete the last column")};obj.getSelectedRows=function(e){var r=[];for(var t=0;t<obj.rows.length;t++)obj.rows[t].classList.contains("selected")&&(e?r.push(t):r.push(obj.rows[t]));return r},obj.getSelectedColumns=function(){var e=[];for(var r=0;r<obj.headers.length;r++)obj.headers[r].classList.contains("selected")&&e.push(r);return e};obj.getHighlighted=function(){return obj.highlighted};obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++){var r=obj.headers[e].getAttribute("data-x");if(r!=e){obj.headers[e].setAttribute("data-x",e);obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e))}}for(var t=0;t<obj.rows.length;t++)if(obj.rows[t]){var o=obj.rows[t].getAttribute("data-y");if(o!=t){obj.rows[t].setAttribute("data-y",t);obj.rows[t].children[0].setAttribute("data-y",t);obj.rows[t].children[0].innerHTML=t+1}}var s=[];var a=[];var updatePosition=function(e,r,t,o){e!=t&&obj.records[o][t].setAttribute("data-x",t);r!=o&&obj.records[o][t].setAttribute("data-y",o);if(e!=t||r!=o){var a=jexcel.getColumnNameFromId([e,r]);var u=jexcel.getColumnNameFromId([t,o]);s[a]=u}};for(t=0;t<obj.records.length;t++)for(e=0;e<obj.records[0].length;e++)if(obj.records[t][e]){r=obj.records[t][e].getAttribute("data-x");o=obj.records[t][e].getAttribute("data-y");if(obj.records[t][e].getAttribute("data-merged")){var u=jexcel.getColumnNameFromId([r,o]);var b=jexcel.getColumnNameFromId([e,t]);if(null==a[u])if(u==b)a[u]=false;else{var d=parseInt(e-r);var f=parseInt(t-o);a[u]=[b,d,f]}}else updatePosition(r,o,e,t)}var h=Object.keys(a);if(h.length)for(e=0;e<h.length;e++)if(a[h[e]]){var g=jexcel.getIdFromColumnName(h[e],true);r=g[0];o=g[1];updatePosition(r,o,r+a[h[e]][1],o+a[h[e]][2]);u=h[e];b=a[h[e]][0];for(t=0;t<obj.options.mergeCells[u][2].length;t++){r=parseInt(obj.options.mergeCells[u][2][t].getAttribute("data-x"));o=parseInt(obj.options.mergeCells[u][2][t].getAttribute("data-y"));obj.options.mergeCells[u][2][t].setAttribute("data-x",r+a[h[e]][1]);obj.options.mergeCells[u][2][t].setAttribute("data-y",o+a[h[e]][2])}obj.options.mergeCells[b]=obj.options.mergeCells[u];delete obj.options.mergeCells[u]}obj.updateFormulas(s);obj.updateMeta(s);obj.refreshSelection();obj.updateTable()};obj.updateTable=function(){if(obj.options.minSpareRows>0){var e=0;for(var r=obj.rows.length-1;r>=0;r--){var t=false;for(var o=0;o<obj.headers.length;o++)obj.options.data[r][o]&&(t=true);if(t)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){var s=0;for(o=obj.headers.length-1;o>=0;o--){t=false;for(r=0;r<obj.rows.length;r++)obj.options.data[r][o]&&(t=true);if(t)break;s++}obj.options.minSpareCols-s>0&&obj.insertColumn(obj.options.minSpareCols-s)}if("function"==typeof obj.options.updateTable){obj.options.detachForUpdates&&el.removeChild(obj.content);for(r=0;r<obj.rows.length;r++)for(o=0;o<obj.headers.length;o++)obj.options.updateTable(el,obj.records[r][o],o,r,obj.options.data[r][o],obj.records[r][o].innerText,jexcel.getColumnNameFromId([o,r]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter();setTimeout((function(){obj.updateCornerPosition()}),0)};obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")};obj.setReadOnly=function(e,r){(e=obj.getCell(e))&&(r?e.classList.add("readonly"):e.classList.remove("readonly"))};obj.showRow=function(e){obj.rows[e].style.display=""};obj.hideRow=function(e){obj.rows[e].style.display="none"};obj.showColumn=function(e){obj.headers[e].style.display="";obj.colgroup[e].style.display="";obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="");for(var r=0;r<obj.options.data.length;r++)obj.records[r][e].style.display="";obj.resetSelection()};obj.hideColumn=function(e){obj.headers[e].style.display="none";obj.colgroup[e].style.display="none";obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="none");for(var r=0;r<obj.options.data.length;r++)obj.records[r][e].style.display="none";obj.resetSelection()};obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")};obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,r,t){var o=jexcel.getColumnNameFromId([e,r]);if(obj.formula[o]&&obj.formula[o].length>0)if(chainLoopProtection[o]){obj.records[r][e].innerHTML="#ERROR";obj.formula[o]=""}else{chainLoopProtection[o]=true;for(var s=0;s<obj.formula[o].length;s++){var a=jexcel.getIdFromColumnName(obj.formula[o][s],true);var u=""+obj.options.data[a[1]][a[0]];"="==u.substr(0,1)?t.push(obj.updateCell(a[0],a[1],u,true)):Object.keys(obj.formula)[s]=null;obj.updateFormulaChain(a[0],a[1],t)}}chainLoopProtection=[]};obj.updateFormulas=function(e){for(var r=0;r<obj.options.data.length;r++)for(var t=0;t<obj.options.data[0].length;t++){var o=""+obj.options.data[r][t];if("="==o.substr(0,1)){var s=obj.updateFormula(o,e);s!=o&&(obj.options.data[r][t]=s)}}var a=[];var u=Object.keys(obj.formula);for(r=0;r<u.length;r++){var b=u[r];o=obj.formula[b];e[b]&&(b=e[b]);a[b]=[];for(t=0;t<o.length;t++){var d=o[t];e[d]&&(d=e[d]);a[b].push(d)}}obj.formula=a};obj.updateFormula=function(e,r){var t=/[A-Z]/;var o=/[0-9]/;var s="";var a=null;var u=null;var b="";for(var d=0;d<e.length;d++)if(t.exec(e[d])){a=1;u=0;b+=e[d]}else if(o.exec(e[d])){u=a?1:0;b+=e[d]}else{a&&u&&(b=r[b]?r[b]:b);s+=b;s+=e[d];a=0;u=0;b=""}if(b){a&&u&&(b=r[b]?r[b]:b);s+=b}return s};var secureFormula=function(e){var r="";var t=0;for(var o=0;o<e.length;o++){'"'==e[o]&&(t=0==t?1:0);r+=1==t?e[o]:e[o].toUpperCase()}return r};obj.executeFormula=function(expression,x,y){var formulaResults=[];var formulaLoopProtection=[];var execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId]){console.error("Reference loop detected");return"#ERROR"}formulaLoopProtection[parentId]=true;var tokensUpdate=function(e){for(var r=0;r<e.length;r++){var t=[];var o=e[r].split(":");var s=jexcel.getIdFromColumnName(o[0],true);var a=jexcel.getIdFromColumnName(o[1],true);if(s[0]<=a[0]){var u=s[0];var b=a[0]}else{u=a[0];b=s[0]}if(s[1]<=a[1]){var d=s[1];var f=a[1]}else{d=a[1];f=s[1]}for(var h=d;h<=f;h++)for(var g=u;g<=b;g++)t.push(jexcel.getColumnNameFromId([g,h]));expression=expression.replace(e[r],t.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1){console.error("Self Reference detected");return"#ERROR"}var formulaExpressions={};if(tokens)for(var i=0;i<tokens.length;i++){obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]);obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId);if(eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if("undefined"!=typeof obj.options.data[position[1]]&&"undefined"!=typeof obj.options.data[position[1]][position[0]])var value=obj.options.data[position[1]][position[0]];else var value="";if("="==(""+value).substr(0,1))if(formulaResults[tokens[i]])value=formulaResults[tokens[i]];else{value=execute(value,position[0],position[1]);formulaResults[tokens[i]]=value}if(""==(""+value).trim())formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&true==obj.options.autoCasting)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);true==obj.options.autoCasting&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(e){var res="#ERROR";console.log(e)}return res};return execute(expression,x,y)};obj.parseNumber=function(e,r){var t=r&&obj.options.columns[r].decimal?obj.options.columns[r].decimal:".";var o=""+e;o=o.split(t);o[0]=o[0].match(/[+-]?[0-9]/g);o[0]&&(o[0]=o[0].join(""));o[1]&&(o[1]=o[1].match(/[0-9]*/g).join(""));if(o[0]&&Number(o[0])>=0)if(o[1])e=Number(o[0]+"."+o[1]);else var e=Number(o[0]+".00");else e=null;return e};obj.row=function(e){};obj.col=function(e){};obj.up=function(e,r){if(e)obj.selectedCell[3]>0&&obj.up.visible(1,r?0:1);else{obj.selectedCell[1]>0&&obj.up.visible(0,r?0:1);obj.selectedCell[2]=obj.selectedCell[0];obj.selectedCell[3]=obj.selectedCell[1]}obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);if(true==obj.options.lazyLoading)if(0==obj.selectedCell[1]||0==obj.selectedCell[3]){obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])}else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var t=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.selectedCell[1]-t<30){obj.loadUp();obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])}}else if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}obj.updateScroll(1)};obj.up.visible=function(e,r){if(0==e){var t=parseInt(obj.selectedCell[0]);var o=parseInt(obj.selectedCell[1])}else{t=parseInt(obj.selectedCell[2]);o=parseInt(obj.selectedCell[3])}if(0==r){for(var s=0;s<o;s++)if("none"!=obj.records[s][t].style.display&&"none"!=obj.rows[s].style.display){o=s;break}}else o=obj.up.get(t,o);if(0==e){obj.selectedCell[0]=t;obj.selectedCell[1]=o}else{obj.selectedCell[2]=t;obj.selectedCell[3]=o}};obj.up.get=function(e,r){e=parseInt(e);r=parseInt(r);for(var t=r-1;t>=0;t--)if("none"!=obj.records[t][e].style.display&&"none"!=obj.rows[t].style.display){if(obj.records[t][e].getAttribute("data-merged")&&obj.records[t][e]==obj.records[r][e])continue;r=t;break}return r};obj.down=function(e,r){if(e)obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,r?0:1);else{obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,r?0:1);obj.selectedCell[2]=obj.selectedCell[0];obj.selectedCell[3]=obj.selectedCell[1]}obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);if(true==obj.options.lazyLoading)if(obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1){obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])}else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var t=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(t-obj.selectedCell[3]<30){obj.loadDown();obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])}}else if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}obj.updateScroll(3)};obj.down.visible=function(e,r){if(0==e){var t=parseInt(obj.selectedCell[0]);var o=parseInt(obj.selectedCell[1])}else{t=parseInt(obj.selectedCell[2]);o=parseInt(obj.selectedCell[3])}if(0==r){for(var s=obj.rows.length-1;s>o;s--)if("none"!=obj.records[s][t].style.display&&"none"!=obj.rows[s].style.display){o=s;break}}else o=obj.down.get(t,o);if(0==e){obj.selectedCell[0]=t;obj.selectedCell[1]=o}else{obj.selectedCell[2]=t;obj.selectedCell[3]=o}};obj.down.get=function(e,r){e=parseInt(e);r=parseInt(r);for(var t=r+1;t<obj.rows.length;t++)if("none"!=obj.records[t][e].style.display&&"none"!=obj.rows[t].style.display){if(obj.records[t][e].getAttribute("data-merged")&&obj.records[t][e]==obj.records[r][e])continue;r=t;break}return r};obj.right=function(e,r){if(e)obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,r?0:1);else{obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,r?0:1);obj.selectedCell[2]=obj.selectedCell[0];obj.selectedCell[3]=obj.selectedCell[1]}obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);obj.updateScroll(2)};obj.right.visible=function(e,r){if(0==e){var t=parseInt(obj.selectedCell[0]);var o=parseInt(obj.selectedCell[1])}else{t=parseInt(obj.selectedCell[2]);o=parseInt(obj.selectedCell[3])}if(0==r){for(var s=obj.headers.length-1;s>t;s--)if("none"!=obj.records[o][s].style.display){t=s;break}}else t=obj.right.get(t,o);if(0==e){obj.selectedCell[0]=t;obj.selectedCell[1]=o}else{obj.selectedCell[2]=t;obj.selectedCell[3]=o}};obj.right.get=function(e,r){e=parseInt(e);r=parseInt(r);for(var t=e+1;t<obj.headers.length;t++)if("none"!=obj.records[r][t].style.display){if(obj.records[r][t].getAttribute("data-merged")&&obj.records[r][t]==obj.records[r][e])continue;e=t;break}return e};obj.left=function(e,r){if(e)obj.selectedCell[2]>0&&obj.left.visible(1,r?0:1);else{obj.selectedCell[0]>0&&obj.left.visible(0,r?0:1);obj.selectedCell[2]=obj.selectedCell[0];obj.selectedCell[3]=obj.selectedCell[1]}obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);obj.updateScroll(0)};obj.left.visible=function(e,r){if(0==e){var t=parseInt(obj.selectedCell[0]);var o=parseInt(obj.selectedCell[1])}else{t=parseInt(obj.selectedCell[2]);o=parseInt(obj.selectedCell[3])}if(0==r){for(var s=0;s<t;s++)if("none"!=obj.records[o][s].style.display){t=s;break}}else t=obj.left.get(t,o);if(0==e){obj.selectedCell[0]=t;obj.selectedCell[1]=o}else{obj.selectedCell[2]=t;obj.selectedCell[3]=o}};obj.left.get=function(e,r){e=parseInt(e);r=parseInt(r);for(var t=e-1;t>=0;t--)if("none"!=obj.records[r][t].style.display){if(obj.records[r][t].getAttribute("data-merged")&&obj.records[r][t]==obj.records[r][e])continue;e=t;break}return e};obj.first=function(e,r){if(e)r?obj.selectedCell[3]=0:obj.left.visible(1,0);else{r?obj.selectedCell[1]=0:obj.left.visible(0,0);obj.selectedCell[2]=obj.selectedCell[0];obj.selectedCell[3]=obj.selectedCell[1]}if(true!=obj.options.lazyLoading||0!=obj.selectedCell[1]&&0!=obj.selectedCell[3]){if(obj.options.pagination>0){var t=obj.whichPage(obj.selectedCell[3]);t!=obj.pageNumber&&obj.page(t)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);obj.updateScroll(1)};obj.last=function(e,r){if(e)r?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0);else{r?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0);obj.selectedCell[2]=obj.selectedCell[0];obj.selectedCell[3]=obj.selectedCell[1]}if(true!=obj.options.lazyLoading||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var t=obj.whichPage(obj.selectedCell[3]);t!=obj.pageNumber&&obj.page(t)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);obj.updateScroll(3)};obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]);obj.selectedCell[0]=0;obj.selectedCell[1]=0;obj.selectedCell[2]=obj.headers.length-1;obj.selectedCell[3]=obj.records.length-1;obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])};obj.loadPage=function(e){if(true==obj.options.search&&obj.results)var r=obj.results;else r=obj.rows;var t=100;null!=e&&-1!=e||(e=Math.ceil(r.length/t)-1);var o=e*t;var s=e*t+t;s>r.length&&(s=r.length);o=s-100;o<0&&(o=0);for(var a=o;a<s;a++){true==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[r[a]]):obj.tbody.appendChild(obj.rows[a]);obj.tbody.children.length>t&&obj.tbody.removeChild(obj.tbody.firstChild)}};obj.loadUp=function(){if(true==obj.options.search&&obj.results)var e=obj.results;else e=obj.rows;var r=0;if(e.length>100){var t=parseInt(obj.tbody.firstChild.getAttribute("data-y"));true==obj.options.search&&obj.results&&(t=e.indexOf(t));if(t>0)for(var o=0;o<30;o++){t-=1;if(t>-1){true==obj.options.search&&obj.results?obj.tbody.insertBefore(obj.rows[e[t]],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[t],obj.tbody.firstChild);if(obj.tbody.children.length>100){obj.tbody.removeChild(obj.tbody.lastChild);r=1}}}}return r};obj.loadDown=function(){if(true==obj.options.search&&obj.results)var e=obj.results;else e=obj.rows;var r=0;if(e.length>100){var t=parseInt(obj.tbody.lastChild.getAttribute("data-y"));true==obj.options.search&&obj.results&&(t=e.indexOf(t));if(t<obj.rows.length-1)for(var o=0;o<=30;o++){if(t<e.length){true==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[e[t]]):obj.tbody.appendChild(obj.rows[t]);if(obj.tbody.children.length>100){obj.tbody.removeChild(obj.tbody.firstChild);r=1}}t+=1}}return r};obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100;var r=parseInt(obj.selectedCell[3]/100);var t=parseInt(obj.rows.length/100);if(e!=r&&r<=t&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]])){obj.loadPage(r);return true}}return false};obj.resetSearch=function(){obj.searchInput.value="";obj.search("");obj.results=null};obj.search=function(e){if(e)e=e.toLowerCase();obj.options.filters&&obj.resetFilters();obj.resetSelection();obj.pageNumber=0;obj.results=[];if(e){var search=function(e,r,t){for(var o=0;o<e.length;o++)if((""+e[o]).toLowerCase().search(r)>=0||(""+obj.records[t][o].innerHTML).toLowerCase().search(r)>=0)return true;return false};var addToResult=function(e){-1==obj.results.indexOf(e)&&obj.results.push(e)};obj.options.data.filter((function(r,t){if(search(r,e,t)){var o=obj.isRowMerged(t);if(o.length)for(var s=0;s<o.length;s++){var a=jexcel.getIdFromColumnName(o[s],true);for(var u=0;u<obj.options.mergeCells[o[s]][1];u++)addToResult(a[1]+u)}else addToResult(t);return true}return false}))}else obj.results=null;return obj.updateResult()};obj.updateResult=function(){var e=0;var r=0;e=true==obj.options.lazyLoading?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;while(obj.tbody.firstChild)obj.tbody.removeChild(obj.tbody.firstChild);for(var t=0;t<obj.rows.length;t++)if(!obj.results||obj.results.indexOf(t)>-1){if(r<e){obj.tbody.appendChild(obj.rows[t]);r++}obj.rows[t].style.display=""}else obj.rows[t].style.display="none";obj.options.pagination>0&&obj.updatePagination();obj.updateCornerPosition();return e};obj.whichPage=function(e){true==obj.options.search&&obj.results&&(e=obj.results.indexOf(e));return Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1};obj.page=function(e){var r=obj.pageNumber;if(true==obj.options.search&&obj.results)var t=obj.results;else t=obj.rows;var o=parseInt(obj.options.pagination);null!=e&&-1!=e||(e=Math.ceil(t.length/o)-1);obj.pageNumber=e;var s=e*o;var a=e*o+o;a>t.length&&(a=t.length);s<0&&(s=0);while(obj.tbody.firstChild)obj.tbody.removeChild(obj.tbody.firstChild);for(var u=s;u<a;u++)true==obj.options.search&&obj.results?obj.tbody.appendChild(obj.rows[t[u]]):obj.tbody.appendChild(obj.rows[u]);obj.options.pagination>0&&obj.updatePagination();obj.updateCornerPosition();obj.dispatch("onchangepage",el,e,r)};obj.updatePagination=function(){obj.pagination.children[0].innerHTML="";obj.pagination.children[1].innerHTML="";if(obj.options.pagination){if(true==obj.options.search&&obj.results)var e=obj.results.length;else e=obj.rows.length;if(e){var r=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6){var t=1;var o=r<10?r:10}else if(r-obj.pageNumber<5){t=r-9;o=r;t<1&&(t=1)}else{t=obj.pageNumber-4;o=obj.pageNumber+5}if(t>1){var s=document.createElement("div");s.className="jexcel_page";s.innerHTML="<";s.title=1;obj.pagination.children[1].appendChild(s)}for(var a=t;a<=o;a++){s=document.createElement("div");s.className="jexcel_page";s.innerHTML=a;obj.pagination.children[1].appendChild(s);obj.pageNumber==a-1&&s.classList.add("jexcel_page_selected")}if(o<r){s=document.createElement("div");s.className="jexcel_page";s.innerHTML=">";s.title=r;obj.pagination.children[1].appendChild(s)}var format=function(e){var r=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,t){return"undefined"!=typeof r[t]?r[t]:e}))};obj.pagination.children[0].innerHTML=format(obj.options.text.showingPage,obj.pageNumber+1,r)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}};obj.download=function(e){if(false==obj.options.allowExport)console.error("Export not allowed");else{var r="";r+=obj.copy(false,obj.options.csvDelimiter,true,e,true);var t=new Blob(["\ufeff"+r],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(t,obj.options.csvFileName+".csv");else{var o=document.createElement("a");var s=URL.createObjectURL(t);o.href=s;o.setAttribute("download",obj.options.csvFileName+".csv");document.body.appendChild(o);o.click();o.parentNode.removeChild(o)}}};obj.setHistory=function(e){if(true!=obj.ignoreHistory){var r=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,r+1);obj.history[r]=e}};
/**
     * Copy method
     *
     * @param bool highlighted - Get only highlighted cells
     * @param delimiter - \t default to keep compatibility with excel
     * @return string value
     */obj.copy=function(e,r,t,o,s){r||(r="\t");var a=new RegExp(r,"ig");var u=[];var b=[];var d=[];var f=[];var h=[];var g=obj.options.data[0].length;var m=obj.options.data.length;var v="";var C=false;var E="";var A="";var I=0;var M=0;var R=0;var D=0;var S=true;for(var w=0;w<m;w++)for(var L=0;L<g;L++)if(!e||obj.records[w][L].classList.contains("highlight")){R<=L&&(R=L);D<=w&&(D=w)}g===R+1&&m===D+1&&(S=false);if(s&&true==obj.options.includeHeadersOnDownload||!s&&true==obj.options.includeHeadersOnCopy&&!S||o){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0){v=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders];for(w=0;w<v.length;w++){var O=[];for(L=0;L<v[w].length;L++){var B=parseInt(v[w][L].colspan);O.push(v[w][L].title);for(var U=0;U<B-1;U++)O.push("")}A+=O.join(r)+"\r\n"}}C=true}obj.style=[];for(w=0;w<m;w++){b=[];d=[];for(L=0;L<g;L++)if(!e||obj.records[w][L].classList.contains("highlight")){true==C&&u.push(obj.headers[L].innerText);var P=obj.options.data[w][L];if(P.match&&(P.match(a)||P.match(/,/g)||P.match(/\n/)||P.match(/\"/))){P=P.replace(new RegExp('"',"g"),'""');P='"'+P+'"'}b.push(P);if("checkbox"==obj.options.columns[L].type||"radio"==obj.options.columns[L].type)var H=P;else{if(true==obj.options.stripHTMLOnCopy)H=obj.records[w][L].innerText;else H=obj.records[w][L].innerHTML;if(H.match&&(H.match(a)||H.match(/,/g)||H.match(/\n/)||H.match(/\"/))){H=H.replace(new RegExp('"',"g"),'""');H='"'+H+'"'}}d.push(H);v=obj.records[w][L].getAttribute("style");v=v.replace("display: none;","");obj.style.push(v||"")}if(b.length){if(C){I=b.length;f.push(u.join(r))}f.push(b.join(r))}if(d.length){M++;if(C){h.push(u.join(r));C=false}h.push(d.join(r))}}g==I&&m==M&&(E=A);var V=E+f.join("\r\n");var Y=E+h.join("\r\n");if(!t){true==obj.options.copyCompatibility?obj.textarea.value=Y:obj.textarea.value=V;obj.textarea.select();document.execCommand("copy")}true==obj.options.copyCompatibility?obj.data=Y:obj.data=V;obj.hashString=obj.hash(obj.data);if(!t){obj.removeCopyingSelection();if(obj.highlighted)for(L=0;L<obj.highlighted.length;L++){obj.highlighted[L].classList.add("copying");obj.highlighted[L].classList.contains("highlight-left")&&obj.highlighted[L].classList.add("copying-left");obj.highlighted[L].classList.contains("highlight-right")&&obj.highlighted[L].classList.add("copying-right");obj.highlighted[L].classList.contains("highlight-top")&&obj.highlighted[L].classList.add("copying-top");obj.highlighted[L].classList.contains("highlight-bottom")&&obj.highlighted[L].classList.add("copying-bottom")}obj.dispatch("oncopy",el,true==obj.options.copyCompatibility?h:f,obj.hashString)}return obj.data};
/**
     * Jspreadsheet paste method
     *
     * @param integer row number
     * @return string value
     */obj.paste=function(e,r,t){var o=obj.dispatch("onbeforepaste",el,t,e,r);if(false===o)return false;if(o)t=o;var s=obj.hash(t);var a=s==obj.hashString?obj.style:null;if(true==obj.options.copyCompatibility&&s==obj.hashString)t=obj.data;t=obj.parseCSV(t,"\t");if(null!=e&&null!=r&&t){var u=0;var b=0;var d=[];var f={};var h={};var g=0;var m=parseInt(e);var v=parseInt(r);var C=null;while(C=t[b]){u=0;m=parseInt(e);while(null!=C[u]){var E=obj.updateCell(m,v,C[u]);d.push(E);obj.updateFormulaChain(m,v,d);if(a&&a[g]){var A=jexcel.getColumnNameFromId([m,v]);f[A]=a[g];h[A]=obj.getStyle(A);obj.records[v][m].setAttribute("style",a[g]);g++}u++;if(null!=C[u]){if(m>=obj.headers.length-1){if(true!=obj.options.allowInsertColumn)break;obj.insertColumn()}m=obj.right.get(m,v)}}b++;if(t[b]){if(v>=obj.rows.length-1){if(true!=obj.options.allowInsertRow)break;obj.insertRow()}v=obj.down.get(e,v)}}obj.updateSelectionFromCoords(e,r,m,v);obj.setHistory({action:"setValue",records:d,selection:obj.selectedCell,newStyle:f,oldStyle:h});obj.updateTable();obj.dispatch("onpaste",el,t);obj.onafterchanges(el,d)}obj.removeCopyingSelection()};obj.removeCopyingSelection=function(){var e=document.querySelectorAll(".jexcel .copying");for(var r=0;r<e.length;r++){e[r].classList.remove("copying");e[r].classList.remove("copying-left");e[r].classList.remove("copying-right");e[r].classList.remove("copying-top");e[r].classList.remove("copying-bottom")}};obj.historyProcessRow=function(e,r){var t=r.insertBefore?+r.rowNumber:r.rowNumber+1;true==obj.options.search&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch();if(1==e){var o=r.numOfRows;for(var s=t;s<o+t;s++)obj.rows[s].parentNode.removeChild(obj.rows[s]);obj.records.splice(t,o);obj.options.data.splice(t,o);obj.rows.splice(t,o);obj.conditionalSelectionUpdate(1,t,o+t-1)}else{obj.records=jexcel.injectArray(obj.records,t,r.rowRecords);obj.options.data=jexcel.injectArray(obj.options.data,t,r.rowData);obj.rows=jexcel.injectArray(obj.rows,t,r.rowNode);var a=0;for(s=t;s<r.numOfRows+t;s++){obj.tbody.insertBefore(r.rowNode[a],obj.tbody.children[s]);a++}}obj.options.pagination>0&&obj.page(obj.pageNumber);obj.updateTableReferences()};obj.historyProcessColumn=function(e,r){var t=r.insertBefore?r.columnNumber:r.columnNumber+1;if(1==e){var o=r.numOfColumns;obj.options.columns.splice(t,o);for(var s=t;s<o+t;s++){obj.headers[s].parentNode.removeChild(obj.headers[s]);obj.colgroup[s].parentNode.removeChild(obj.colgroup[s])}obj.headers.splice(t,o);obj.colgroup.splice(t,o);for(var a=0;a<r.data.length;a++){for(s=t;s<o+t;s++)obj.records[a][s].parentNode.removeChild(obj.records[a][s]);obj.records[a].splice(t,o);obj.options.data[a].splice(t,o)}if(obj.options.footers)for(a=0;a<obj.options.footers.length;a++)obj.options.footers[a].splice(t,o)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,t,r.columns);obj.headers=jexcel.injectArray(obj.headers,t,r.headers);obj.colgroup=jexcel.injectArray(obj.colgroup,t,r.colgroup);var u=0;for(s=t;s<r.numOfColumns+t;s++){obj.headerContainer.insertBefore(r.headers[u],obj.headerContainer.children[s+1]);obj.colgroupContainer.insertBefore(r.colgroup[u],obj.colgroupContainer.children[s+1]);u++}for(a=0;a<r.data.length;a++){obj.options.data[a]=jexcel.injectArray(obj.options.data[a],t,r.data[a]);obj.records[a]=jexcel.injectArray(obj.records[a],t,r.records[a]);u=0;for(s=t;s<r.numOfColumns+t;s++){obj.rows[a].insertBefore(r.records[a][u],obj.rows[a].children[s+1]);u++}}if(obj.options.footers)for(a=0;a<obj.options.footers.length;a++)obj.options.footers[a]=jexcel.injectArray(obj.options.footers[a],t,r.footers[a])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(a=0;a<obj.options.nestedHeaders.length;a++){if(1==e)var b=parseInt(obj.options.nestedHeaders[a][obj.options.nestedHeaders[a].length-1].colspan)-r.numOfColumns;else b=parseInt(obj.options.nestedHeaders[a][obj.options.nestedHeaders[a].length-1].colspan)+r.numOfColumns;obj.options.nestedHeaders[a][obj.options.nestedHeaders[a].length-1].colspan=b;obj.thead.children[a].children[obj.thead.children[a].children.length-1].setAttribute("colspan",b)}else{if(1==e)b=parseInt(obj.options.nestedHeaders[0].colspan)-r.numOfColumns;else b=parseInt(obj.options.nestedHeaders[0].colspan)+r.numOfColumns;obj.options.nestedHeaders[0].colspan=b;obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",b)}obj.updateTableReferences()};obj.undo=function(){var e=!!obj.ignoreEvents;var r=!!obj.ignoreHistory;obj.ignoreEvents=true;obj.ignoreHistory=true;var t=[];if(obj.historyIndex>=0){var o=obj.history[obj.historyIndex--];if("insertRow"==o.action)obj.historyProcessRow(1,o);else if("deleteRow"==o.action)obj.historyProcessRow(0,o);else if("insertColumn"==o.action)obj.historyProcessColumn(1,o);else if("deleteColumn"==o.action)obj.historyProcessColumn(0,o);else if("moveRow"==o.action)obj.moveRow(o.newValue,o.oldValue);else if("moveColumn"==o.action)obj.moveColumn(o.newValue,o.oldValue);else if("setMerge"==o.action)obj.removeMerge(o.column,o.data);else if("setStyle"==o.action)obj.setStyle(o.oldValue,null,null,1);else if("setWidth"==o.action)obj.setWidth(o.column,o.oldValue);else if("setHeight"==o.action)obj.setHeight(o.row,o.oldValue);else if("setHeader"==o.action)obj.setHeader(o.column,o.oldValue);else if("setComments"==o.action)obj.setComments(o.column,o.oldValue[0],o.oldValue[1]);else if("orderBy"==o.action){var s=[];for(var a=0;a<o.rows.length;a++)s[o.rows[a]]=a;obj.updateOrderArrow(o.column,o.order?0:1);obj.updateOrder(s)}else if("setValue"==o.action){for(var u=0;u<o.records.length;u++){t.push({x:o.records[u].x,y:o.records[u].y,newValue:o.records[u].oldValue});o.oldStyle&&obj.resetStyle(o.oldStyle)}obj.setValue(t);o.selection&&obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}}obj.ignoreEvents=e;obj.ignoreHistory=r;obj.dispatch("onundo",el,o)};obj.redo=function(){var e=!!obj.ignoreEvents;var r=!!obj.ignoreHistory;obj.ignoreEvents=true;obj.ignoreHistory=true;if(obj.historyIndex<obj.history.length-1){var t=obj.history[++obj.historyIndex];if("insertRow"==t.action)obj.historyProcessRow(0,t);else if("deleteRow"==t.action)obj.historyProcessRow(1,t);else if("insertColumn"==t.action)obj.historyProcessColumn(0,t);else if("deleteColumn"==t.action)obj.historyProcessColumn(1,t);else if("moveRow"==t.action)obj.moveRow(t.oldValue,t.newValue);else if("moveColumn"==t.action)obj.moveColumn(t.oldValue,t.newValue);else if("setMerge"==t.action)obj.setMerge(t.column,t.colspan,t.rowspan,1);else if("setStyle"==t.action)obj.setStyle(t.newValue,null,null,1);else if("setWidth"==t.action)obj.setWidth(t.column,t.newValue);else if("setHeight"==t.action)obj.setHeight(t.row,t.newValue);else if("setHeader"==t.action)obj.setHeader(t.column,t.newValue);else if("setComments"==t.action)obj.setComments(t.column,t.newValue[0],t.newValue[1]);else if("orderBy"==t.action){obj.updateOrderArrow(t.column,t.order);obj.updateOrder(t.rows)}else if("setValue"==t.action){obj.setValue(t.records);for(var o=0;o<t.records.length;o++)t.oldStyle&&obj.resetStyle(t.newStyle);t.selection&&obj.updateSelectionFromCoords(t.selection[0],t.selection[1],t.selection[2],t.selection[3])}}obj.ignoreEvents=e;obj.ignoreHistory=r;obj.dispatch("onredo",el,t)};obj.getDropDownValue=function(e,r){var t=[];if(obj.options.columns[e]&&obj.options.columns[e].source){var o=[];var s=obj.options.columns[e].source;for(var a=0;a<s.length;a++)"object"==typeof s[a]?o[s[a].id]=s[a].name:o[s[a]]=s[a];var u=Array.isArray(r)?r:(""+r).split(";");for(a=0;a<u.length;a++)"object"===typeof u[a]?t.push(o[u[a].id]):o[u[a]]&&t.push(o[u[a]])}else console.error("Invalid column");return t.length>0?t.join("; "):""};obj.parseCSV=function(e,r){e=e.replace(/\r?\n$|\r$|\n$/g,"");9==e.charCodeAt(e.length-1)&&(e+="\0");r=r||",";var t=[];var o=false;for(var s=0,a=0,u=0;u<e.length;u++){var b=e[u],d=e[u+1];t[s]=t[s]||[];t[s][a]=t[s][a]||"";if('"'==b&&o&&'"'==d){t[s][a]+=b;++u}else if('"'!=b)if(b!=r||o)if("\r"!=b||"\n"!=d||o)if("\n"!=b||o)if("\r"!=b||o)t[s][a]+=b;else{++s;a=0}else{++s;a=0}else{++s;a=0;++u}else++a;else o=!o}return t};obj.hash=function(e){var r,t,o=0;if(0===e.length)return o;for(r=0;r<e.length;r++){t=e.charCodeAt(r);o=(o<<5)-o+t;o|=0}return o};obj.onafterchanges=function(e,r){obj.dispatch("onafterchanges",e,r)};obj.destroy=function(){jexcel.destroy(el)};obj.init=function(){jexcel.current=obj;if("function"==typeof jexcel.build)if(obj.options.root)jexcel.build(obj.options.root);else{jexcel.build(document);jexcel.build=null}el.setAttribute("tabindex",1);el.addEventListener("focus",(function(e){if(jexcel.current&&!obj.selectedCell){obj.updateSelectionFromCoords(0,0,0,0);obj.left()}}));if(obj.options.csv){true==obj.options.loadingSpin&&jSuites.loading.show();jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){var r=obj.parseCSV(e,obj.options.csvDelimiter);if(true==obj.options.csvHeaders&&r.length>0){var t=r.shift();for(var o=0;o<t.length;o++){obj.options.columns[o]||(obj.options.columns[o]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth});"undefined"===typeof obj.options.columns[o].title&&(obj.options.columns[o].title=t[o])}}obj.options.data=r;obj.prepareTable();true==obj.options.loadingSpin&&jSuites.loading.hide()}})}else if(obj.options.url){true==obj.options.loadingSpin&&jSuites.loading.show();jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e;obj.prepareTable();true==obj.options.loadingSpin&&jSuites.loading.hide()}})}else obj.prepareTable()};options&&null!=options.contextMenu?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,r,t,o){var s=[];if(null==t){true==obj.options.allowInsertColumn&&s.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(r),1)}});true==obj.options.allowInsertColumn&&s.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(r),0)}});true==obj.options.allowDeleteColumn&&s.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(r))}});true==obj.options.allowRenameColumn&&s.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(r)}});if(true==obj.options.columnSorting){s.push({type:"line"});s.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(r,0)}});s.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(r,1)}})}}else{if(true==obj.options.allowInsertRow){s.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(t),1)}});s.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(t))}})}true==obj.options.allowDeleteRow&&s.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(t))}});if(r&&true==obj.options.allowComments){s.push({type:"line"});var a=obj.records[t][r].getAttribute("title")||"";s.push({title:a?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var e=prompt(obj.options.text.comments,a);e&&obj.setComments([r,t],e)}});a&&s.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([r,t],"")}})}}s.push({type:"line"});s.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(true)}});navigator&&navigator.clipboard&&s.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then((function(e){e&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],e)}))}});obj.options.allowExport&&s.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}});obj.options.about&&s.push({title:obj.options.text.about,onclick:function(){true===obj.options.about?alert(Version().print()):alert(obj.options.about)}});return s};obj.scrollControls=function(e){obj.wheelControls();obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition();true!=obj.options.lazyLoading&&true!=obj.options.tableOverflow||obj.edition&&"jdropdown"!=e.target.className.substr(0,9)&&obj.closeEditor(obj.edition[0],true)};obj.wheelControls=function(e){true==obj.options.lazyLoading&&null==jexcel.timeControlLoading&&(jexcel.timeControlLoading=setTimeout((function(){if(obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10){if(obj.loadDown()){obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight);obj.updateCornerPosition()}}else if(obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()){obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight);obj.updateCornerPosition()}jexcel.timeControlLoading=null}),100))};obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var r=0;r<obj.options.freezeColumns;r++)e+=parseInt(obj.options.columns[r].width);return e};var scrollLeft=0;obj.updateFreezePosition=function(){scrollLeft=obj.content.scrollLeft;var e=0;if(scrollLeft>50)for(var r=0;r<obj.options.freezeColumns;r++){r>0&&"hidden"!==obj.options.columns[r-1].type&&(e+=parseInt(obj.options.columns[r-1].width));obj.headers[r].classList.add("jexcel_freezed");obj.headers[r].style.left=e+"px";for(var t=0;t<obj.rows.length;t++)if(obj.rows[t]&&obj.records[t][r]){var o=scrollLeft+(r>0?obj.records[t][r-1].style.width:0)-51+"px";obj.records[t][r].classList.add("jexcel_freezed");obj.records[t][r].style.left=o}}else for(r=0;r<obj.options.freezeColumns;r++){obj.headers[r].classList.remove("jexcel_freezed");obj.headers[r].style.left="";for(t=0;t<obj.rows.length;t++)if(obj.records[t][r]){obj.records[t][r].classList.remove("jexcel_freezed");obj.records[t][r].style.left=""}}obj.updateCornerPosition()};el.addEventListener("DOMMouseScroll",obj.wheelControls);el.addEventListener("mousewheel",obj.wheelControls);el.jexcel=obj;el.jspreadsheet=obj;obj.init();return obj};jexcel.setDictionary=function(e){jSuites.setDictionary(e)};jexcel.setExtensions=function(e){var r=Object.keys(e);for(var t=0;t<r.length;t++)if("function"===typeof e[r[t]]){jexcel[r[t]]=e[r[t]];jexcel.license&&"function"==typeof e[r[t]].license&&e[r[t]].license(jexcel.license)}};"undefined"!==typeof formula&&(jexcel.formula=formula);jexcel.version=Version;jexcel.current=null;jexcel.timeControl=null;jexcel.timeControlLoading=null;jexcel.destroy=function(e,r){if(e.jexcel){var t=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls);e.removeEventListener("mousewheel",e.jexcel.scrollControls);e.jexcel=null;e.innerHTML="";if(r){t.removeEventListener("mouseup",jexcel.mouseUpControls);t.removeEventListener("mousedown",jexcel.mouseDownControls);t.removeEventListener("mousemove",jexcel.mouseMoveControls);t.removeEventListener("mouseover",jexcel.mouseOverControls);t.removeEventListener("dblclick",jexcel.doubleClickControls);t.removeEventListener("paste",jexcel.pasteControls);t.removeEventListener("contextmenu",jexcel.contextMenuControls);t.removeEventListener("touchstart",jexcel.touchStartControls);t.removeEventListener("touchend",jexcel.touchEndControls);t.removeEventListener("touchcancel",jexcel.touchEndControls);document.removeEventListener("keydown",jexcel.keyDownControls);jexcel=null}}};jexcel.build=function(e){e.addEventListener("mouseup",jexcel.mouseUpControls);e.addEventListener("mousedown",jexcel.mouseDownControls);e.addEventListener("mousemove",jexcel.mouseMoveControls);e.addEventListener("mouseover",jexcel.mouseOverControls);e.addEventListener("dblclick",jexcel.doubleClickControls);e.addEventListener("paste",jexcel.pasteControls);e.addEventListener("contextmenu",jexcel.contextMenuControls);e.addEventListener("touchstart",jexcel.touchStartControls);e.addEventListener("touchend",jexcel.touchEndControls);e.addEventListener("touchcancel",jexcel.touchEndControls);e.addEventListener("touchmove",jexcel.touchEndControls);document.addEventListener("keydown",jexcel.keyDownControls)};jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(27==e.which){jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],false);e.preventDefault()}else if(13==e.which)if("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type)jexcel.current.closeEditor(jexcel.current.edition[0],true);else if("dropdown"==jexcel.current.options.columns[jexcel.current.edition[2]].type||"autocomplete"==jexcel.current.options.columns[jexcel.current.edition[2]].type);else if((true==jexcel.current.options.wordWrap||true==jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var r=jexcel.current.edition[0].children[0];var t=jexcel.current.edition[0].children[0].value;var o=r.selectionStart;t=t.slice(0,o)+"\n"+t.slice(o);r.value=t;r.focus();r.selectionStart=o+1;r.selectionEnd=o+1}else jexcel.current.edition[0].children[0].blur();else 9==e.which&&("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type?jexcel.current.closeEditor(jexcel.current.edition[0],true):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(37==e.which){jexcel.current.left(e.shiftKey,e.ctrlKey);e.preventDefault()}else if(39==e.which){jexcel.current.right(e.shiftKey,e.ctrlKey);e.preventDefault()}else if(38==e.which){jexcel.current.up(e.shiftKey,e.ctrlKey);e.preventDefault()}else if(40==e.which){jexcel.current.down(e.shiftKey,e.ctrlKey);e.preventDefault()}else if(36==e.which){jexcel.current.first(e.shiftKey,e.ctrlKey);e.preventDefault()}else if(35==e.which){jexcel.current.last(e.shiftKey,e.ctrlKey);e.preventDefault()}else if(32==e.which){true==jexcel.current.options.editable&&jexcel.current.setCheckRadioValue();e.preventDefault()}else if(46==e.which)true==jexcel.current.options.editable&&(jexcel.current.selectedRow?true==jexcel.current.options.allowDeleteRow&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?true==jexcel.current.options.allowDeleteColumn&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(13==e.which){if(e.shiftKey)jexcel.current.up();else{true==jexcel.current.options.allowInsertRow&&true==jexcel.current.options.allowManualInsertRow&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow();jexcel.current.down()}e.preventDefault()}else if(9==e.which){if(e.shiftKey)jexcel.current.left();else{true==jexcel.current.options.allowInsertColumn&&true==jexcel.current.options.allowManualInsertColumn&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn();jexcel.current.right()}e.preventDefault()}else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(jexcel.current.selectedCell&&true==jexcel.current.options.editable){var s=jexcel.current.selectedCell[1];var a=jexcel.current.selectedCell[0];if("readonly"!=jexcel.current.options.columns[a].type)if(32==e.keyCode)"checkbox"==jexcel.current.options.columns[a].type||"radio"==jexcel.current.options.columns[a].type?e.preventDefault():jexcel.current.openEditor(jexcel.current.records[s][a],true);else if(113==e.keyCode)jexcel.current.openEditor(jexcel.current.records[s][a],false);else if(8==e.keyCode||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||e.keyCode>=187&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode))){jexcel.current.openEditor(jexcel.current.records[s][a],true);"calendar"==jexcel.current.options.columns[a].type&&e.preventDefault()}}}else if(65==e.which){jexcel.current.selectAll();e.preventDefault()}else if(83==e.which){jexcel.current.download();e.preventDefault()}else if(89==e.which){jexcel.current.redo();e.preventDefault()}else if(90==e.which){jexcel.current.undo();e.preventDefault()}else if(67==e.which){jexcel.current.copy(true);e.preventDefault()}else if(88==e.which){true==jexcel.current.options.editable?jexcel.cutControls():jexcel.copyControls();e.preventDefault()}else 86==e.which&&jexcel.pasteControls();else if(e.target.classList.contains("jexcel_search")){jexcel.timeControl&&clearTimeout(jexcel.timeControl);jexcel.timeControl=setTimeout((function(){jexcel.current.search(e.target.value)}),200)}}};jexcel.isMouseAction=false;jexcel.mouseDownControls=function(e){e=e||window.event;if(e.buttons)var r=e.buttons;else if(e.button)r=e.button;else r=e.which;var t=jexcel.getElement(e.target);if(t[0]){if(jexcel.current!=t[0].jexcel){if(jexcel.current){jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],true);jexcel.current.resetSelection()}jexcel.current=t[0].jexcel}}else if(jexcel.current){jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],true);jexcel.current.resetSelection(true);jexcel.current=null}if(jexcel.current&&1==r){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))true==jexcel.current.options.editable&&(jexcel.current.selectedCorner=true);else{if(1==t[1]){var o=e.target.getAttribute("data-x");if(o){var s=e.target.getBoundingClientRect();if(true==jexcel.current.options.columnResize&&s.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:o,width:s.width};jexcel.current.headers[o].classList.add("resizing");for(var a=0;a<jexcel.current.records.length;a++)jexcel.current.records[a][o]&&jexcel.current.records[a][o].classList.add("resizing")}else if(true==jexcel.current.options.columnDrag&&s.height-e.offsetY<6)if(jexcel.current.isColMerged(o).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{jexcel.current.resetSelection();jexcel.current.dragging={element:e.target,column:o,destination:o};jexcel.current.headers[o].classList.add("dragging");for(a=0;a<jexcel.current.records.length;a++)jexcel.current.records[a][o]&&jexcel.current.records[a][o].classList.add("dragging")}else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey)){var u=jexcel.current.selectedHeader;var b=o}else{jexcel.current.selectedHeader==o&&true==jexcel.current.options.allowRenameColumn&&(jexcel.timeControl=setTimeout((function(){jexcel.current.setHeader(o)}),800));jexcel.current.selectedHeader=o;u=o;b=o}jexcel.current.updateSelectionFromCoords(u,0,b,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column")){var d=e.target.getAttribute("data-column").split(",");var f=parseInt(d[0]);var h=parseInt(d[d.length-1])}else{f=0;h=jexcel.current.options.columns.length-1}jexcel.current.updateSelectionFromCoords(f,0,h,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=false;if(2==t[1]){var g=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row")){s=e.target.getBoundingClientRect();if(true==jexcel.current.options.rowResize&&s.height-e.offsetY<6){jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:g,height:s.height};e.target.parentNode.classList.add("resizing")}else if(true==jexcel.current.options.rowDrag&&s.width-e.offsetX<6)if(jexcel.current.isRowMerged(g).length)console.error("Jspreadsheet: This row is part of a merged cell");else if(true==jexcel.current.options.search&&jexcel.current.results)console.error("Jspreadsheet: Please clear your search before perform this action");else{jexcel.current.resetSelection();jexcel.current.dragging={element:e.target.parentNode,row:g,destination:g};e.target.parentNode.classList.add("dragging")}else{if(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey)){u=jexcel.current.selectedRow;b=g}else{jexcel.current.selectedRow=g;u=g;b=g}jexcel.current.updateSelectionFromCoords(0,u,jexcel.current.options.data[0].length-1,b)}}else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],true);else{var getCellCoords=function(e){var r=e.getAttribute("data-x");var t=e.getAttribute("data-y");return r&&t?[r,t]:e.parentNode?getCellCoords(e.parentNode):void 0};var m=getCellCoords(e.target);if(m){o=m[0];g=m[1];jexcel.current.edition&&(jexcel.current.edition[2]==o&&jexcel.current.edition[3]==g||jexcel.current.closeEditor(jexcel.current.edition[0],true));jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],o,g):jexcel.current.updateSelectionFromCoords(o,g));jexcel.current.selectedHeader=null;jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=false;e.target.classList.contains("jexcel_page")&&("<"==e.target.innerText?jexcel.current.page(0):">"==e.target.innerText?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.innerText-1))}jexcel.current.edition?jexcel.isMouseAction=false:jexcel.isMouseAction=true}else jexcel.isMouseAction=false};jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var r=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width");var t=jexcel.current.getSelectedColumns();if(t.length>1){var o=[];for(var s=0;s<t.length;s++)o.push(parseInt(jexcel.current.colgroup[t[s]].getAttribute("width")));var a=t.indexOf(parseInt(jexcel.current.resizing.column));o[a]=jexcel.current.resizing.width;jexcel.current.setWidth(t,r,o)}else jexcel.current.setWidth(jexcel.current.resizing.column,r,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var u=0;u<jexcel.current.records.length;u++)jexcel.current.records[u][jexcel.current.resizing.column]&&jexcel.current.records[u][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var b=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,b,jexcel.current.resizing.height);jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var d=e.target.getAttribute("data-x");jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging");for(u=0;u<jexcel.current.rows.length;u++)jexcel.current.records[u][jexcel.current.dragging.column]&&jexcel.current.records[u][jexcel.current.dragging.column].classList.remove("dragging");for(s=0;s<jexcel.current.headers.length;s++){jexcel.current.headers[s].classList.remove("dragging-left");jexcel.current.headers[s].classList.remove("dragging-right")}d&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var f=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<f&&(f-=1)}else f=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,f,true);jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else if(jexcel.current.selectedCorner){jexcel.current.selectedCorner=false;if(jexcel.current.selection.length>0){jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]);jexcel.current.removeCopySelection()}}if(jexcel.timeControl){clearTimeout(jexcel.timeControl);jexcel.timeControl=null}jexcel.isMouseAction=false};jexcel.mouseMoveControls=function(e){e=e||window.event;if(e.buttons)var r=e.buttons;else if(e.button)r=e.button;else r=e.which;r||(jexcel.isMouseAction=false);if(jexcel.current)if(true==jexcel.isMouseAction){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var t=e.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+t>0){var o=jexcel.current.resizing.width+t;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",o);jexcel.current.updateCornerPosition()}}else{var s=e.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+s>0){var a=jexcel.current.resizing.height+s;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",a);jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var u=e.target.getAttribute("data-x");if(u)if(jexcel.current.isColMerged(u).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var b=0;b<jexcel.current.headers.length;b++){jexcel.current.headers[b].classList.remove("dragging-left");jexcel.current.headers[b].classList.remove("dragging-right")}if(jexcel.current.dragging.column==u)jexcel.current.dragging.destination=parseInt(u);else if(e.target.clientWidth/2>e.offsetX){jexcel.current.dragging.column<u?jexcel.current.dragging.destination=parseInt(u)-1:jexcel.current.dragging.destination=parseInt(u);jexcel.current.headers[u].classList.add("dragging-left")}else{jexcel.current.dragging.column<u?jexcel.current.dragging.destination=parseInt(u):jexcel.current.dragging.destination=parseInt(u)+1;jexcel.current.headers[u].classList.add("dragging-right")}}}else{var d=e.target.getAttribute("data-y");if(d)if(jexcel.current.isRowMerged(d).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var f=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;if(jexcel.current.dragging.element!=f){e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,f);jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element)}}}}else{var h=e.target.getAttribute("data-x");var g=e.target.getAttribute("data-y");var m=e.target.getBoundingClientRect();if(jexcel.current.cursor){jexcel.current.cursor.style.cursor="";jexcel.current.cursor=null}if(e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className){if(e.target.parentNode.parentNode.classList.contains("resizable"))if(e.target&&h&&!g&&m.width-(e.clientX-m.left)<6){jexcel.current.cursor=e.target;jexcel.current.cursor.style.cursor="col-resize"}else if(e.target&&!h&&g&&m.height-(e.clientY-m.top)<6){jexcel.current.cursor=e.target;jexcel.current.cursor.style.cursor="row-resize"}if(e.target.parentNode.parentNode.classList.contains("draggable"))if(e.target&&!h&&g&&m.width-(e.clientX-m.left)<6){jexcel.current.cursor=e.target;jexcel.current.cursor.style.cursor="move"}else if(e.target&&h&&!g&&m.height-(e.clientY-m.top)<6){jexcel.current.cursor=e.target;jexcel.current.cursor.style.cursor="move"}}}};jexcel.mouseOverControls=function(e){e=e||window.event;if(e.buttons)var r=e.buttons;else if(e.button)r=e.button;else r=e.which;r||(jexcel.isMouseAction=false);if(jexcel.current&&true==jexcel.isMouseAction){var t=jexcel.getElement(e.target);if(t[0]){if(jexcel.current!=t[0].jexcel&&jexcel.current)return false;var o=e.target.getAttribute("data-x");var s=e.target.getAttribute("data-y");if(jexcel.current.resizing||jexcel.current.dragging);else{if(1==t[1]&&jexcel.current.selectedHeader){o=e.target.getAttribute("data-x");var a=jexcel.current.selectedHeader;var u=o;jexcel.current.updateSelectionFromCoords(a,0,u,jexcel.current.options.data.length-1)}if(2==t[1])if(e.target.classList.contains("jexcel_row")){if(jexcel.current.selectedRow){a=jexcel.current.selectedRow;u=s;jexcel.current.updateSelectionFromCoords(0,a,jexcel.current.options.data[0].length-1,u)}}else jexcel.current.edition||o&&s&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(o,s):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],o,s))}}}if(jexcel.timeControl){clearTimeout(jexcel.timeControl);jexcel.timeControl=null}};jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var r=jexcel.current.highlighted[0].getAttribute("data-x");var t=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1;var o=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x");var s=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[t][r],jexcel.current.records[s][o])}}else if(e.target.classList.contains("jexcel_column_filter")){var a=e.target.getAttribute("data-x");jexcel.current.openFilter(a)}else{var u=jexcel.getElement(e.target);if(1==u[1]&&true==jexcel.current.options.columnSorting){a=e.target.getAttribute("data-x");a&&jexcel.current.orderBy(a)}if(2==u[1]&&true==jexcel.current.options.editable&&!jexcel.current.edition){var getCellCoords=function(e){if(e.parentNode){var r=e.getAttribute("data-x");var t=e.getAttribute("data-y");return r&&t?e:getCellCoords(e.parentNode)}};var b=getCellCoords(e.target);b&&b.classList.contains("highlight")&&jexcel.current.openEditor(b)}}};jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(true))};jexcel.cutControls=function(e){if(jexcel.current&&!jexcel.current.edition){jexcel.current.copy(true);true==jexcel.current.options.editable&&jexcel.current.setValue(jexcel.current.highlighted,"")}};jexcel.pasteControls=function(e){if(jexcel.current&&jexcel.current.selectedCell&&!jexcel.current.edition&&true==jexcel.current.options.editable)if(e&&e.clipboardData){jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text"));e.preventDefault()}else window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))};jexcel.contextMenuControls=function(e){e=e||window.event;if("buttons"in e)e.buttons;else e.which||e.button;if(jexcel.current)if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu){jexcel.current.contextMenu.contextmenu.close();if(jexcel.current){var r=e.target.getAttribute("data-x");var t=e.target.getAttribute("data-y");if(r||t){(r<parseInt(jexcel.current.selectedCell[0])||r>parseInt(jexcel.current.selectedCell[2])||t<parseInt(jexcel.current.selectedCell[1])||t>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(r,t,r,t);var o=jexcel.current.options.contextMenu(jexcel.current,r,t,e);jexcel.current.contextMenu.contextmenu.open(e,o);e.preventDefault()}}}};jexcel.touchStartControls=function(e){var r=jexcel.getElement(e.target);if(r[0]){if(jexcel.current!=r[0].jexcel){jexcel.current&&jexcel.current.resetSelection();jexcel.current=r[0].jexcel}}else if(jexcel.current){jexcel.current.resetSelection();jexcel.current=null}if(jexcel.current&&!jexcel.current.edition){var t=e.target.getAttribute("data-x");var o=e.target.getAttribute("data-y");if(t&&o){jexcel.current.updateSelectionFromCoords(t,o);jexcel.timeControl=setTimeout((function(){"color"==jexcel.current.options.columns[t].type?jexcel.tmpElement=null:jexcel.tmpElement=e.target;jexcel.current.openEditor(e.target,false,e)}),500)}}};jexcel.touchEndControls=function(e){if(jexcel.timeControl){clearTimeout(jexcel.timeControl);jexcel.timeControl=null;jexcel.tmpElement&&"INPUT"==jexcel.tmpElement.children[0].tagName&&jexcel.tmpElement.children[0].focus();jexcel.tmpElement=null}};jexcel.tabs=function(e,r){var t=[];if(e.classList.contains("jexcel_tabs")){s=e.children[0];a=e.children[1]}else{e.innerHTML="";e.classList.add("jexcel_tabs");e.jexcel=[];var o=document.createElement("div");var s=e.appendChild(o);o=document.createElement("div");var a=e.appendChild(o)}var u=[];var b=[];for(var d=0;d<r.length;d++){u[d]=document.createElement("div");u[d].classList.add("jexcel_tab");var f=jexcel(u[d],r[d]);a.appendChild(u[d]);t[d]=e.jexcel.push(f);b[d]=document.createElement("div");b[d].classList.add("jexcel_tab_link");b[d].setAttribute("data-spreadsheet",e.jexcel.length-1);b[d].innerHTML=r[d].sheetName;b[d].onclick=function(){for(var e=0;e<s.children.length;e++){s.children[e].classList.remove("selected");a.children[e].style.display="none"}var r=this.getAttribute("data-spreadsheet");a.children[r].style.display="block";s.children[r].classList.add("selected")};s.appendChild(b[d])}for(var h=0;h<s.children.length;h++){s.children[h].classList.remove("selected");a.children[h].style.display="none"}s.children[s.children.length-1].classList.add("selected");a.children[s.children.length-1].style.display="block";return t};jexcel.createTabs=jexcel.tabs;jexcel.fromSpreadsheet=function(e,r){var convert=function(e){var r=[];e.SheetNames.forEach((function(t){var o={};o.rows=[];o.columns=[];o.data=[];o.style={};o.sheetName=t;var s=e.Sheets[t]["!cols"];if(s&&s.length)for(var a=0;a<s.length;a++){o.columns[a]={};s[a]&&s[a].wpx&&(o.columns[a].width=s[a].wpx+"px")}s=e.Sheets[t]["!rows"];if(s&&s.length)for(a=0;a<s.length;a++)if(s[a]&&s[a].hpx){o.rows[a]={};o.rows[a].height=s[a].hpx+"px"}s=e.Sheets[t]["!merges"];if(s&&s.length>0){o.mergeCells=[];for(a=0;a<s.length;a++){var u=s[a].s.c;var b=s[a].s.r;var d=s[a].e.c;var f=s[a].e.r;var h=jexcel.getColumnNameFromId([u,b]);o.mergeCells[h]=[d-u+1,f-b+1]}}var g=0;var m=0;s=Object.keys(e.Sheets[t]);for(a=0;a<s.length;a++)if("!"!=s[a].substr(0,1)){var v=e.Sheets[t][s[a]];var C=jexcel.getIdFromColumnName(s[a],true);o.data[C[1]]||(o.data[C[1]]=[]);o.data[C[1]][C[0]]=v.f?"="+v.f:v.w;g<C[0]&&(g=C[0]);m<C[1]&&(m=C[1]);v.style&&Object.keys(v.style).length>0&&(o.style[s[a]]=v.style);if(v.s&&v.s.fgColor){o.style[s[a]]&&(o.style[s[a]]+=";");o.style[s[a]]+="background-color:#"+v.s.fgColor.rgb}}var E=o.columns;for(var A=0;A<=m;A++)for(a=0;a<=g;a++){o.data[A]||(o.data[A]=[]);o.data[A][a]||E<a&&(o.data[A][a]="")}r.push(o)}));return r};var t;t=new XMLHttpRequest;t.open("GET",e,true);if("undefined"!==typeof Uint8Array){t.responseType="arraybuffer";t.onload=function(e){var o=t.response;var s=new Uint8Array(o);var a=XLSX.read(s,{type:"array",cellFormula:true,cellStyles:true});r(convert(a))}}else{t.setRequestHeader("Accept-Charset","x-user-defined");t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){var e=convertResponseBodyToText(t.responseBody);var o=XLSX.read(e,{type:"binary",cellFormula:true,cellStyles:true});r(convert(o))}}}t.send()};jexcel.validLetter=function(e){var r=/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g;return e.match(r)?1:0};jexcel.injectArray=function(e,r,t){return e.slice(0,r).concat(t).concat(e.slice(r))};
/**
   * Get letter based on a number
   *
   * @param integer i
   * @return string letter
   */jexcel.getColumnName=function(e){var r="";if(e>701){r+=String.fromCharCode(64+parseInt(e/676));r+=String.fromCharCode(64+parseInt(e%676/26))}else e>25&&(r+=String.fromCharCode(64+parseInt(e/26)));r+=String.fromCharCode(65+e%26);return r};
/**
   * Convert excel like column to jexcel id
   *
   * @param string id
   * @return string id
   */jexcel.getIdFromColumnName=function(e,r){var t=/^[a-zA-Z]+/.exec(e);if(t){var o=0;for(var s=0;s<t[0].length;s++)o+=parseInt(t[0].charCodeAt(s)-64)*Math.pow(26,t[0].length-1-s);o--;o<0&&(o=0);var a=parseInt(/[0-9]+$/.exec(e));a>0&&a--;e=true==r?[o,a]:o+"-"+a}return e};
/**
   * Convert jexcel id to excel like column name
   *
   * @param string id
   * @return string id
   */jexcel.getColumnNameFromId=function(e){Array.isArray(e)||(e=e.split("-"));return jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)};
/**
   * Verify element inside jexcel table
   *
   * @param string id
   * @return string id
   */jexcel.getElement=function(e){var r=0;var t=0;function path(e){e.className&&e.classList.contains("jexcel_container")&&(t=e);"THEAD"==e.tagName?r=1:"TBODY"==e.tagName&&(r=2);e.parentNode&&(t||path(e.parentNode))}path(e);return[t,r]};jexcel.doubleDigitFormat=function(e){e=""+e;1==e.length&&(e="0"+e);return e};jexcel.createFromTable=function(e,r){if("TABLE"==e.tagName){r||(r={});r.columns=[];r.data=[];var t=e.querySelectorAll("colgroup > col");if(t.length)for(var o=0;o<t.length;o++){var s=t[o].style.width;if(!s)s=t[o].getAttribute("width");if(s){r.columns[o]||(r.columns[o]={});r.columns[o].width=s}}var parseHeader=function(e){var t=e.getBoundingClientRect();var s=t.width>50?t.width:50;r.columns[o]||(r.columns[o]={});e.getAttribute("data-celltype")?r.columns[o].type=e.getAttribute("data-celltype"):r.columns[o].type="text";r.columns[o].width=s+"px";r.columns[o].title=e.innerHTML;r.columns[o].align=e.style.textAlign||"center";(t=e.getAttribute("name"))&&(r.columns[o].name=t);(t=e.getAttribute("id"))&&(r.columns[o].id=t)};var a=[];var u=e.querySelectorAll(":scope > thead > tr");if(u.length){for(var b=0;b<u.length-1;b++){var d=[];for(o=0;o<u[b].children.length;o++){var f={title:u[b].children[o].innerText,colspan:u[b].children[o].getAttribute("colspan")||1};d.push(f)}a.push(d)}u=u[u.length-1].children;for(o=0;o<u.length;o++)parseHeader(u[o])}var h=0;var g={};var m={};var v={};var C={};var E=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(b=0;b<E.length;b++){r.data[h]=[];if(true!=r.parseTableFirstRowAsHeader||u.length||0!=b){for(o=0;o<E[b].children.length;o++){var A=E[b].children[o].getAttribute("data-formula");if(A)"="!=A.substr(0,1)&&(A="="+A);else A=E[b].children[o].innerHTML;r.data[h].push(A);var I=jexcel.getColumnNameFromId([o,b]);var M=E[b].children[o].getAttribute("class");M&&(C[I]=M);var R=parseInt(E[b].children[o].getAttribute("colspan"))||0;var D=parseInt(E[b].children[o].getAttribute("rowspan"))||0;(R||D)&&(g[I]=[R||1,D||1]);(S=E[b].children[o].style&&"none"==E[b].children[o].style.display)&&(E[b].children[o].style.display="");var S=E[b].children[o].getAttribute("style");S&&(v[I]=S);E[b].children[o].classList.contains("styleBold")&&(v[I]?v[I]+="; font-weight:bold;":v[I]="font-weight:bold;")}E[b].style&&E[b].style.height&&(m[b]={height:E[b].style.height});h++}else for(var o=0;o<E[b].children.length;o++)parseHeader(E[b].children[o])}Object.keys(a).length>0&&(r.nestedHeaders=a);Object.keys(v).length>0&&(r.style=v);Object.keys(g).length>0&&(r.mergeCells=g);Object.keys(m).length>0&&(r.rows=m);Object.keys(C).length>0&&(r.classes=C);E=e.querySelectorAll("tfoot tr");if(E.length){var w=[];for(b=0;b<E.length;b++){var L=[];for(o=0;o<E[b].children.length;o++)L.push(E[b].children[o].innerText);w.push(L)}Object.keys(w).length>0&&(r.footers=w)}if(true==r.parseTableAutoCellType){var O=[];for(o=0;o<r.columns.length;o++){var B=true;var U=true;O[o]=[];for(b=0;b<r.data.length;b++){A=r.data[b][o];O[o][A]||(O[o][A]=0);O[o][A]++;A.length>25&&(B=false);10==A.length&&"-"==A.substr(4,1)&&"-"==A.substr(7,1)||(U=false)}var P=Object.keys(O[o]).length;if(U)r.columns[o].type="calendar";else if(true==B&&P>1&&P<=parseInt(.1*r.data.length)){r.columns[o].type="dropdown";r.columns[o].source=Object.keys(O[o])}}}return r}console.log("Element is not a table")};jexcel.helpers=function(){var e={};e.getCaretIndex=function(e){if((this||_global).config.root)var r=(this||_global).config.root;else r=window;var t=0;var o=r.getSelection();if(o&&0!==o.rangeCount){var s=o.getRangeAt(0);var a=s.cloneRange();a.selectNodeContents(e);a.setEnd(s.endContainer,s.endOffset);t=a.toString().length}return t};e.invert=function(e){var r=[];var t=Object.keys(e);for(var o=0;o<t.length;o++)r[e[t[o]]]=t[o];return r};
/**
     * Get letter based on a number
     *
     * @param integer i
     * @return string letter
     */e.getColumnName=function(e){var r="";if(e>701){r+=String.fromCharCode(64+parseInt(e/676));r+=String.fromCharCode(64+parseInt(e%676/26))}else e>25&&(r+=String.fromCharCode(64+parseInt(e/26)));r+=String.fromCharCode(65+e%26);return r};e.getColumnNameFromCoords=function(r,t){return e.getColumnName(parseInt(r))+(parseInt(t)+1)};e.getCoordsFromColumnName=function(e){var r=/^[a-zA-Z]+/.exec(e);if(r){var t=0;for(var o=0;o<r[0].length;o++)t+=parseInt(r[0].charCodeAt(o)-64)*Math.pow(26,r[0].length-1-o);t--;t<0&&(t=0);var s=parseInt(/[0-9]+$/.exec(e))||null;s>0&&s--;return[t,s]}};e.createFromTable=function(){};e.injectArray=function(e,r,t){return e.slice(0,r).concat(t).concat(e.slice(r))};e.parseCSV=function(e,r){r=r||",";var t=0;var o=0;var s=[[]];var a=0;var u=null;var b=false;var d=false;for(var f=0;f<e.length;f++){s[o]||(s[o]=[]);s[o][t]||(s[o][t]="");if("\r"!=e[f])if("\n"!=e[f]&&e[f]!=r||false!=b&&true!=d&&u){'"'==e[f]&&(b=!b);if(null===u){u=b;if(true==u)continue}else if(true===u&&!d&&'"'==e[f]){if('"'==e[f+1]){b=true;s[o][t]+=e[f];f++}else d=true;continue}s[o][t]+=e[f]}else{u=null;b=false;d=false;if('"'==s[o][t][0]){var h=s[o][t].trim();'"'==h[h.length-1]&&(s[o][t]=h.substr(1,h.length-2))}if("\n"==e[f]){t=0;o++}else{t++;t>a&&(a=t)}}}for(var g=0;g<s.length;g++)for(f=0;f<=a;f++)void 0===s[g][f]&&(s[g][f]="");return s};return e}();"undefined"!=typeof jQuery&&function(e){e.fn.jspreadsheet=e.fn.jexcel=function(r){var t=e(this||_global).get(0);return t.jexcel?Array.isArray(t.jexcel)?t.jexcel[r][arguments[1]].apply(this||_global,Array.prototype.slice.call(arguments,2)):t.jexcel[r].apply(this||_global,Array.prototype.slice.call(arguments,1)):jexcel(e(this||_global).get(0),arguments[0])}}(jQuery);return jexcel}));var exports$1=exports;const nil=exports.nil,div0=exports.div0,value=exports.value,ref=exports.ref,name=exports.name,num=exports.num,na=exports.na,error=exports.error,data=exports.data,flattenShallow=exports.flattenShallow,isFlat=exports.isFlat,flatten=exports.flatten,argsToArray=exports.argsToArray,numbers=exports.numbers,cleanFloat=exports.cleanFloat,parseBool=exports.parseBool,parseNumber=exports.parseNumber,parseNumberArray=exports.parseNumberArray,parseMatrix=exports.parseMatrix,parseDate=exports.parseDate,parseDateArray=exports.parseDateArray,anyIsError=exports.anyIsError,arrayValuesToNumbers=exports.arrayValuesToNumbers,rest=exports.rest,initial=exports.initial,arrayEach=exports.arrayEach,transpose=exports.transpose,DATE=exports.DATE,DATEVALUE=exports.DATEVALUE,DAY=exports.DAY,EDATE=exports.EDATE,EOMONTH=exports.EOMONTH,HOUR=exports.HOUR,INTERVAL=exports.INTERVAL,ISOWEEKNUM=exports.ISOWEEKNUM,MINUTE=exports.MINUTE,MONTH=exports.MONTH,NETWORKDAYS=exports.NETWORKDAYS,NOW=exports.NOW,SECOND=exports.SECOND,TIME=exports.TIME,TIMEVALUE=exports.TIMEVALUE,TODAY=exports.TODAY,WEEKDAY=exports.WEEKDAY,WEEKNUM=exports.WEEKNUM,WORKDAY=exports.WORKDAY,YEAR=exports.YEAR,FINDFIELD=exports.FINDFIELD,DAVERAGE=exports.DAVERAGE,DCOUNT=exports.DCOUNT,DCOUNTA=exports.DCOUNTA,DGET=exports.DGET,DMAX=exports.DMAX,DMIN=exports.DMIN,DPRODUCT=exports.DPRODUCT,DSTDEV=exports.DSTDEV,DSTDEVP=exports.DSTDEVP,DSUM=exports.DSUM,DVAR=exports.DVAR,DVARP=exports.DVARP,MATCH=exports.MATCH,BESSELI=exports.BESSELI,BESSELJ=exports.BESSELJ,BESSELK=exports.BESSELK,BESSELY=exports.BESSELY,BIN2DEC=exports.BIN2DEC,BIN2HEX=exports.BIN2HEX,BIN2OCT=exports.BIN2OCT,BITAND=exports.BITAND,BITLSHIFT=exports.BITLSHIFT,BITOR=exports.BITOR,BITRSHIFT=exports.BITRSHIFT,BITXOR=exports.BITXOR,COMPLEX=exports.COMPLEX,CONVERT=exports.CONVERT,DEC2BIN=exports.DEC2BIN,DEC2HEX=exports.DEC2HEX,DEC2OCT=exports.DEC2OCT,DELTA=exports.DELTA,ERF=exports.ERF,ERFC=exports.ERFC,GESTEP=exports.GESTEP,HEX2BIN=exports.HEX2BIN,HEX2DEC=exports.HEX2DEC,HEX2OCT=exports.HEX2OCT,IMABS=exports.IMABS,IMAGINARY=exports.IMAGINARY,IMARGUMENT=exports.IMARGUMENT,IMCONJUGATE=exports.IMCONJUGATE,IMCOS=exports.IMCOS,IMCOSH=exports.IMCOSH,IMCOT=exports.IMCOT,IMDIV=exports.IMDIV,IMEXP=exports.IMEXP,IMLN=exports.IMLN,IMLOG10=exports.IMLOG10,IMLOG2=exports.IMLOG2,IMPOWER=exports.IMPOWER,IMPRODUCT=exports.IMPRODUCT,IMREAL=exports.IMREAL,IMSEC=exports.IMSEC,IMSECH=exports.IMSECH,IMSIN=exports.IMSIN,IMSINH=exports.IMSINH,IMSQRT=exports.IMSQRT,IMCSC=exports.IMCSC,IMCSCH=exports.IMCSCH,IMSUB=exports.IMSUB,IMSUM=exports.IMSUM,IMTAN=exports.IMTAN,OCT2BIN=exports.OCT2BIN,OCT2DEC=exports.OCT2DEC,OCT2HEX=exports.OCT2HEX,ACCRINT=exports.ACCRINT,ACCRINTM=exports.ACCRINTM,AMORDEGRC=exports.AMORDEGRC,AMORLINC=exports.AMORLINC,COUPDAYBS=exports.COUPDAYBS,COUPDAYS=exports.COUPDAYS,COUPDAYSNC=exports.COUPDAYSNC,COUPNCD=exports.COUPNCD,COUPNUM=exports.COUPNUM,COUPPCD=exports.COUPPCD,CUMIPMT=exports.CUMIPMT,CUMPRINC=exports.CUMPRINC,DB=exports.DB,DDB=exports.DDB,DISC=exports.DISC,DOLLARDE=exports.DOLLARDE,DOLLARFR=exports.DOLLARFR,DURATION=exports.DURATION,EFFECT=exports.EFFECT,FV=exports.FV,FVSCHEDULE=exports.FVSCHEDULE,INTRATE=exports.INTRATE,IPMT=exports.IPMT,IRR=exports.IRR,ISPMT=exports.ISPMT,MDURATION=exports.MDURATION,MIRR=exports.MIRR,NOMINAL=exports.NOMINAL,NPER=exports.NPER,NPV=exports.NPV,ODDFPRICE=exports.ODDFPRICE,ODDFYIELD=exports.ODDFYIELD,ODDLPRICE=exports.ODDLPRICE,ODDLYIELD=exports.ODDLYIELD,PDURATION=exports.PDURATION,PMT=exports.PMT,PPMT=exports.PPMT,PRICE=exports.PRICE,PRICEDISC=exports.PRICEDISC,PRICEMAT=exports.PRICEMAT,PV=exports.PV,RATE=exports.RATE,RECEIVED=exports.RECEIVED,RRI=exports.RRI,SLN=exports.SLN,SYD=exports.SYD,TBILLEQ=exports.TBILLEQ,TBILLPRICE=exports.TBILLPRICE,TBILLYIELD=exports.TBILLYIELD,VDB=exports.VDB,XIRR=exports.XIRR,XNPV=exports.XNPV,YIELD=exports.YIELD,YIELDDISC=exports.YIELDDISC,YIELDMAT=exports.YIELDMAT,CELL=exports.CELL,ERROR=exports.ERROR,INFO=exports.INFO,ISBLANK=exports.ISBLANK,ISBINARY=exports.ISBINARY,ISERR=exports.ISERR,ISEVEN=exports.ISEVEN,ISFORMULA=exports.ISFORMULA,ISLOGICAL=exports.ISLOGICAL,ISNA=exports.ISNA,ISNONTEXT=exports.ISNONTEXT,ISODD=exports.ISODD,ISREF=exports.ISREF,ISTEXT=exports.ISTEXT,N=exports.N,NA=exports.NA,SHEET=exports.SHEET,SHEETS=exports.SHEETS,TYPE=exports.TYPE,AND=exports.AND,CHOOSE=exports.CHOOSE,FALSE=exports.FALSE,IF=exports.IF,IFERROR=exports.IFERROR,IFNA=exports.IFNA,NOT=exports.NOT,OR=exports.OR,TRUE=exports.TRUE,XOR=exports.XOR,SWITCH=exports.SWITCH,ABS=exports.ABS,ACOS=exports.ACOS,ACOSH=exports.ACOSH,ACOT=exports.ACOT,ACOTH=exports.ACOTH,AGGREGATE=exports.AGGREGATE,ARABIC=exports.ARABIC,ASIN=exports.ASIN,ASINH=exports.ASINH,ATAN=exports.ATAN,ATAN2=exports.ATAN2,ATANH=exports.ATANH,BASE=exports.BASE,CEILING=exports.CEILING,COMBIN=exports.COMBIN,COMBINA=exports.COMBINA,COS=exports.COS,COSH=exports.COSH,COT=exports.COT,COTH=exports.COTH,CSC=exports.CSC,CSCH=exports.CSCH,DECIMAL=exports.DECIMAL,DEGREES=exports.DEGREES,EVEN=exports.EVEN,EXP=exports.EXP,FACTDOUBLE=exports.FACTDOUBLE,FLOOR=exports.FLOOR,GCD=exports.GCD,INT=exports.INT,LCM=exports.LCM,LN=exports.LN,LOG=exports.LOG,LOG10=exports.LOG10,MDETERM=exports.MDETERM,MINVERSE=exports.MINVERSE,MMULT=exports.MMULT,MOD=exports.MOD,MROUND=exports.MROUND,MULTINOMIAL=exports.MULTINOMIAL,MUNIT=exports.MUNIT,ODD=exports.ODD,PI=exports.PI,POWER=exports.POWER,PRODUCT=exports.PRODUCT,QUOTIENT=exports.QUOTIENT,RADIANS=exports.RADIANS,RAND=exports.RAND,RANDBETWEEN=exports.RANDBETWEEN,ROMAN=exports.ROMAN,ROUND=exports.ROUND,ROUNDDOWN=exports.ROUNDDOWN,ROUNDUP=exports.ROUNDUP,SEC=exports.SEC,SECH=exports.SECH,SERIESSUM=exports.SERIESSUM,SIGN=exports.SIGN,SIN=exports.SIN,SINH=exports.SINH,SQRT=exports.SQRT,SQRTPI=exports.SQRTPI,SUBTOTAL=exports.SUBTOTAL,ADD=exports.ADD,MINUS=exports.MINUS,DIVIDE=exports.DIVIDE,MULTIPLY=exports.MULTIPLY,GTE=exports.GTE,LT=exports.LT,LTE=exports.LTE,EQ=exports.EQ,NE=exports.NE,POW=exports.POW,SUM=exports.SUM,SUMIF=exports.SUMIF,SUMIFS=exports.SUMIFS,SUMPRODUCT=exports.SUMPRODUCT,SUMSQ=exports.SUMSQ,SUMX2MY2=exports.SUMX2MY2,SUMX2PY2=exports.SUMX2PY2,SUMXMY2=exports.SUMXMY2,TAN=exports.TAN,TANH=exports.TANH,TRUNC=exports.TRUNC,FLATTEN=exports.FLATTEN,ARGS2ARRAY=exports.ARGS2ARRAY,REFERENCE=exports.REFERENCE,JOIN=exports.JOIN,NUMBERS=exports.NUMBERS,NUMERAL=exports.NUMERAL,ASC=exports.ASC,BAHTTEXT=exports.BAHTTEXT,CHAR=exports.CHAR,CLEAN=exports.CLEAN,CODE=exports.CODE,CONCATENATE=exports.CONCATENATE,DBCS=exports.DBCS,DOLLAR=exports.DOLLAR,EXACT=exports.EXACT,FIND=exports.FIND,FIXED=exports.FIXED,HTML2TEXT=exports.HTML2TEXT,LEFT=exports.LEFT,LEN=exports.LEN,LOWER=exports.LOWER,MID=exports.MID,NUMBERVALUE=exports.NUMBERVALUE,PRONETIC=exports.PRONETIC,PROPER=exports.PROPER,REGEXEXTRACT=exports.REGEXEXTRACT,REGEXMATCH=exports.REGEXMATCH,REGEXREPLACE=exports.REGEXREPLACE,REPLACE=exports.REPLACE,RIGHT=exports.RIGHT,SEARCH=exports.SEARCH,SPLIT=exports.SPLIT,SUBSTITUTE=exports.SUBSTITUTE,T=exports.T,TEXT=exports.TEXT,TRIM=exports.TRIM,UNICHAR=exports.UNICHAR,UNICODE=exports.UNICODE,UPPER=exports.UPPER,VALUE=exports.VALUE,AVEDEV=exports.AVEDEV,AVERAGE=exports.AVERAGE,AVERAGEA=exports.AVERAGEA,AVERAGEIF=exports.AVERAGEIF,AVERAGEIFS=exports.AVERAGEIFS,COUNT=exports.COUNT,COUNTA=exports.COUNTA,COUNTIN=exports.COUNTIN,COUNTBLANK=exports.COUNTBLANK,COUNTIF=exports.COUNTIF,COUNTIFS=exports.COUNTIFS,COUNTUNIQUE=exports.COUNTUNIQUE,FISHER=exports.FISHER,FISHERINV=exports.FISHERINV,FREQUENCY=exports.FREQUENCY,LARGE=exports.LARGE,MAX=exports.MAX,MAXA=exports.MAXA,MIN=exports.MIN,MINA=exports.MINA,MODE=exports.MODE,PERCENTILE=exports.PERCENTILE,PERCENTRANK=exports.PERCENTRANK,PERMUT=exports.PERMUT,PERMUTATIONA=exports.PERMUTATIONA,PHI=exports.PHI,PROB=exports.PROB,QUARTILE=exports.QUARTILE,RANK=exports.RANK,RSQ=exports.RSQ,SMALL=exports.SMALL,STANDARDIZE=exports.STANDARDIZE,STDEV=exports.STDEV,STDEVA=exports.STDEVA,STDEVPA=exports.STDEVPA,VAR=exports.VAR,VARA=exports.VARA,VARPA=exports.VARPA,WEIBULL=exports.WEIBULL,Z=exports.Z,PROGRESS=exports.PROGRESS,RATING=exports.RATING;const _DAYS=exports.DAYS,_DAYS2=exports.DAYS360,_YEARFRAC=exports.YEARFRAC,_ISERROR=exports.ISERROR,_ISNUMBER=exports.ISNUMBER,_FACT=exports.FACT,_UNIQUE=exports.UNIQUE,_REPT=exports.REPT;export{ABS,ACCRINT,ACCRINTM,ACOS,ACOSH,ACOT,ACOTH,ADD,AGGREGATE,AMORDEGRC,AMORLINC,AND,ARABIC,ARGS2ARRAY,ASC,ASIN,ASINH,ATAN,ATAN2,ATANH,AVEDEV,AVERAGE,AVERAGEA,AVERAGEIF,AVERAGEIFS,BAHTTEXT,BASE,BESSELI,BESSELJ,BESSELK,BESSELY,BIN2DEC,BIN2HEX,BIN2OCT,BITAND,BITLSHIFT,BITOR,BITRSHIFT,BITXOR,CEILING,CELL,CHAR,CHOOSE,CLEAN,CODE,COMBIN,COMBINA,COMPLEX,CONCATENATE,CONVERT,COS,COSH,COT,COTH,COUNT,COUNTA,COUNTBLANK,COUNTIF,COUNTIFS,COUNTIN,COUNTUNIQUE,COUPDAYBS,COUPDAYS,COUPDAYSNC,COUPNCD,COUPNUM,COUPPCD,CSC,CSCH,CUMIPMT,CUMPRINC,DATE,DATEVALUE,DAVERAGE,DAY,_DAYS as DAYS,_DAYS2 as DAYS360,DB,DBCS,DCOUNT,DCOUNTA,DDB,DEC2BIN,DEC2HEX,DEC2OCT,DECIMAL,DEGREES,DELTA,DGET,DISC,DIVIDE,DMAX,DMIN,DOLLAR,DOLLARDE,DOLLARFR,DPRODUCT,DSTDEV,DSTDEVP,DSUM,DURATION,DVAR,DVARP,EDATE,EFFECT,EOMONTH,EQ,ERF,ERFC,ERROR,EVEN,EXACT,EXP,_FACT as FACT,FACTDOUBLE,FALSE,FIND,FINDFIELD,FISHER,FISHERINV,FIXED,FLATTEN,FLOOR,FREQUENCY,FV,FVSCHEDULE,GCD,GESTEP,GTE,HEX2BIN,HEX2DEC,HEX2OCT,HOUR,HTML2TEXT,IF,IFERROR,IFNA,IMABS,IMAGINARY,IMARGUMENT,IMCONJUGATE,IMCOS,IMCOSH,IMCOT,IMCSC,IMCSCH,IMDIV,IMEXP,IMLN,IMLOG10,IMLOG2,IMPOWER,IMPRODUCT,IMREAL,IMSEC,IMSECH,IMSIN,IMSINH,IMSQRT,IMSUB,IMSUM,IMTAN,INFO,INT,INTERVAL,INTRATE,IPMT,IRR,ISBINARY,ISBLANK,ISERR,_ISERROR as ISERROR,ISEVEN,ISFORMULA,ISLOGICAL,ISNA,ISNONTEXT,_ISNUMBER as ISNUMBER,ISODD,ISOWEEKNUM,ISPMT,ISREF,ISTEXT,JOIN,LARGE,LCM,LEFT,LEN,LN,LOG,LOG10,LOWER,LT,LTE,MATCH,MAX,MAXA,MDETERM,MDURATION,MID,MIN,MINA,MINUS,MINUTE,MINVERSE,MIRR,MMULT,MOD,MODE,MONTH,MROUND,MULTINOMIAL,MULTIPLY,MUNIT,N,NA,NE,NETWORKDAYS,NOMINAL,NOT,NOW,NPER,NPV,NUMBERS,NUMBERVALUE,NUMERAL,OCT2BIN,OCT2DEC,OCT2HEX,ODD,ODDFPRICE,ODDFYIELD,ODDLPRICE,ODDLYIELD,OR,PDURATION,PERCENTILE,PERCENTRANK,PERMUT,PERMUTATIONA,PHI,PI,PMT,POW,POWER,PPMT,PRICE,PRICEDISC,PRICEMAT,PROB,PRODUCT,PROGRESS,PRONETIC,PROPER,PV,QUARTILE,QUOTIENT,RADIANS,RAND,RANDBETWEEN,RANK,RATE,RATING,RECEIVED,REFERENCE,REGEXEXTRACT,REGEXMATCH,REGEXREPLACE,REPLACE,_REPT as REPT,RIGHT,ROMAN,ROUND,ROUNDDOWN,ROUNDUP,RRI,RSQ,SEARCH,SEC,SECH,SECOND,SERIESSUM,SHEET,SHEETS,SIGN,SIN,SINH,SLN,SMALL,SPLIT,SQRT,SQRTPI,STANDARDIZE,STDEV,STDEVA,STDEVPA,SUBSTITUTE,SUBTOTAL,SUM,SUMIF,SUMIFS,SUMPRODUCT,SUMSQ,SUMX2MY2,SUMX2PY2,SUMXMY2,SWITCH,SYD,T,TAN,TANH,TBILLEQ,TBILLPRICE,TBILLYIELD,TEXT,TIME,TIMEVALUE,TODAY,TRIM,TRUE,TRUNC,TYPE,UNICHAR,UNICODE,_UNIQUE as UNIQUE,UPPER,VALUE,VAR,VARA,VARPA,VDB,WEEKDAY,WEEKNUM,WEIBULL,WORKDAY,XIRR,XNPV,XOR,YEAR,_YEARFRAC as YEARFRAC,YIELD,YIELDDISC,YIELDMAT,Z,anyIsError,argsToArray,arrayEach,arrayValuesToNumbers,cleanFloat,data,exports$1 as default,div0,error,flatten,flattenShallow,initial,isFlat,na,name,nil,num,numbers,parseBool,parseDate,parseDateArray,parseMatrix,parseNumber,parseNumberArray,ref,rest,transpose,value};

